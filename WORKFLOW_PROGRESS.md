# Coohomå‘¨æŠ¥è‡ªåŠ¨åŒ– - å½“å‰è¿›åº¦å’Œä½¿ç”¨æŒ‡å—

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. é¡¹ç›®ç»“æ„æ­å»º
- âœ… åˆ›å»ºäº†å®Œæ•´çš„é¡¹ç›®ç›®å½•ç»“æ„
- âœ… é…ç½®æ–‡ä»¶ï¼šconfig.yaml, sql_replacement_rules.yaml
- âœ… æ ¸å¿ƒæ¨¡å—ï¼šdate_utils.py, logger.py, data_analyzer.py, report_generator.pyç­‰
- âœ… 6ä¸ªSQLæ–‡ä»¶å·²å°±ä½

### 2. æµé‡æ•°æ®å¤„ç†ï¼ˆå·²å®Œæˆï¼‰
- âœ… SQLä¿®æ”¹ï¼šç§»é™¤äº†è‡ªå®šä¹‰å‡½æ•°`getweekbydate`
- âœ… æ—¥æœŸå‚æ•°æ›´æ–°ï¼š20260118 ~ 20260201
- âœ… MetabaseæŸ¥è¯¢æ‰§è¡ŒæˆåŠŸ
- âœ… æ•°æ®æ±‡æ€»å®Œæˆ

**æµé‡æ•°æ®æ‘˜è¦**ï¼š
```
æ—¥æœŸèŒƒå›´ï¼š2026-01-18 ~ 2026-01-26
æ€»æ–°è®¿å®¢ï¼š24,668 äºº
æ€»æ³¨å†Œæ•°ï¼š5,645 äºº
æ•´ä½“è½¬åŒ–ç‡ï¼š22.9%

ä¸»è¦æ¸ é“è¡¨ç°ï¼š
- paid ads: 11,728 è®¿å®¢, 4,567 æ³¨å†Œ (38.9% è½¬åŒ–ç‡)
- organic search: 8,750 è®¿å®¢, 879 æ³¨å†Œ (10.0% è½¬åŒ–ç‡)
- referral: 2,196 è®¿å®¢, 9 æ³¨å†Œ (0.4% è½¬åŒ–ç‡)
- ai search: 878 è®¿å®¢, 106 æ³¨å†Œ (12.1% è½¬åŒ–ç‡)
```

### 3. æ¿€æ´»æ•°æ®SQLä¿®æ”¹ï¼ˆå·²å®Œæˆï¼‰
- âœ… SQLæ–‡ä»¶å·²ä¿®æ”¹ï¼š02_activation_modified.sql
- âœ… æ—¥æœŸå‚æ•°å·²æ›´æ–°ï¼šå¿«ç…§æ—¥20260201ï¼Œç»“æŸæ—¥20260131
- â³ å¾…æ‰§è¡ŒMetabaseæŸ¥è¯¢

## ğŸ“‹ ä¸‹ä¸€æ­¥å·¥ä½œ

### å‰©ä½™4ä¸ªéƒ¨åˆ†çš„å¤„ç†

å¯¹äºæ¯ä¸ªéƒ¨åˆ†ï¼ˆæ¿€æ´»ã€æ´»è·ƒã€ç•™å­˜ã€æ”¶å…¥ï¼‰ï¼Œéœ€è¦æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š

#### 1. æ¿€æ´»éƒ¨åˆ† (02_activation.sql)
- SQLå·²ä¿®æ”¹ï¼Œå¾…æ‰§è¡Œ
- å‘½ä»¤ï¼šä½¿ç”¨MCPå·¥å…·æ‰§è¡Œ `sql/02_activation_modified.sql`
- é¢„æœŸè¾“å‡ºï¼šæ³¨å†Œæ¼æ–—æ•°æ®

#### 2. æ´»è·ƒéƒ¨åˆ† (03_engagement_*.sql)
- æœ‰2ä¸ªSQLæ–‡ä»¶ï¼š
  - 03_engagement_all_users.sql
  - 03_engagement_new_old_users.sql
- éœ€è¦ä¿®æ”¹æ—¥æœŸå‚æ•°å¹¶æ‰§è¡Œ

#### 3. ç•™å­˜éƒ¨åˆ† (04_retention.sql)
- éœ€è¦ä¿®æ”¹æ—¥æœŸå‚æ•°å¹¶æ‰§è¡Œ

#### 4. æ”¶å…¥éƒ¨åˆ† (05_revenue.sql)
- éœ€è¦ä¿®æ”¹æ—¥æœŸå‚æ•°å¹¶æ‰§è¡Œ
- æ”¯æŒMDæ–‡æ¡£è¾“å…¥ï¼ˆå¯é€‰ï¼‰

## ğŸš€ å¿«é€Ÿæ‰§è¡ŒæŒ‡å—

### æ–¹å¼1ï¼šé€ä¸ªæ‰§è¡ŒSQLæŸ¥è¯¢

```python
# 1. è¯»å–å¹¶ä¿®æ”¹SQLæ–‡ä»¶
python3 << 'EOF'
# ä¿®æ”¹SQLæ—¥æœŸå‚æ•°
# ...
EOF

# 2. é€šè¿‡Metabase MCPå·¥å…·æ‰§è¡ŒæŸ¥è¯¢
mcp__metabase__execute_sql_query(
    database_id=2,
    query="<SQLå†…å®¹>"
)
```

### æ–¹å¼2ï¼šä½¿ç”¨Pythonè„šæœ¬æ‰¹é‡å¤„ç†

```bash
cd "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation"
python3 process_all_sections.py
```

## ğŸ“Š æ•°æ®å¤„ç†æµç¨‹

```
1. æ—¥æœŸè®¡ç®—
   â†“
2. SQLæ–‡ä»¶é¢„å¤„ç†ï¼ˆæ›¿æ¢æ—¥æœŸå‚æ•°ï¼‰
   â†“
3. MetabaseæŸ¥è¯¢æ‰§è¡Œ
   â†“
4. æ•°æ®æ±‡æ€»å’Œåˆ†æ
   â†“
5. HTMLæŠ¥å‘Šç”Ÿæˆ
   â†“
6. Confluenceé¡µé¢æ›´æ–°
```

## ğŸ“ é‡è¦æ–‡ä»¶ä½ç½®

- SQLæ–‡ä»¶ï¼š`/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql/`
- è¾“å‡ºæ•°æ®ï¼š`/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/output/`
- é…ç½®æ–‡ä»¶ï¼š`/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/config/`

## âš™ï¸ æ—¥æœŸå‚æ•°è¯´æ˜

æœ¬å‘¨ï¼ˆ2026-01-27æ‰§è¡Œï¼‰ï¼š
- report_date: "2026-01-31"
- week_monday: "20260126"
- week_saturday: "20260131"
- week_sunday: "20260201"
- partition_start: "20260119" (æå‰2å‘¨)
- partition_end: "20260201"
- history_start_date: "20251203" (æå‰2ä¸ªæœˆ)

## ğŸ’¡ æ³¨æ„äº‹é¡¹

1. **SQLå‡½æ•°å…¼å®¹æ€§**ï¼š
   - ç§»é™¤äº†è‡ªå®šä¹‰å‡½æ•°å¦‚ `getweekbydate`, `getdatebyweek`
   - ä½¿ç”¨æ ‡å‡†SQLå‡½æ•°æ›¿ä»£

2. **æ—¥æœŸæå‰é‡**ï¼š
   - æµé‡æ•°æ®ï¼šæå‰çº¦2å‘¨
   - æ¿€æ´»æ•°æ®ï¼šæå‰çº¦2ä¸ªæœˆ
   - æ´»è·ƒ/ç•™å­˜ï¼šæŒ‰åŸSQLæå‰é‡
   - æ”¶å…¥æ•°æ®ï¼šæå‰çº¦2ä¸ªæœˆ

3. **Metabaseè¿æ¥**ï¼š
   - database_id: 2 (starrocks-gio read_only)
   - é€šè¿‡MCPå·¥å…·æ‰§è¡ŒæŸ¥è¯¢

## ğŸ“ˆ å½“å‰æ•°æ®æ±‡æ€»

### æµé‡éƒ¨åˆ†ï¼ˆå·²å®Œæˆï¼‰
```json
{
  "total_visitors": 24668,
  "total_registrations": 5645,
  "conversion_rate": 0.2289,
  "date_range": "2026-01-18 ~ 2026-01-26"
}
```

æ•°æ®æ–‡ä»¶ï¼š`output/traffic_summary.json`

## ğŸ”§ æŠ€æœ¯æ ˆ

- Python 3.x
- Metabase MCPå·¥å…·
- Confluence MCPå·¥å…·
- YAMLé…ç½®ç®¡ç†
- JSONæ•°æ®å­˜å‚¨

## ğŸ“ ç›¸å…³æ–‡æ¡£

- README.md - é¡¹ç›®æ¦‚è¿°
- QUICKSTART.md - å¿«é€Ÿå¼€å§‹æŒ‡å—
- config/config.yaml - ä¸»é…ç½®æ–‡ä»¶
- config/sql_replacement_rules.yaml - SQLæ›¿æ¢è§„åˆ™

## âœ¨ ä¸‹æ¬¡è¿è¡Œ

å½“éœ€è¦æ›´æ–°ä¸‹å‘¨æ•°æ®æ—¶ï¼š

1. è¿è¡Œæ—¥æœŸè®¡ç®—è·å–æ–°çš„å‚æ•°
2. æ‰¹é‡ä¿®æ”¹æ‰€æœ‰SQLæ–‡ä»¶çš„æ—¥æœŸ
3. ä¾æ¬¡æ‰§è¡Œ6ä¸ªSQLæŸ¥è¯¢
4. æ±‡æ€»æ‰€æœ‰æ•°æ®
5. ç”ŸæˆHTMLæŠ¥å‘Š
6. æ›´æ–°Confluenceé¡µé¢

æˆ–è€…ç›´æ¥è¿è¡Œï¼š
```bash
python main.py  # äº¤äº’å¼é€‰æ‹©ä¸‹å‘¨
```
