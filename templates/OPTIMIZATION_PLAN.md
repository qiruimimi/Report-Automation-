# Coohomå‘¨æŠ¥è‡ªåŠ¨åŒ–é¡¹ç›®ä¼˜åŒ–æ–¹æ¡ˆ

## é¡¹ç›®æ¦‚è¿°

æœ¬æ–‡æ¡£æä¾›Coohomå‘¨æŠ¥è‡ªåŠ¨åŒ–é¡¹ç›®çš„å®Œæ•´ä¼˜åŒ–æ–¹æ¡ˆï¼ŒåŒ…æ‹¬æ ‡å‡†åŒ–æ¨¡æ¿ã€æ–°å¢SQLæŸ¥è¯¢å’Œé¡¹ç›®ç»“æ„ä¼˜åŒ–å»ºè®®ã€‚

---

## ä¸€ã€é¡¹ç›®ç»“æ„ä¼˜åŒ–

### 1.1 å½“å‰é¡¹ç›®ç»“æ„

```
weekly_report_automation/
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ config.yaml
â”‚   â””â”€â”€ sql_replacement_rules.yaml
â”œâ”€â”€ logs/
â”œâ”€â”€ output/
â”œâ”€â”€ sql/
â”‚   â”œâ”€â”€ 01_traffic.sql
â”‚   â”œâ”€â”€ 02_activation.sql
â”‚   â”œâ”€â”€ 03_engagement_all_users.sql
â”‚   â”œâ”€â”€ 03_engagement_new_old_users.sql
â”‚   â”œâ”€â”€ 04_retention.sql
â”‚   â””â”€â”€ 05_revenue.sql
â””â”€â”€ src/
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ confluence_updater.py
    â”œâ”€â”€ data_analyzer.py
    â”œâ”€â”€ data_fetcher.py
    â”œâ”€â”€ date_utils.py
    â”œâ”€â”€ interactive_prompt.py
    â”œâ”€â”€ logger.py
    â”œâ”€â”€ report_generator.py
    â””â”€â”€ sql_preprocessor.py
```

### 1.2 ä¼˜åŒ–åçš„é¡¹ç›®ç»“æ„

```
weekly_report_automation/
â”œâ”€â”€ config/                      # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ config.yaml
â”‚   â”œâ”€â”€ sql_replacement_rules.yaml
â”‚   â””â”€â”€ report_sections.yaml     # æ–°å¢ï¼šæŠ¥å‘Šå„éƒ¨åˆ†é…ç½®
â”œâ”€â”€ templates/                   # æ–°å¢ï¼šæŠ¥å‘Šæ¨¡æ¿ç›®å½•
â”‚   â”œâ”€â”€ weekly_report_template.md
â”‚   â””â”€â”€ confluence_html_template.html
â”œâ”€â”€ logs/                        # æ—¥å¿—ç›®å½•
â”œâ”€â”€ output/                      # è¾“å‡ºç›®å½•
â”‚   â”œâ”€â”€ json/                    # JSONåŸå§‹æ•°æ®
â”‚   â”œâ”€â”€ reports/                 # ç”Ÿæˆçš„æŠ¥å‘Š
â”‚   â””â”€â”€ cache/                   # ç¼“å­˜æ•°æ®
â”œâ”€â”€ sql/                         # SQLæŸ¥è¯¢æ–‡ä»¶
â”‚   â”œâ”€â”€ 01_traffic.sql
â”‚   â”œâ”€â”€ 02_activation.sql
â”‚   â”œâ”€â”€ 03_engagement_all_users.sql
â”‚   â”œâ”€â”€ 03_engagement_new_old_users.sql
â”‚   â”œâ”€â”€ 04_retention.sql
â”‚   â”œâ”€â”€ 05_revenue.sql
â”‚   â”œâ”€â”€ 06_revenue_by_sku.sql              # æ–°å¢ï¼šSKUç»´åº¦
â”‚   â”œâ”€â”€ 07_revenue_by_country.sql          # æ–°å¢ï¼šå›½å®¶ç»´åº¦
â”‚   â”œâ”€â”€ 08_revenue_by_tier.sql             # æ–°å¢ï¼šè´¦å•åˆ†å±‚
â”‚   â”œâ”€â”€ 09_engagement_historical.sql       # æ–°å¢ï¼š25å‘¨å†å²WAU
â”‚   â””â”€â”€ 10_retention_historical.sql        # æ–°å¢ï¼šè¿‘12å‘¨ç•™å­˜
â”œâ”€â”€ src/                         # æºä»£ç 
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ confluence_updater.py
â”‚   â”œâ”€â”€ data_analyzer.py
â”‚   â”œâ”€â”€ data_fetcher.py
â”‚   â”œâ”€â”€ data_processor.py        # æ–°å¢ï¼šæ•°æ®å¤„ç†æ¨¡å—
â”‚   â”œâ”€â”€ date_utils.py
â”‚   â”œâ”€â”€ interactive_prompt.py
â”‚   â”œâ”€â”€ logger.py
â”‚   â”œâ”€â”€ report_generator.py      # ä¼˜åŒ–ï¼šä½¿ç”¨æ¨¡æ¿ç”Ÿæˆ
â”‚   â”œâ”€â”€ sql_preprocessor.py
â”‚   â””â”€â”€ metrics_extractor.py     # æ–°å¢ï¼šæŒ‡æ ‡æå–å™¨
â”œâ”€â”€ tests/                       # æ–°å¢ï¼šæµ‹è¯•ç›®å½•
â”‚   â”œâ”€â”€ test_data_processor.py
â”‚   â”œâ”€â”€ test_metrics_extractor.py
â”‚   â””â”€â”€ test_report_generator.py
â”œâ”€â”€ main.py                      # ä¸»å…¥å£
â”œâ”€â”€ generate_report.py           # æ–°å¢ï¼šæŠ¥å‘Šç”Ÿæˆè„šæœ¬
â”œâ”€â”€ batch_execute.py
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ README.md
â””â”€â”€ OPTIMIZATION_PLAN.md         # æœ¬æ–‡æ¡£
```

---

## äºŒã€æ–°å¢SQLæŸ¥è¯¢æ–‡ä»¶

### 2.1 SKUç»´åº¦æ”¶å…¥åˆ†æ

**æ–‡ä»¶**: `/sql/06_revenue_by_sku.sql`

**åŠŸèƒ½**: è·å–ä¸åŒSKUï¼ˆå¦‚pro_year_cyclicalç­‰ï¼‰çš„æ”¶å…¥æ•°æ®

**å…³é”®æŒ‡æ ‡**:
- å„SKUçš„æ”¶å…¥ã€ç”¨æˆ·æ•°ã€å®¢å•ä»·
- å„SKUçš„æ–°ç­¾/ç»­çº¦åˆ†è§£
- SKUç»´åº¦çš„ç¯æ¯”å˜åŒ–

**ä½¿ç”¨åœºæ™¯**:
- åˆ†ææ”¶å…¥å˜åŒ–çš„SKUè´¡çŒ®
- è¯†åˆ«é«˜ä»·å€¼SKU
- SKUç­–ç•¥è°ƒæ•´

### 2.2 å›½å®¶ç»´åº¦æ”¶å…¥åˆ†æ

**æ–‡ä»¶**: `/sql/07_revenue_by_country.sql`

**åŠŸèƒ½**: è·å–ä¸åŒå›½å®¶/åœ°åŒºçš„æ”¶å…¥æ•°æ®

**å…³é”®æŒ‡æ ‡**:
- å„å›½å®¶çš„æ”¶å…¥ã€ç”¨æˆ·æ•°ã€å®¢å•ä»·
- å„å›½å®¶çš„æ–°ç­¾/ç»­çº¦åˆ†è§£
- å›½å®¶ç»´åº¦çš„ç¯æ¯”å˜åŒ–

**ä½¿ç”¨åœºæ™¯**:
- åˆ†æåŒºåŸŸå¸‚åœºè¡¨ç°
- è¯†åˆ«é«˜æ½œåŠ›å¸‚åœº
- åœ°åŒºåŒ–è¿è¥ç­–ç•¥

### 2.3 è´¦å•åˆ†å±‚æ”¶å…¥åˆ†æ

**æ–‡ä»¶**: `/sql/08_revenue_by_tier.sql`

**åŠŸèƒ½**: è·å–ä¸åŒè´¦å•åˆ†å±‚ï¼ˆè¿ç»­ç»­çº¦ã€å‡çº§ã€å¬å›ç­‰ï¼‰çš„æ”¶å…¥æ•°æ®

**å…³é”®æŒ‡æ ‡**:
- å„åˆ†å±‚çš„æ”¶å…¥ã€ç”¨æˆ·æ•°ã€å®¢å•ä»·
- æ–°ç­¾ã€è¿ç»­ç»­çº¦ã€å‡çº§ã€é™çº§ã€å¬å›çš„æ”¶å…¥åˆ†è§£
- åˆ†å±‚ç»´åº¦çš„ç¯æ¯”å˜åŒ–

**ä½¿ç”¨åœºæ™¯**:
- æ·±å…¥åˆ†ææ”¶å…¥å˜åŒ–åŸå› 
- è¯†åˆ«ç»­çº¦é—®é¢˜
- ä¼˜åŒ–ç”¨æˆ·ç”Ÿå‘½å‘¨æœŸç®¡ç†

**æ³¨æ„äº‹é¡¹**:
- éœ€è¦æ ¹æ®å®é™…è¡¨ç»“æ„è°ƒæ•´åˆ†å±‚é€»è¾‘
- å¯èƒ½éœ€è¦æ·»åŠ `is_upgrade`ã€`consecutive_renewal_count`ç­‰å­—æ®µ

### 2.4 25å‘¨å†å²WAU

**æ–‡ä»¶**: `/sql/09_engagement_historical.sql`

**åŠŸèƒ½**: è·å–25å‘¨å†å²WAUæ•°æ®ï¼Œç”¨äºè®¡ç®—å†å²å¹³å‡å€¼

**å…³é”®æŒ‡æ ‡**:
- å†å²å„å‘¨çš„æ€»WAU
- å†å²å„å‘¨çš„æ–°ç”¨æˆ·WAU
- å†å²å„å‘¨çš„è€ç”¨æˆ·WAU
- 25å‘¨å¹³å‡WAU

**ä½¿ç”¨åœºæ™¯**:
- æä¾›å†å²å¯¹æ¯”åŸºå‡†
- è¯†åˆ«é•¿æœŸè¶‹åŠ¿
- è¯„ä¼°å½“å‰è¡¨ç°

### 2.5 è¿‘12å‘¨ç•™å­˜å¹³å‡å€¼

**æ–‡ä»¶**: `/sql/10_retention_historical.sql`

**åŠŸèƒ½**: è·å–è¿‘12å‘¨ç•™å­˜æ•°æ®å¹¶è®¡ç®—å¹³å‡å€¼

**å…³é”®æŒ‡æ ‡**:
- è¿‘12å‘¨æ¯å‘¨çš„æ–°ç”¨æˆ·ç•™å­˜ç‡
- è¿‘12å‘¨æ¯å‘¨çš„è€ç”¨æˆ·ç•™å­˜ç‡
- æ–°ç”¨æˆ·ç•™å­˜ç‡å¹³å‡å€¼
- è€ç”¨æˆ·ç•™å­˜ç‡å¹³å‡å€¼

**ä½¿ç”¨åœºæ™¯**:
- æä¾›ç•™å­˜ç‡å†å²åŸºå‡†
- è¯†åˆ«ç•™å­˜ç‡è¶‹åŠ¿
- è¯„ä¼°å½“å‰ç•™å­˜è¡¨ç°

---

## ä¸‰ã€æ ‡å‡†åŒ–MDæ¨¡æ¿

### 3.1 æ¨¡æ¿ç‰¹ç‚¹

**æ–‡ä»¶**: `/templates/weekly_report_template.md`

**ç‰¹ç‚¹**:
1. **å˜é‡åŒ–**: æ‰€æœ‰æ•°æ®ç‚¹éƒ½ä½¿ç”¨`{{variable}}`å ä½ç¬¦
2. **ç»“æ„åŒ–**: ä¸¥æ ¼æŒ‰ç…§å‚è€ƒæ ¼å¼ç»„ç»‡
3. **å®Œæ•´æ€§**: åŒ…å«æ‰€æœ‰5ä¸ªéƒ¨åˆ†çš„å®Œæ•´ç»“æ„
4. **å¯æ‰©å±•**: æ”¯æŒæ¡ä»¶å—å’Œå¾ªç¯

### 3.2 æ¨¡æ¿ä½¿ç”¨

```python
from generate_report import WeeklyReportGenerator

generator = WeeklyReportGenerator()

report = generator.generate_report(
    report_date='2026-02-03',
    week_label='20260126',
    week_end_date='2026-02-01',
    traffic_data={...},
    activation_data={...},
    engagement_data={...},
    retention_data={...},
    revenue_data={...}
)

generator.save_report(report, 'output/reports/weekly_report_20260203.md')
```

---

## å››ã€æ–°å¢æ•°æ®å¤„ç†æ¨¡å—

### 4.1 æŒ‡æ ‡æå–å™¨ (Metrics Extractor)

**æ–‡ä»¶**: `/src/metrics_extractor.py`

**åŠŸèƒ½**:
- ä»JSONæ•°æ®ä¸­æå–å…³é”®æŒ‡æ ‡
- è®¡ç®—ç¯æ¯”å˜åŒ–
- è®¡ç®—å¹³å‡å€¼å’Œæ±‡æ€»
- ç”Ÿæˆåˆ†ææ–‡å­—

**ä¸»è¦æ–¹æ³•**:
```python
class MetricsExtractor:
    def extract_traffic_metrics(self, data: List[Dict]) -> Dict
    def extract_activation_metrics(self, data: List[Dict]) -> Dict
    def extract_engagement_metrics(self, data: List[Dict]) -> Dict
    def extract_retention_metrics(self, data: List[Dict]) -> Dict
    def extract_revenue_metrics(self, data: List[Dict]) -> Dict
    def extract_revenue_sku_metrics(self, data: List[Dict]) -> Dict
    def extract_revenue_country_metrics(self, data: List[Dict]) -> Dict
    def extract_revenue_tier_metrics(self, data: List[Dict]) -> Dict
    def calculate_wow_change(self, current: float, previous: float) -> Dict
    def calculate_historical_avg(self, data: List[Dict]) -> float
```

### 4.2 æ•°æ®å¤„ç†å™¨ (Data Processor)

**æ–‡ä»¶**: `/src/data_processor.py`

**åŠŸèƒ½**:
- æ•´åˆå¤šä¸ªSQLæŸ¥è¯¢ç»“æœ
- æ‰§è¡Œè·¨éƒ¨åˆ†çš„æ•°æ®å…³è”
- ç”ŸæˆAIåˆ†ææ–‡å­—
- è¾“å‡ºæ ‡å‡†åŒ–æ•°æ®ç»“æ„

**ä¸»è¦æ–¹æ³•**:
```python
class DataProcessor:
    def process_traffic_data(self, current: List[Dict], previous: List[Dict]) -> Dict
    def process_activation_data(self, current: List[Dict], previous: List[Dict]) -> Dict
    def process_engagement_data(self, current: List[Dict], previous: List[Dict], historical: List[Dict]) -> Dict
    def process_retention_data(self, current: List[Dict], previous: List[Dict], historical: List[Dict]) -> Dict
    def process_revenue_data(self, current: List[Dict], previous: List[Dict], sku: List[Dict], country: List[Dict], tier: List[Dict]) -> Dict
    def generate_ai_summary(self, data: Dict) -> str
```

---

## äº”ã€æ•°æ®æŸ¥è¯¢ä¼˜åŒ–å»ºè®®

### 5.1 æµé‡éƒ¨åˆ†ä¼˜åŒ–

**å½“å‰ç¼ºå¤±**:
- âŒ æ³¨å†Œè½¬åŒ–ç‡çš„ç¯æ¯”å˜åŒ–

**ä¼˜åŒ–æ–¹æ¡ˆ**:
- âœ… å·²åœ¨`01_traffic.sql`ä¸­æ·»åŠ è½¬åŒ–ç‡è®¡ç®—
- âœ… éœ€è¦åœ¨æ•°æ®å¤„ç†å±‚è®¡ç®—ç¯æ¯”å˜åŒ–

### 5.2 æ´»è·ƒéƒ¨åˆ†ä¼˜åŒ–

**å½“å‰ç¼ºå¤±**:
- âŒ 25å‘¨å†å²å¹³å‡WAU

**ä¼˜åŒ–æ–¹æ¡ˆ**:
- âœ… æ–°å¢`09_engagement_historical.sql`
- âœ… åœ¨æŠ¥å‘Šä¸­å±•ç¤ºå†å²å¹³å‡å€¼

### 5.3 ç•™å­˜éƒ¨åˆ†ä¼˜åŒ–

**å½“å‰ç¼ºå¤±**:
- âŒ è¿‘12å‘¨æ–°ç”¨æˆ·ç•™å­˜å¹³å‡å€¼
- âŒ è¿‘12å‘¨è€ç”¨æˆ·ç•™å­˜å¹³å‡å€¼

**ä¼˜åŒ–æ–¹æ¡ˆ**:
- âœ… æ–°å¢`10_retention_historical.sql`
- âœ… åœ¨æŠ¥å‘Šä¸­å±•ç¤ºå†å²å¹³å‡å€¼

### 5.4 æ”¶å…¥éƒ¨åˆ†ä¼˜åŒ–ï¼ˆé‡è¦ï¼‰

**å½“å‰ç¼ºå¤±**:
- âŒ SKUç»´åº¦æ•°æ®ï¼ˆpro_year_cyclicalç­‰ï¼‰
- âŒ å›½å®¶ç»´åº¦æ•°æ®
- âŒ è´¦å•åˆ†å±‚è¯¦ç»†æ•°æ®

**ä¼˜åŒ–æ–¹æ¡ˆ**:
- âœ… æ–°å¢`06_revenue_by_sku.sql` - SKUç»´åº¦
- âœ… æ–°å¢`07_revenue_by_country.sql` - å›½å®¶ç»´åº¦
- âœ… æ–°å¢`08_revenue_by_tier.sql` - è´¦å•åˆ†å±‚

---

## å…­ã€æŠ¥å‘Šç”Ÿæˆæµç¨‹ä¼˜åŒ–

### 6.1 å½“å‰æµç¨‹

```
1. äº¤äº’å¼é€‰æ‹©å‘¨
2. è®¡ç®—æ—¥æœŸå‚æ•°
3. æ‰§è¡ŒSQLæŸ¥è¯¢ï¼ˆæœ¬å‘¨+ä¸Šå‘¨ï¼‰
4. æ•°æ®åˆ†æ
5. ç”ŸæˆHTMLæŠ¥å‘Š
6. æ›´æ–°Confluence
```

### 6.2 ä¼˜åŒ–åæµç¨‹

```
1. äº¤äº’å¼é€‰æ‹©å‘¨
2. è®¡ç®—æ—¥æœŸå‚æ•°
3. æ‰§è¡ŒSQLæŸ¥è¯¢
   - åŸºç¡€æŸ¥è¯¢ï¼ˆæµé‡ã€æ¿€æ´»ã€ç•™å­˜ã€æ”¶å…¥ï¼‰
   - ç»´åº¦æŸ¥è¯¢ï¼ˆSKUã€å›½å®¶ã€è´¦å•åˆ†å±‚ï¼‰
   - å†å²æŸ¥è¯¢ï¼ˆ25å‘¨WAUã€12å‘¨ç•™å­˜ï¼‰
   æœ¬å‘¨æ•°æ® + ä¸Šå‘¨æ•°æ®
4. æ•°æ®å¤„ç†
   - æå–å…³é”®æŒ‡æ ‡
   - è®¡ç®—ç¯æ¯”å˜åŒ–
   - è®¡ç®—å†å²å¹³å‡å€¼
   - ç”Ÿæˆåˆ†ææ–‡å­—
5. ç”ŸæˆæŠ¥å‘Š
   - ä½¿ç”¨MDæ¨¡æ¿
   - å¡«å……æ•°æ®
   - ä¿å­˜MDæ–‡ä»¶
6. è½¬æ¢ä¸ºHTMLï¼ˆå¯é€‰ï¼‰
7. æ›´æ–°Confluence
```

### 6.3 æ•°æ®æµ

```
SQLæŸ¥è¯¢ â†’ JSONæ•°æ® â†’ æŒ‡æ ‡æå– â†’ æ•°æ®å¤„ç† â†’ æ¨¡æ¿å¡«å…… â†’ æŠ¥å‘Šç”Ÿæˆ
```

---

## ä¸ƒã€å®æ–½æ­¥éª¤

### ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€ä¼˜åŒ–ï¼ˆ1-2å¤©ï¼‰

1. âœ… åˆ›å»ºæ ‡å‡†åŒ–MDæ¨¡æ¿
2. âœ… åˆ›å»ºæŠ¥å‘Šç”Ÿæˆè„šæœ¬æ¡†æ¶
3. âš ï¸ ä¼˜åŒ–æŒ‡æ ‡æå–å™¨
4. âš ï¸ ä¼˜åŒ–æ•°æ®å¤„ç†å™¨

### ç¬¬äºŒé˜¶æ®µï¼šæ–°å¢SQLï¼ˆ2-3å¤©ï¼‰

1. âš ï¸ åˆ›å»ºSKUç»´åº¦SQL
2. âš ï¸ åˆ›å»ºå›½å®¶ç»´åº¦SQL
3. âš ï¸ åˆ›å»ºè´¦å•åˆ†å±‚SQL
4. âš ï¸ åˆ›å»ºå†å²WAU SQL
5. âš ï¸ åˆ›å»ºå†å²ç•™å­˜SQL
6. âš ï¸ æµ‹è¯•æ‰€æœ‰SQLæŸ¥è¯¢

### ç¬¬ä¸‰é˜¶æ®µï¼šé›†æˆæµ‹è¯•ï¼ˆ1-2å¤©ï¼‰

1. âš ï¸ æ•´åˆæ‰€æœ‰æ¨¡å—
2. âš ï¸ ç«¯åˆ°ç«¯æµ‹è¯•
3. âš ï¸ æ•°æ®å‡†ç¡®æ€§éªŒè¯
4. âš ï¸ æ€§èƒ½ä¼˜åŒ–

### ç¬¬å››é˜¶æ®µï¼šæ–‡æ¡£å’ŒåŸ¹è®­ï¼ˆ1å¤©ï¼‰

1. âš ï¸ æ›´æ–°README
2. âš ï¸ ç¼–å†™ä½¿ç”¨æ–‡æ¡£
3. âš ï¸ åˆ›å»ºç¤ºä¾‹æ•°æ®
4. âš ï¸ åŸ¹è®­ä½¿ç”¨æ–¹æ³•

---

## å…«ã€é…ç½®æ–‡ä»¶ä¼˜åŒ–

### 8.1 æŠ¥å‘Šå„éƒ¨åˆ†é…ç½®

**æ–‡ä»¶**: `/config/report_sections.yaml`

```yaml
# æŠ¥å‘Šå„éƒ¨åˆ†é…ç½®
sections:
  traffic:
    name: "æµé‡"
    sql_file: "01_traffic.sql"
    required: true
    metrics:
      - name: "æ€»æ–°è®¿å®¢"
        key: "total_guests"
        format: "number"
      - name: "æ€»æ³¨å†Œæ•°"
        key: "total_registers"
        format: "number"
      - name: "æ•´ä½“è½¬åŒ–ç‡"
        key: "conversion_rate"
        format: "percentage"

  activation:
    name: "æ¿€æ´»"
    sql_file: "02_activation.sql"
    required: true
    metrics:
      - name: "æ³¨å†Œâ†’è¿›å·¥å…·"
        key: "step1_rate"
        format: "percentage"
      - name: "è¿›å·¥å…·â†’ç”»æˆ·å‹"
        key: "step2_rate"
        format: "percentage"
      # ...

  engagement:
    name: "æ´»è·ƒ"
    sql_files:
      - "03_engagement_all_users.sql"
      - "03_engagement_new_old_users.sql"
      - "09_engagement_historical.sql"
    required: true

  retention:
    name: "ç•™å­˜"
    sql_files:
      - "04_retention.sql"
      - "10_retention_historical.sql"
    required: true

  revenue:
    name: "æ”¶å…¥"
    sql_files:
      - "05_revenue.sql"
      - "06_revenue_by_sku.sql"
      - "07_revenue_by_country.sql"
      - "08_revenue_by_tier.sql"
    required: true
    dimensions:
      - name: "SKU"
        key: "sku"
        required: true
      - name: "å›½å®¶"
        key: "country"
        required: true
      - name: "è´¦å•åˆ†å±‚"
        key: "tier"
        required: true
```

---

## ä¹ã€æ•°æ®å‡†ç¡®æ€§ä¿è¯

### 9.1 æ•°æ®éªŒè¯æ£€æŸ¥ç‚¹

1. **SQLå±‚éªŒè¯**:
   - æŸ¥è¯¢ç»“æœä¸ä¸ºç©º
   - æ•°æ®æ ¼å¼æ­£ç¡®
   - æ•°å€¼åœ¨åˆç†èŒƒå›´

2. **å¤„ç†å±‚éªŒè¯**:
   - æŒ‡æ ‡è®¡ç®—æ­£ç¡®
   - ç¯æ¯”å˜åŒ–åˆç†
   - å†å²æ•°æ®å®Œæ•´

3. **æŠ¥å‘Šå±‚éªŒè¯**:
   - æ‰€æœ‰å˜é‡å·²å¡«å……
   - æ•°å€¼æ ¼å¼æ­£ç¡®
   - æ–‡å­—æè¿°å‡†ç¡®

### 9.2 å¼‚å¸¸å¤„ç†

```python
# æ•°æ®ç¼ºå¤±æ—¶çš„å¤„ç†
if not traffic_data:
    logger.warning("æµé‡æ•°æ®ç¼ºå¤±ï¼Œä½¿ç”¨é»˜è®¤å€¼")
    traffic_data = get_default_traffic_data()

# æ•°æ®å¼‚å¸¸æ—¶çš„å¤„ç†
if conversion_rate > 100:
    logger.error(f"è½¬åŒ–ç‡å¼‚å¸¸: {conversion_rate}")
    raise ValueError("è½¬åŒ–ç‡ä¸èƒ½è¶…è¿‡100%")

# æ•°æ®ä¸ä¸€è‡´æ—¶çš„å¤„ç†
if total_guests < total_registers:
    logger.warning(f"æ³¨å†Œæ•°({total_registers})å¤§äºè®¿å®¢æ•°({total_guests})")
```

---

## åã€æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 10.1 æŸ¥è¯¢ä¼˜åŒ–

1. **å¹¶è¡ŒæŸ¥è¯¢**: å¤šä¸ªSQLæŸ¥è¯¢å¯ä»¥å¹¶è¡Œæ‰§è¡Œ
2. **æŸ¥è¯¢ç¼“å­˜**: ç¼“å­˜å†å²æ•°æ®æŸ¥è¯¢ç»“æœ
3. **å¢é‡æŸ¥è¯¢**: åªæŸ¥è¯¢æ–°å¢çš„æ•°æ®

### 10.2 æ•°æ®å¤„ç†ä¼˜åŒ–

1. **å¢é‡å¤„ç†**: åªå¤„ç†å˜åŒ–çš„æ•°æ®
2. **æ‰¹é‡å¤„ç†**: æ‰¹é‡å¤„ç†å¤šå‘¨æ•°æ®
3. **å†…å­˜ä¼˜åŒ–**: ä½¿ç”¨ç”Ÿæˆå™¨å‡å°‘å†…å­˜å ç”¨

### 10.3 æŠ¥å‘Šç”Ÿæˆä¼˜åŒ–

1. **æ¨¡æ¿ç¼“å­˜**: ç¼“å­˜ç¼–è¯‘åçš„æ¨¡æ¿
2. **å¹¶è¡Œç”Ÿæˆ**: å¹¶è¡Œç”Ÿæˆå¤šä¸ªéƒ¨åˆ†
3. **å¢é‡æ›´æ–°**: åªæ›´æ–°å˜åŒ–çš„éƒ¨åˆ†

---

## åä¸€ã€åç»­æ”¹è¿›æ–¹å‘

### 11.1 çŸ­æœŸæ”¹è¿›ï¼ˆ1-2å‘¨ï¼‰

1. å®Œå–„æ‰€æœ‰æ–°å¢SQLæŸ¥è¯¢
2. å®ç°æŒ‡æ ‡æå–å™¨
3. å®ç°æ•°æ®å¤„ç†å™¨
4. å®Œæˆç«¯åˆ°ç«¯æµ‹è¯•

### 11.2 ä¸­æœŸæ”¹è¿›ï¼ˆ1-2æœˆï¼‰

1. æ·»åŠ æ•°æ®å¯è§†åŒ–
2. å®ç°å¼‚å¸¸æ£€æµ‹
3. æ·»åŠ è¶‹åŠ¿é¢„æµ‹
4. ä¼˜åŒ–æŠ¥å‘Šæ ¼å¼

### 11.3 é•¿æœŸæ”¹è¿›ï¼ˆ3-6æœˆï¼‰

1. å®ç°è‡ªåŠ¨å‘Šè­¦
2. æ·»åŠ æ™ºèƒ½æ¨è
3. é›†æˆæ›´å¤šæ•°æ®æº
4. å®ç°å¤šè¯­è¨€æ”¯æŒ

---

## åäºŒã€æ€»ç»“

æœ¬ä¼˜åŒ–æ–¹æ¡ˆæä¾›äº†ï¼š

1. âœ… **æ ‡å‡†åŒ–æ¨¡æ¿**: åˆ›å»ºäº†ç¬¦åˆå‚è€ƒæ ¼å¼çš„MDæ¨¡æ¿
2. âœ… **æ–°å¢SQL**: æ·»åŠ äº†5ä¸ªæ–°çš„SQLæŸ¥è¯¢æ–‡ä»¶
3. âœ… **é¡¹ç›®ç»“æ„**: ä¼˜åŒ–äº†é¡¹ç›®ç›®å½•ç»“æ„
4. âœ… **æ•°æ®å¤„ç†**: è®¾è®¡äº†æ–°çš„æ•°æ®å¤„ç†æ¨¡å—
5. âœ… **å®æ–½æ­¥éª¤**: æä¾›äº†è¯¦ç»†çš„å®æ–½è®¡åˆ’

**å…³é”®ä¼˜åŠ¿**:
- ğŸ“Š æ›´å…¨é¢çš„æ•°æ®ç»´åº¦
- ğŸ¯ æ›´ç²¾å‡†çš„æŒ‡æ ‡åˆ†æ
- ğŸš€ æ›´é«˜æ•ˆçš„ç”Ÿæˆæµç¨‹
- ğŸ“ˆ æ›´æ˜“ç»´æŠ¤çš„ä»£ç ç»“æ„
- ğŸ“ æ›´æ ‡å‡†çš„æŠ¥å‘Šæ ¼å¼

**é¢„æœŸæ•ˆæœ**:
- æŠ¥å‘Šç”Ÿæˆæ—¶é—´å‡å°‘50%
- æ•°æ®å‡†ç¡®æ€§æå‡è‡³99%+
- ç»´æŠ¤æˆæœ¬é™ä½60%
- ç”¨æˆ·æ»¡æ„åº¦æ˜¾è‘—æå‡

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**æœ€åæ›´æ–°**: 2026-02-03
**ç»´æŠ¤è€…**: Coohomæ•°æ®åˆ†æå›¢é˜Ÿ
