2026-01-27 18:14:20 - weekly_report - INFO - main:80 - ============================================================
2026-01-27 18:14:20 - weekly_report - INFO - main:81 - Coohom周报自动化更新系统启动（模拟数据演示版）
2026-01-27 18:14:20 - weekly_report - INFO - main:82 - ============================================================
2026-01-27 18:14:20 - weekly_report - INFO - main:83 - 
2026-01-27 18:14:20 - weekly_report - INFO - main:84 - ⚠️  注意：此版本使用模拟数据，不会查询真实的Metabase
2026-01-27 18:14:20 - weekly_report - INFO - main:85 - ⚠️  不会更新真实的Confluence页面
2026-01-27 18:14:20 - weekly_report - INFO - main:86 - 
2026-01-27 18:14:20 - weekly_report - ERROR - main:184 - 
❌ 执行过程中出现异常: EOF when reading a line
Traceback (most recent call last):
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/main_demo.py", line 90, in main
    week_config = ask_target_week()
                  ^^^^^^^^^^^^^^^^^
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/src/interactive_prompt.py", line 30, in ask_target_week
    choice = input("\n请输入选项 (1-4, 默认1): ").strip() or "1"
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
EOFError: EOF when reading a line
2026-02-24 14:10:39 - weekly_report - INFO - main:44 - ============================================================
2026-02-24 14:10:39 - weekly_report - INFO - main:45 - Coohom周报自动化更新系统启动
2026-02-24 14:10:39 - weekly_report - INFO - main:46 - ============================================================
2026-02-24 14:10:39 - weekly_report - ERROR - main:158 - 
❌ 执行过程中出现异常: EOF when reading a line
Traceback (most recent call last):
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/main.py", line 50, in main
    week_config = ask_target_week()
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/src/interactive_prompt.py", line 30, in ask_target_week
    choice = input("\n请输入选项 (1-4, 默认1): ").strip() or "1"
EOFError: EOF when reading a line
2026-02-24 14:10:57 - weekly_report - INFO - main:44 - ============================================================
2026-02-24 14:10:57 - weekly_report - INFO - main:45 - Coohom周报自动化更新系统启动
2026-02-24 14:10:57 - weekly_report - INFO - main:46 - ============================================================
2026-02-24 14:10:57 - weekly_report - INFO - main:51 - 目标周: 本周
2026-02-24 14:10:57 - weekly_report - INFO - main:58 - 报告日期: 2026-02-28
2026-02-24 14:10:57 - weekly_report - INFO - main:59 - 周范围: 20260223 ~ 20260228
2026-02-24 14:10:57 - weekly_report - ERROR - main:158 - 
❌ 执行过程中出现异常: EOF when reading a line
Traceback (most recent call last):
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/main.py", line 62, in main
    md_content = ask_revenue_summary()
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/src/interactive_prompt.py", line 82, in ask_revenue_summary
    has_md = input("\n本周是否有收入周总结MD文档？ (y/n, 默认n): ").strip().lower() or "n"
EOFError: EOF when reading a line
2026-02-24 14:15:44 - weekly_report - INFO - main:140 - ============================================================
2026-02-24 14:15:44 - weekly_report - INFO - main:141 - Coohom周报自动化更新系统启动
2026-02-24 14:15:44 - weekly_report - INFO - main:142 - ============================================================
2026-02-24 14:15:44 - weekly_report - INFO - main:149 - 目标周: 本周
2026-02-24 14:15:44 - weekly_report - INFO - main:150 - 报告日期: 
2026-02-24 14:15:44 - weekly_report - INFO - main:151 - 周范围:  ~ 
2026-02-24 14:15:44 - weekly_report - INFO - main:164 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 14:15:44 - weekly_report - INFO - main:185 - 加载配置文件...
2026-02-24 14:15:44 - weekly_report - INFO - main:190 - 
============================================================
2026-02-24 14:15:44 - weekly_report - INFO - main:191 - 第一阶段：数据获取
2026-02-24 14:15:44 - weekly_report - INFO - main:192 - ============================================================
2026-02-24 14:15:44 - weekly_report - INFO - main:195 - 获取本周数据...
2026-02-24 14:15:44 - weekly_report - INFO - fetch_all_sections:140 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 14:15:44 - weekly_report - INFO - fetch_section_data:108 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 14:15:44 - weekly_report - INFO - execute_metabase_query:52 - 正在执行Metabase查询...
2026-02-24 14:15:44 - weekly_report - ERROR - execute_metabase_query:83 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 14:15:44 - weekly_report - INFO - fetch_section_data:108 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 14:15:44 - weekly_report - INFO - execute_metabase_query:52 - 正在执行Metabase查询...
2026-02-24 14:15:44 - weekly_report - ERROR - execute_metabase_query:83 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 14:15:44 - weekly_report - INFO - fetch_section_data:108 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 14:15:44 - weekly_report - INFO - execute_metabase_query:52 - 正在执行Metabase查询...
2026-02-24 14:15:44 - weekly_report - ERROR - execute_metabase_query:83 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 14:15:44 - weekly_report - INFO - fetch_section_data:108 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 14:15:44 - weekly_report - INFO - execute_metabase_query:52 - 正在执行Metabase查询...
2026-02-24 14:15:44 - weekly_report - ERROR - execute_metabase_query:83 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 14:15:44 - weekly_report - INFO - fetch_section_data:108 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 14:15:44 - weekly_report - INFO - execute_metabase_query:52 - 正在执行Metabase查询...
2026-02-24 14:15:44 - weekly_report - ERROR - execute_metabase_query:83 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 14:15:44 - weekly_report - INFO - fetch_section_data:108 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 14:15:44 - weekly_report - INFO - execute_metabase_query:52 - 正在执行Metabase查询...
2026-02-24 14:15:44 - weekly_report - ERROR - execute_metabase_query:83 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 14:15:44 - weekly_report - INFO - fetch_all_sections:157 - ✅ 数据获取完成
2026-02-24 14:15:44 - weekly_report - INFO - main:197 - 获取数据获取情况
2026-02-24 14:15:44 - weekly_report - WARNING - main:204 - ⚠️  6 个部分无数据
2026-02-24 14:15:44 - weekly_report - INFO - main:207 - 
获取上周数据（用于环比计算）...
2026-02-24 14:15:44 - weekly_report - INFO - fetch_all_sections:140 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 14:15:44 - weekly_report - INFO - fetch_section_data:108 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 14:15:44 - weekly_report - INFO - execute_metabase_query:52 - 正在执行Metabase查询...
2026-02-24 14:15:44 - weekly_report - ERROR - execute_metabase_query:83 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 14:15:44 - weekly_report - INFO - fetch_section_data:108 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 14:15:44 - weekly_report - INFO - execute_metabase_query:52 - 正在执行Metabase查询...
2026-02-24 14:15:44 - weekly_report - ERROR - execute_metabase_query:83 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 14:15:44 - weekly_report - INFO - fetch_section_data:108 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 14:15:44 - weekly_report - INFO - execute_metabase_query:52 - 正在执行Metabase查询...
2026-02-24 14:15:44 - weekly_report - ERROR - execute_metabase_query:83 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 14:15:44 - weekly_report - INFO - fetch_section_data:108 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 14:15:44 - weekly_report - INFO - execute_metabase_query:52 - 正在执行Metabase查询...
2026-02-24 14:15:44 - weekly_report - ERROR - execute_metabase_query:83 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 14:15:44 - weekly_report - INFO - fetch_section_data:108 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 14:15:44 - weekly_report - INFO - execute_metabase_query:52 - 正在执行Metabase查询...
2026-02-24 14:15:44 - weekly_report - ERROR - execute_metabase_query:83 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 14:15:44 - weekly_report - INFO - fetch_section_data:108 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 14:15:44 - weekly_report - INFO - execute_metabase_query:52 - 正在执行Metabase查询...
2026-02-24 14:15:44 - weekly_report - ERROR - execute_metabase_query:83 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 14:15:44 - weekly_report - INFO - fetch_all_sections:157 - ✅ 数据获取完成
2026-02-24 14:15:44 - weekly_report - INFO - main:211 - 
============================================================
2026-02-24 14:15:44 - weekly_report - INFO - main:212 - 第二阶段：数据分析
2026-02-24 14:15:44 - weekly_report - INFO - main:213 - ============================================================
2026-02-24 14:15:44 - weekly_report - INFO - analyze_all_sections:150 - 开始分析所有部分...
2026-02-24 14:15:44 - weekly_report - INFO - analyze_all_sections:170 - ✅ 所有部分分析完成
2026-02-24 14:15:44 - weekly_report - INFO - main:225 - 
============================================================
2026-02-24 14:15:44 - weekly_report - INFO - main:226 - 第三阶段：报告生成
2026-02-24 14:15:44 - weekly_report - INFO - main:227 - ============================================================
2026-02-24 14:15:44 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 14:15:44 - weekly_report - INFO - generate_full_report:591 - 生成完整报告HTML...
2026-02-24 14:15:44 - weekly_report - ERROR - main:264 - 
❌ 执行过程中出现异常: 'report_date'
Traceback (most recent call last):
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/main.py", line 230, in main
    html_content = generator.generate_full_report(
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/src/report_generator.py", line 599, in generate_full_report
    html_parts.append(f"<h1>平台整体数据 - {params['report_date']}</h1>")
KeyError: 'report_date'
2026-02-24 14:16:15 - weekly_report - INFO - main:148 - ============================================================
2026-02-24 14:16:15 - weekly_report - INFO - main:149 - Coohom周报自动化更新系统启动
2026-02-24 14:16:15 - weekly_report - INFO - main:150 - ============================================================
2026-02-24 14:16:15 - weekly_report - INFO - main:157 - 目标周: 本周
2026-02-24 14:16:15 - weekly_report - INFO - main:158 - 报告日期: 2026-02-28
2026-02-24 14:16:15 - weekly_report - INFO - main:159 - 周范围: 20260223 ~ 20260228
2026-02-24 14:16:15 - weekly_report - INFO - main:172 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 14:16:15 - weekly_report - INFO - main:193 - 加载配置文件...
2026-02-24 14:16:15 - weekly_report - INFO - main:198 - 
============================================================
2026-02-24 14:16:15 - weekly_report - INFO - main:199 - 第一阶段：数据获取
2026-02-24 14:16:15 - weekly_report - INFO - main:200 - ============================================================
2026-02-24 14:16:15 - weekly_report - INFO - main:203 - 获取本周数据...
2026-02-24 14:16:15 - weekly_report - INFO - fetch_all_sections:140 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 14:16:15 - weekly_report - INFO - fetch_section_data:108 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 14:16:15 - weekly_report - INFO - execute_metabase_query:52 - 正在执行Metabase查询...
2026-02-24 14:16:15 - weekly_report - ERROR - execute_metabase_query:83 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 14:16:15 - weekly_report - INFO - fetch_section_data:108 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 14:16:15 - weekly_report - INFO - execute_metabase_query:52 - 正在执行Metabase查询...
2026-02-24 14:16:15 - weekly_report - ERROR - execute_metabase_query:83 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 14:16:15 - weekly_report - INFO - fetch_section_data:108 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 14:16:15 - weekly_report - INFO - execute_metabase_query:52 - 正在执行Metabase查询...
2026-02-24 14:16:15 - weekly_report - ERROR - execute_metabase_query:83 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 14:16:15 - weekly_report - INFO - fetch_section_data:108 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 14:16:15 - weekly_report - INFO - execute_metabase_query:52 - 正在执行Metabase查询...
2026-02-24 14:16:15 - weekly_report - ERROR - execute_metabase_query:83 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 14:16:15 - weekly_report - INFO - fetch_section_data:108 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 14:16:15 - weekly_report - INFO - execute_metabase_query:52 - 正在执行Metabase查询...
2026-02-24 14:16:15 - weekly_report - ERROR - execute_metabase_query:83 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 14:16:15 - weekly_report - INFO - fetch_section_data:108 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 14:16:15 - weekly_report - INFO - execute_metabase_query:52 - 正在执行Metabase查询...
2026-02-24 14:16:15 - weekly_report - ERROR - execute_metabase_query:83 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 14:16:15 - weekly_report - INFO - fetch_all_sections:157 - ✅ 数据获取完成
2026-02-24 14:16:15 - weekly_report - INFO - main:205 - 获取数据获取情况
2026-02-24 14:16:15 - weekly_report - WARNING - main:212 - ⚠️  6 个部分无数据
2026-02-24 14:16:15 - weekly_report - INFO - main:215 - 
获取上周数据（用于环比计算）...
2026-02-24 14:16:15 - weekly_report - INFO - fetch_all_sections:140 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 14:16:15 - weekly_report - INFO - fetch_section_data:108 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 14:16:15 - weekly_report - INFO - execute_metabase_query:52 - 正在执行Metabase查询...
2026-02-24 14:16:15 - weekly_report - ERROR - execute_metabase_query:83 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 14:16:15 - weekly_report - INFO - fetch_section_data:108 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 14:16:15 - weekly_report - INFO - execute_metabase_query:52 - 正在执行Metabase查询...
2026-02-24 14:16:15 - weekly_report - ERROR - execute_metabase_query:83 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 14:16:15 - weekly_report - INFO - fetch_section_data:108 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 14:16:15 - weekly_report - INFO - execute_metabase_query:52 - 正在执行Metabase查询...
2026-02-24 14:16:15 - weekly_report - ERROR - execute_metabase_query:83 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 14:16:15 - weekly_report - INFO - fetch_section_data:108 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 14:16:15 - weekly_report - INFO - execute_metabase_query:52 - 正在执行Metabase查询...
2026-02-24 14:16:15 - weekly_report - ERROR - execute_metabase_query:83 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 14:16:15 - weekly_report - INFO - fetch_section_data:108 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 14:16:15 - weekly_report - INFO - execute_metabase_query:52 - 正在执行Metabase查询...
2026-02-24 14:16:15 - weekly_report - ERROR - execute_metabase_query:83 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 14:16:15 - weekly_report - INFO - fetch_section_data:108 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 14:16:15 - weekly_report - INFO - execute_metabase_query:52 - 正在执行Metabase查询...
2026-02-24 14:16:15 - weekly_report - ERROR - execute_metabase_query:83 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 14:16:15 - weekly_report - INFO - fetch_all_sections:157 - ✅ 数据获取完成
2026-02-24 14:16:15 - weekly_report - INFO - main:219 - 
============================================================
2026-02-24 14:16:15 - weekly_report - INFO - main:220 - 第二阶段：数据分析
2026-02-24 14:16:15 - weekly_report - INFO - main:221 - ============================================================
2026-02-24 14:16:15 - weekly_report - INFO - analyze_all_sections:150 - 开始分析所有部分...
2026-02-24 14:16:15 - weekly_report - INFO - analyze_all_sections:170 - ✅ 所有部分分析完成
2026-02-24 14:16:15 - weekly_report - INFO - main:233 - 
============================================================
2026-02-24 14:16:15 - weekly_report - INFO - main:234 - 第三阶段：报告生成
2026-02-24 14:16:15 - weekly_report - INFO - main:235 - ============================================================
2026-02-24 14:16:15 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 14:16:15 - weekly_report - INFO - generate_full_report:591 - 生成完整报告HTML...
2026-02-24 14:16:15 - weekly_report - INFO - generate_full_report:615 - ✅ 完整报告HTML生成完成
2026-02-24 14:16:15 - weekly_report - INFO - main:246 - ✅ 报告HTML生成完成
2026-02-24 14:16:15 - weekly_report - INFO - main:249 - 
============================================================
2026-02-24 14:16:15 - weekly_report - INFO - main:250 - 第四阶段：更新Confluence
2026-02-24 14:16:15 - weekly_report - INFO - main:251 - ============================================================
2026-02-24 14:16:15 - weekly_report - INFO - update_page:78 - 更新Confluence页面...
2026-02-24 14:16:15 - weekly_report - INFO - get_current_page:37 - 获取Confluence页面 (Page ID: 81397518314)...
2026-02-24 14:16:15 - weekly_report - ERROR - get_current_page:60 - ❌ 获取页面异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 14:16:15 - weekly_report - ERROR - update_page:84 - ❌ 无法获取当前页面信息
2026-02-24 14:16:15 - weekly_report - ERROR - main:266 - 
============================================================
2026-02-24 14:16:15 - weekly_report - ERROR - main:267 - ❌ 周报更新失败
2026-02-24 14:20:28 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 14:20:28 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 14:20:28 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 14:20:28 - weekly_report - INFO - main:164 - 目标周: 本周
2026-02-24 14:20:28 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 14:20:28 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 14:20:28 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 14:20:28 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 14:20:28 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 14:20:28 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 14:20:28 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 14:20:28 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 14:20:28 - weekly_report - INFO - fetch_all_sections:204 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 14:20:28 - weekly_report - INFO - fetch_section_data:170 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 14:20:28 - weekly_report - INFO - execute_metabase_query:90 - 正在执行Metabase查询...
2026-02-24 14:20:28 - weekly_report - ERROR - execute_metabase_query:137 - ❌ 网络请求异常: HTTPSConnectionPool(host='bi.qunhequnhe.com', port=443): Max retries exceeded with url: /api/database/2/query (Caused by NameResolutionError("HTTPSConnection(host='bi.qunhequnhe.com', port=443): Failed to resolve 'bi.qunhequnhe.com' ([Errno 8] nodename nor servname provided, or not known)"))
2026-02-24 14:20:28 - weekly_report - INFO - fetch_section_data:170 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 14:20:28 - weekly_report - INFO - execute_metabase_query:90 - 正在执行Metabase查询...
2026-02-24 14:20:28 - weekly_report - ERROR - execute_metabase_query:137 - ❌ 网络请求异常: HTTPSConnectionPool(host='bi.qunhequnhe.com', port=443): Max retries exceeded with url: /api/database/2/query (Caused by NameResolutionError("HTTPSConnection(host='bi.qunhequnhe.com', port=443): Failed to resolve 'bi.qunhequnhe.com' ([Errno 8] nodename nor servname provided, or not known)"))
2026-02-24 14:20:28 - weekly_report - INFO - fetch_section_data:170 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 14:20:28 - weekly_report - INFO - execute_metabase_query:90 - 正在执行Metabase查询...
2026-02-24 14:20:28 - weekly_report - ERROR - execute_metabase_query:137 - ❌ 网络请求异常: HTTPSConnectionPool(host='bi.qunhequnhe.com', port=443): Max retries exceeded with url: /api/database/2/query (Caused by NameResolutionError("HTTPSConnection(host='bi.qunhequnhe.com', port=443): Failed to resolve 'bi.qunhequnhe.com' ([Errno 8] nodename nor servname provided, or not known)"))
2026-02-24 14:20:28 - weekly_report - INFO - fetch_section_data:170 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 14:20:28 - weekly_report - INFO - execute_metabase_query:90 - 正在执行Metabase查询...
2026-02-24 14:20:28 - weekly_report - ERROR - execute_metabase_query:137 - ❌ 网络请求异常: HTTPSConnectionPool(host='bi.qunhequnhe.com', port=443): Max retries exceeded with url: /api/database/2/query (Caused by NameResolutionError("HTTPSConnection(host='bi.qunhequnhe.com', port=443): Failed to resolve 'bi.qunhequnhe.com' ([Errno 8] nodename nor servname provided, or not known)"))
2026-02-24 14:20:28 - weekly_report - INFO - fetch_section_data:170 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 14:20:28 - weekly_report - INFO - execute_metabase_query:90 - 正在执行Metabase查询...
2026-02-24 14:20:28 - weekly_report - ERROR - execute_metabase_query:137 - ❌ 网络请求异常: HTTPSConnectionPool(host='bi.qunhequnhe.com', port=443): Max retries exceeded with url: /api/database/2/query (Caused by NameResolutionError("HTTPSConnection(host='bi.qunhequnhe.com', port=443): Failed to resolve 'bi.qunhequnhe.com' ([Errno 8] nodename nor servname provided, or not known)"))
2026-02-24 14:20:28 - weekly_report - INFO - fetch_section_data:170 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 14:20:28 - weekly_report - INFO - execute_metabase_query:90 - 正在执行Metabase查询...
2026-02-24 14:20:28 - weekly_report - ERROR - execute_metabase_query:137 - ❌ 网络请求异常: HTTPSConnectionPool(host='bi.qunhequnhe.com', port=443): Max retries exceeded with url: /api/database/2/query (Caused by NameResolutionError("HTTPSConnection(host='bi.qunhequnhe.com', port=443): Failed to resolve 'bi.qunhequnhe.com' ([Errno 8] nodename nor servname provided, or not known)"))
2026-02-24 14:20:28 - weekly_report - INFO - fetch_all_sections:221 - ✅ 数据获取完成
2026-02-24 14:20:28 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 14:20:28 - weekly_report - WARNING - main:219 - ⚠️  6 个部分无数据
2026-02-24 14:20:28 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 14:20:28 - weekly_report - INFO - fetch_all_sections:204 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 14:20:28 - weekly_report - INFO - fetch_section_data:170 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 14:20:28 - weekly_report - INFO - execute_metabase_query:90 - 正在执行Metabase查询...
2026-02-24 14:20:28 - weekly_report - ERROR - execute_metabase_query:137 - ❌ 网络请求异常: HTTPSConnectionPool(host='bi.qunhequnhe.com', port=443): Max retries exceeded with url: /api/database/2/query (Caused by NameResolutionError("HTTPSConnection(host='bi.qunhequnhe.com', port=443): Failed to resolve 'bi.qunhequnhe.com' ([Errno 8] nodename nor servname provided, or not known)"))
2026-02-24 14:20:28 - weekly_report - INFO - fetch_section_data:170 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 14:20:28 - weekly_report - INFO - execute_metabase_query:90 - 正在执行Metabase查询...
2026-02-24 14:20:28 - weekly_report - ERROR - execute_metabase_query:137 - ❌ 网络请求异常: HTTPSConnectionPool(host='bi.qunhequnhe.com', port=443): Max retries exceeded with url: /api/database/2/query (Caused by NameResolutionError("HTTPSConnection(host='bi.qunhequnhe.com', port=443): Failed to resolve 'bi.qunhequnhe.com' ([Errno 8] nodename nor servname provided, or not known)"))
2026-02-24 14:20:28 - weekly_report - INFO - fetch_section_data:170 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 14:20:28 - weekly_report - INFO - execute_metabase_query:90 - 正在执行Metabase查询...
2026-02-24 14:20:28 - weekly_report - ERROR - execute_metabase_query:137 - ❌ 网络请求异常: HTTPSConnectionPool(host='bi.qunhequnhe.com', port=443): Max retries exceeded with url: /api/database/2/query (Caused by NameResolutionError("HTTPSConnection(host='bi.qunhequnhe.com', port=443): Failed to resolve 'bi.qunhequnhe.com' ([Errno 8] nodename nor servname provided, or not known)"))
2026-02-24 14:20:28 - weekly_report - INFO - fetch_section_data:170 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 14:20:28 - weekly_report - INFO - execute_metabase_query:90 - 正在执行Metabase查询...
2026-02-24 14:20:28 - weekly_report - ERROR - execute_metabase_query:137 - ❌ 网络请求异常: HTTPSConnectionPool(host='bi.qunhequnhe.com', port=443): Max retries exceeded with url: /api/database/2/query (Caused by NameResolutionError("HTTPSConnection(host='bi.qunhequnhe.com', port=443): Failed to resolve 'bi.qunhequnhe.com' ([Errno 8] nodename nor servname provided, or not known)"))
2026-02-24 14:20:28 - weekly_report - INFO - fetch_section_data:170 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 14:20:28 - weekly_report - INFO - execute_metabase_query:90 - 正在执行Metabase查询...
2026-02-24 14:20:28 - weekly_report - ERROR - execute_metabase_query:137 - ❌ 网络请求异常: HTTPSConnectionPool(host='bi.qunhequnhe.com', port=443): Max retries exceeded with url: /api/database/2/query (Caused by NameResolutionError("HTTPSConnection(host='bi.qunhequnhe.com', port=443): Failed to resolve 'bi.qunhequnhe.com' ([Errno 8] nodename nor servname provided, or not known)"))
2026-02-24 14:20:28 - weekly_report - INFO - fetch_section_data:170 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 14:20:28 - weekly_report - INFO - execute_metabase_query:90 - 正在执行Metabase查询...
2026-02-24 14:20:28 - weekly_report - ERROR - execute_metabase_query:137 - ❌ 网络请求异常: HTTPSConnectionPool(host='bi.qunhequnhe.com', port=443): Max retries exceeded with url: /api/database/2/query (Caused by NameResolutionError("HTTPSConnection(host='bi.qunhequnhe.com', port=443): Failed to resolve 'bi.qunhequnhe.com' ([Errno 8] nodename nor servname provided, or not known)"))
2026-02-24 14:20:28 - weekly_report - INFO - fetch_all_sections:221 - ✅ 数据获取完成
2026-02-24 14:20:28 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 14:20:28 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 14:20:28 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 14:20:28 - weekly_report - INFO - analyze_all_sections:150 - 开始分析所有部分...
2026-02-24 14:20:28 - weekly_report - INFO - analyze_all_sections:170 - ✅ 所有部分分析完成
2026-02-24 14:20:28 - weekly_report - INFO - main:240 - 
============================================================
2026-02-24 14:20:28 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-24 14:20:28 - weekly_report - INFO - main:242 - ============================================================
2026-02-24 14:20:28 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 14:20:28 - weekly_report - INFO - generate_full_report:591 - 生成完整报告HTML...
2026-02-24 14:20:28 - weekly_report - INFO - generate_full_report:615 - ✅ 完整报告HTML生成完成
2026-02-24 14:20:28 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-24 14:20:28 - weekly_report - INFO - main:258 - 
============================================================
2026-02-24 14:20:28 - weekly_report - INFO - main:259 - 第四阶段：保存报告到文件
2026-02-24 14:20:28 - weekly_report - INFO - main:260 - ============================================================
2026-02-24 14:20:28 - weekly_report - INFO - save_html_to_file:199 - ✅ HTML已保存到: confluence_report_2026-02-28.html
2026-02-24 14:20:28 - weekly_report - INFO - main:267 - 
============================================================
2026-02-24 14:20:28 - weekly_report - INFO - main:268 - ✅ 报告已保存到本地文件！
2026-02-24 14:20:28 - weekly_report - INFO - main:269 - ============================================================
2026-02-24 14:20:28 - weekly_report - INFO - main:270 - 文件路径: output/confluence_report_2026-02-28.html
2026-02-24 14:20:28 - weekly_report - INFO - main:271 - 报告日期: 2026-02-28
2026-02-24 14:45:09 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 14:45:09 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 14:45:09 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 14:45:09 - weekly_report - INFO - main:164 - 目标周: 本周
2026-02-24 14:45:09 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 14:45:09 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 14:45:09 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 14:45:09 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 14:45:09 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 14:45:09 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 14:45:09 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 14:45:09 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 14:45:09 - weekly_report - INFO - fetch_all_sections:204 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 14:45:09 - weekly_report - INFO - fetch_section_data:170 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 14:45:09 - weekly_report - INFO - execute_metabase_query:90 - 正在执行Metabase查询...
2026-02-24 14:45:09 - weekly_report - INFO - _get_session:58 - 正在连接Metabase获取session...
2026-02-24 14:45:10 - weekly_report - WARNING - _get_session:74 - Metabase登录失败: 401
2026-02-24 14:45:10 - weekly_report - ERROR - execute_metabase_query:108 - Metabase查询失败: HTTP 401
2026-02-24 14:45:10 - weekly_report - ERROR - execute_metabase_query:109 - 响应内容: Unauthenticated
2026-02-24 14:45:10 - weekly_report - INFO - fetch_section_data:170 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 14:45:10 - weekly_report - INFO - execute_metabase_query:90 - 正在执行Metabase查询...
2026-02-24 14:45:10 - weekly_report - ERROR - execute_metabase_query:108 - Metabase查询失败: HTTP 401
2026-02-24 14:45:10 - weekly_report - ERROR - execute_metabase_query:109 - 响应内容: Unauthenticated
2026-02-24 14:45:10 - weekly_report - INFO - fetch_section_data:170 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 14:45:10 - weekly_report - INFO - execute_metabase_query:90 - 正在执行Metabase查询...
2026-02-24 14:45:10 - weekly_report - ERROR - execute_metabase_query:108 - Metabase查询失败: HTTP 401
2026-02-24 14:45:10 - weekly_report - ERROR - execute_metabase_query:109 - 响应内容: Unauthenticated
2026-02-24 14:45:10 - weekly_report - INFO - fetch_section_data:170 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 14:45:10 - weekly_report - INFO - execute_metabase_query:90 - 正在执行Metabase查询...
2026-02-24 14:45:10 - weekly_report - ERROR - execute_metabase_query:108 - Metabase查询失败: HTTP 401
2026-02-24 14:45:10 - weekly_report - ERROR - execute_metabase_query:109 - 响应内容: Unauthenticated
2026-02-24 14:45:10 - weekly_report - INFO - fetch_section_data:170 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 14:45:10 - weekly_report - INFO - execute_metabase_query:90 - 正在执行Metabase查询...
2026-02-24 14:45:10 - weekly_report - ERROR - execute_metabase_query:108 - Metabase查询失败: HTTP 401
2026-02-24 14:45:10 - weekly_report - ERROR - execute_metabase_query:109 - 响应内容: Unauthenticated
2026-02-24 14:45:10 - weekly_report - INFO - fetch_section_data:170 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 14:45:10 - weekly_report - INFO - execute_metabase_query:90 - 正在执行Metabase查询...
2026-02-24 14:45:10 - weekly_report - ERROR - execute_metabase_query:108 - Metabase查询失败: HTTP 401
2026-02-24 14:45:10 - weekly_report - ERROR - execute_metabase_query:109 - 响应内容: Unauthenticated
2026-02-24 14:45:10 - weekly_report - INFO - fetch_all_sections:221 - ✅ 数据获取完成
2026-02-24 14:45:10 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 14:45:10 - weekly_report - WARNING - main:219 - ⚠️  6 个部分无数据
2026-02-24 14:45:10 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 14:45:10 - weekly_report - INFO - fetch_all_sections:204 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 14:45:10 - weekly_report - INFO - fetch_section_data:170 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 14:45:10 - weekly_report - INFO - execute_metabase_query:90 - 正在执行Metabase查询...
2026-02-24 14:45:10 - weekly_report - ERROR - execute_metabase_query:108 - Metabase查询失败: HTTP 401
2026-02-24 14:45:10 - weekly_report - ERROR - execute_metabase_query:109 - 响应内容: Unauthenticated
2026-02-24 14:45:10 - weekly_report - INFO - fetch_section_data:170 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 14:45:10 - weekly_report - INFO - execute_metabase_query:90 - 正在执行Metabase查询...
2026-02-24 14:45:11 - weekly_report - ERROR - execute_metabase_query:108 - Metabase查询失败: HTTP 401
2026-02-24 14:45:11 - weekly_report - ERROR - execute_metabase_query:109 - 响应内容: Unauthenticated
2026-02-24 14:45:11 - weekly_report - INFO - fetch_section_data:170 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 14:45:11 - weekly_report - INFO - execute_metabase_query:90 - 正在执行Metabase查询...
2026-02-24 14:45:11 - weekly_report - ERROR - execute_metabase_query:108 - Metabase查询失败: HTTP 401
2026-02-24 14:45:11 - weekly_report - ERROR - execute_metabase_query:109 - 响应内容: Unauthenticated
2026-02-24 14:45:11 - weekly_report - INFO - fetch_section_data:170 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 14:45:11 - weekly_report - INFO - execute_metabase_query:90 - 正在执行Metabase查询...
2026-02-24 14:45:11 - weekly_report - ERROR - execute_metabase_query:108 - Metabase查询失败: HTTP 401
2026-02-24 14:45:11 - weekly_report - ERROR - execute_metabase_query:109 - 响应内容: Unauthenticated
2026-02-24 14:45:11 - weekly_report - INFO - fetch_section_data:170 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 14:45:11 - weekly_report - INFO - execute_metabase_query:90 - 正在执行Metabase查询...
2026-02-24 14:45:11 - weekly_report - ERROR - execute_metabase_query:108 - Metabase查询失败: HTTP 401
2026-02-24 14:45:11 - weekly_report - ERROR - execute_metabase_query:109 - 响应内容: Unauthenticated
2026-02-24 14:45:11 - weekly_report - INFO - fetch_section_data:170 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 14:45:11 - weekly_report - INFO - execute_metabase_query:90 - 正在执行Metabase查询...
2026-02-24 14:45:11 - weekly_report - ERROR - execute_metabase_query:108 - Metabase查询失败: HTTP 401
2026-02-24 14:45:11 - weekly_report - ERROR - execute_metabase_query:109 - 响应内容: Unauthenticated
2026-02-24 14:45:11 - weekly_report - INFO - fetch_all_sections:221 - ✅ 数据获取完成
2026-02-24 14:45:11 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 14:45:11 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 14:45:11 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 14:45:11 - weekly_report - INFO - analyze_all_sections:150 - 开始分析所有部分...
2026-02-24 14:45:11 - weekly_report - INFO - analyze_all_sections:170 - ✅ 所有部分分析完成
2026-02-24 14:45:11 - weekly_report - INFO - main:240 - 
============================================================
2026-02-24 14:45:11 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-24 14:45:11 - weekly_report - INFO - main:242 - ============================================================
2026-02-24 14:45:11 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 14:45:11 - weekly_report - INFO - generate_full_report:591 - 生成完整报告HTML...
2026-02-24 14:45:11 - weekly_report - INFO - generate_full_report:615 - ✅ 完整报告HTML生成完成
2026-02-24 14:45:11 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-24 14:45:11 - weekly_report - INFO - main:258 - 
============================================================
2026-02-24 14:45:11 - weekly_report - INFO - main:259 - 第四阶段：保存报告到文件
2026-02-24 14:45:11 - weekly_report - INFO - main:260 - ============================================================
2026-02-24 14:45:11 - weekly_report - INFO - save_html_to_file:199 - ✅ HTML已保存到: confluence_report_2026-02-28.html
2026-02-24 14:45:11 - weekly_report - INFO - main:267 - 
============================================================
2026-02-24 14:45:11 - weekly_report - INFO - main:268 - ✅ 报告已保存到本地文件！
2026-02-24 14:45:11 - weekly_report - INFO - main:269 - ============================================================
2026-02-24 14:45:11 - weekly_report - INFO - main:270 - 文件路径: output/confluence_report_2026-02-28.html
2026-02-24 14:45:11 - weekly_report - INFO - main:271 - 报告日期: 2026-02-28
2026-02-24 14:46:37 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 14:46:37 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 14:46:37 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 14:46:37 - weekly_report - INFO - main:164 - 目标周: 本周
2026-02-24 14:46:37 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 14:46:37 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 14:46:37 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 14:46:37 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 14:46:37 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 14:46:37 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 14:46:37 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 14:46:37 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 14:46:37 - weekly_report - INFO - fetch_all_sections:214 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 14:46:37 - weekly_report - INFO - fetch_section_data:180 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 14:46:37 - weekly_report - INFO - execute_metabase_query:100 - 正在执行Metabase查询...
2026-02-24 14:46:37 - weekly_report - INFO - _get_session:58 - 正在连接Metabase获取session...
2026-02-24 14:46:37 - weekly_report - WARNING - _get_session:82 - Metabase登录失败 HTTP 401: {"errors":{"password":"did not match stored password"}}
2026-02-24 14:46:37 - weekly_report - ERROR - execute_metabase_query:118 - Metabase查询失败: HTTP 401
2026-02-24 14:46:37 - weekly_report - ERROR - execute_metabase_query:119 - 响应内容: Unauthenticated
2026-02-24 14:46:37 - weekly_report - INFO - fetch_section_data:180 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 14:46:37 - weekly_report - INFO - execute_metabase_query:100 - 正在执行Metabase查询...
2026-02-24 14:46:37 - weekly_report - ERROR - execute_metabase_query:118 - Metabase查询失败: HTTP 401
2026-02-24 14:46:37 - weekly_report - ERROR - execute_metabase_query:119 - 响应内容: Unauthenticated
2026-02-24 14:46:37 - weekly_report - INFO - fetch_section_data:180 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 14:46:37 - weekly_report - INFO - execute_metabase_query:100 - 正在执行Metabase查询...
2026-02-24 14:46:37 - weekly_report - ERROR - execute_metabase_query:118 - Metabase查询失败: HTTP 401
2026-02-24 14:46:37 - weekly_report - ERROR - execute_metabase_query:119 - 响应内容: Unauthenticated
2026-02-24 14:46:37 - weekly_report - INFO - fetch_section_data:180 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 14:46:37 - weekly_report - INFO - execute_metabase_query:100 - 正在执行Metabase查询...
2026-02-24 14:46:37 - weekly_report - ERROR - execute_metabase_query:118 - Metabase查询失败: HTTP 401
2026-02-24 14:46:37 - weekly_report - ERROR - execute_metabase_query:119 - 响应内容: Unauthenticated
2026-02-24 14:46:37 - weekly_report - INFO - fetch_section_data:180 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 14:46:37 - weekly_report - INFO - execute_metabase_query:100 - 正在执行Metabase查询...
2026-02-24 14:46:37 - weekly_report - ERROR - execute_metabase_query:118 - Metabase查询失败: HTTP 401
2026-02-24 14:46:37 - weekly_report - ERROR - execute_metabase_query:119 - 响应内容: Unauthenticated
2026-02-24 14:46:37 - weekly_report - INFO - fetch_section_data:180 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 14:46:37 - weekly_report - INFO - execute_metabase_query:100 - 正在执行Metabase查询...
2026-02-24 14:46:38 - weekly_report - ERROR - execute_metabase_query:118 - Metabase查询失败: HTTP 401
2026-02-24 14:46:38 - weekly_report - ERROR - execute_metabase_query:119 - 响应内容: Unauthenticated
2026-02-24 14:46:38 - weekly_report - INFO - fetch_all_sections:231 - ✅ 数据获取完成
2026-02-24 14:46:38 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 14:46:38 - weekly_report - WARNING - main:219 - ⚠️  6 个部分无数据
2026-02-24 14:46:38 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 14:46:38 - weekly_report - INFO - fetch_all_sections:214 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 14:46:38 - weekly_report - INFO - fetch_section_data:180 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 14:46:38 - weekly_report - INFO - execute_metabase_query:100 - 正在执行Metabase查询...
2026-02-24 14:46:38 - weekly_report - ERROR - execute_metabase_query:118 - Metabase查询失败: HTTP 401
2026-02-24 14:46:38 - weekly_report - ERROR - execute_metabase_query:119 - 响应内容: Unauthenticated
2026-02-24 14:46:38 - weekly_report - INFO - fetch_section_data:180 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 14:46:38 - weekly_report - INFO - execute_metabase_query:100 - 正在执行Metabase查询...
2026-02-24 14:46:38 - weekly_report - ERROR - execute_metabase_query:118 - Metabase查询失败: HTTP 401
2026-02-24 14:46:38 - weekly_report - ERROR - execute_metabase_query:119 - 响应内容: Unauthenticated
2026-02-24 14:46:38 - weekly_report - INFO - fetch_section_data:180 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 14:46:38 - weekly_report - INFO - execute_metabase_query:100 - 正在执行Metabase查询...
2026-02-24 14:46:38 - weekly_report - ERROR - execute_metabase_query:118 - Metabase查询失败: HTTP 401
2026-02-24 14:46:38 - weekly_report - ERROR - execute_metabase_query:119 - 响应内容: Unauthenticated
2026-02-24 14:46:38 - weekly_report - INFO - fetch_section_data:180 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 14:46:38 - weekly_report - INFO - execute_metabase_query:100 - 正在执行Metabase查询...
2026-02-24 14:46:38 - weekly_report - ERROR - execute_metabase_query:118 - Metabase查询失败: HTTP 401
2026-02-24 14:46:38 - weekly_report - ERROR - execute_metabase_query:119 - 响应内容: Unauthenticated
2026-02-24 14:46:38 - weekly_report - INFO - fetch_section_data:180 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 14:46:38 - weekly_report - INFO - execute_metabase_query:100 - 正在执行Metabase查询...
2026-02-24 14:46:38 - weekly_report - ERROR - execute_metabase_query:118 - Metabase查询失败: HTTP 401
2026-02-24 14:46:38 - weekly_report - ERROR - execute_metabase_query:119 - 响应内容: Unauthenticated
2026-02-24 14:46:38 - weekly_report - INFO - fetch_section_data:180 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 14:46:38 - weekly_report - INFO - execute_metabase_query:100 - 正在执行Metabase查询...
2026-02-24 14:46:38 - weekly_report - ERROR - execute_metabase_query:118 - Metabase查询失败: HTTP 401
2026-02-24 14:46:38 - weekly_report - ERROR - execute_metabase_query:119 - 响应内容: Unauthenticated
2026-02-24 14:46:38 - weekly_report - INFO - fetch_all_sections:231 - ✅ 数据获取完成
2026-02-24 14:46:38 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 14:46:38 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 14:46:38 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 14:46:38 - weekly_report - INFO - analyze_all_sections:150 - 开始分析所有部分...
2026-02-24 14:46:38 - weekly_report - INFO - analyze_all_sections:170 - ✅ 所有部分分析完成
2026-02-24 14:46:38 - weekly_report - INFO - main:240 - 
============================================================
2026-02-24 14:46:38 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-24 14:46:38 - weekly_report - INFO - main:242 - ============================================================
2026-02-24 14:46:38 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 14:46:38 - weekly_report - INFO - generate_full_report:591 - 生成完整报告HTML...
2026-02-24 14:46:38 - weekly_report - INFO - generate_full_report:615 - ✅ 完整报告HTML生成完成
2026-02-24 14:46:38 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-24 14:46:38 - weekly_report - INFO - main:258 - 
============================================================
2026-02-24 14:46:38 - weekly_report - INFO - main:259 - 第四阶段：保存报告到文件
2026-02-24 14:46:38 - weekly_report - INFO - main:260 - ============================================================
2026-02-24 14:46:38 - weekly_report - INFO - save_html_to_file:199 - ✅ HTML已保存到: confluence_report_2026-02-28.html
2026-02-24 14:46:38 - weekly_report - INFO - main:267 - 
============================================================
2026-02-24 14:46:38 - weekly_report - INFO - main:268 - ✅ 报告已保存到本地文件！
2026-02-24 14:46:38 - weekly_report - INFO - main:269 - ============================================================
2026-02-24 14:46:38 - weekly_report - INFO - main:270 - 文件路径: output/confluence_report_2026-02-28.html
2026-02-24 14:46:38 - weekly_report - INFO - main:271 - 报告日期: 2026-02-28
2026-02-24 14:51:26 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 14:51:26 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 14:51:26 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 14:51:26 - weekly_report - INFO - main:164 - 目标周: 本周
2026-02-24 14:51:26 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 14:51:26 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 14:51:26 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 14:51:26 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 14:51:26 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 14:51:26 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 14:51:26 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 14:51:26 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 14:51:26 - weekly_report - INFO - fetch_all_sections:214 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 14:51:26 - weekly_report - INFO - fetch_section_data:180 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 14:51:26 - weekly_report - INFO - execute_metabase_query:100 - 正在执行Metabase查询...
2026-02-24 14:51:26 - weekly_report - INFO - _get_session:86 - 未配置用户名密码，将使用无认证方式
2026-02-24 14:51:27 - weekly_report - ERROR - execute_metabase_query:118 - Metabase查询失败: HTTP 401
2026-02-24 14:51:27 - weekly_report - ERROR - execute_metabase_query:119 - 响应内容: Unauthenticated
2026-02-24 14:51:27 - weekly_report - INFO - fetch_section_data:180 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 14:51:27 - weekly_report - INFO - execute_metabase_query:100 - 正在执行Metabase查询...
2026-02-24 14:51:27 - weekly_report - ERROR - execute_metabase_query:118 - Metabase查询失败: HTTP 401
2026-02-24 14:51:27 - weekly_report - ERROR - execute_metabase_query:119 - 响应内容: Unauthenticated
2026-02-24 14:51:27 - weekly_report - INFO - fetch_section_data:180 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 14:51:27 - weekly_report - INFO - execute_metabase_query:100 - 正在执行Metabase查询...
2026-02-24 14:51:27 - weekly_report - ERROR - execute_metabase_query:118 - Metabase查询失败: HTTP 401
2026-02-24 14:51:27 - weekly_report - ERROR - execute_metabase_query:119 - 响应内容: Unauthenticated
2026-02-24 14:51:27 - weekly_report - INFO - fetch_section_data:180 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 14:51:27 - weekly_report - INFO - execute_metabase_query:100 - 正在执行Metabase查询...
2026-02-24 14:51:27 - weekly_report - ERROR - execute_metabase_query:118 - Metabase查询失败: HTTP 401
2026-02-24 14:51:27 - weekly_report - ERROR - execute_metabase_query:119 - 响应内容: Unauthenticated
2026-02-24 14:51:27 - weekly_report - INFO - fetch_section_data:180 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 14:51:27 - weekly_report - INFO - execute_metabase_query:100 - 正在执行Metabase查询...
2026-02-24 14:51:27 - weekly_report - ERROR - execute_metabase_query:118 - Metabase查询失败: HTTP 401
2026-02-24 14:51:27 - weekly_report - ERROR - execute_metabase_query:119 - 响应内容: Unauthenticated
2026-02-24 14:51:27 - weekly_report - INFO - fetch_section_data:180 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 14:51:27 - weekly_report - INFO - execute_metabase_query:100 - 正在执行Metabase查询...
2026-02-24 14:51:27 - weekly_report - ERROR - execute_metabase_query:118 - Metabase查询失败: HTTP 401
2026-02-24 14:51:27 - weekly_report - ERROR - execute_metabase_query:119 - 响应内容: Unauthenticated
2026-02-24 14:51:27 - weekly_report - INFO - fetch_all_sections:231 - ✅ 数据获取完成
2026-02-24 14:51:27 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 14:51:27 - weekly_report - WARNING - main:219 - ⚠️  6 个部分无数据
2026-02-24 14:51:27 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 14:51:27 - weekly_report - INFO - fetch_all_sections:214 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 14:51:27 - weekly_report - INFO - fetch_section_data:180 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 14:51:27 - weekly_report - INFO - execute_metabase_query:100 - 正在执行Metabase查询...
2026-02-24 14:51:27 - weekly_report - ERROR - execute_metabase_query:118 - Metabase查询失败: HTTP 401
2026-02-24 14:51:27 - weekly_report - ERROR - execute_metabase_query:119 - 响应内容: Unauthenticated
2026-02-24 14:51:27 - weekly_report - INFO - fetch_section_data:180 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 14:51:27 - weekly_report - INFO - execute_metabase_query:100 - 正在执行Metabase查询...
2026-02-24 14:51:27 - weekly_report - ERROR - execute_metabase_query:118 - Metabase查询失败: HTTP 401
2026-02-24 14:51:27 - weekly_report - ERROR - execute_metabase_query:119 - 响应内容: Unauthenticated
2026-02-24 14:51:27 - weekly_report - INFO - fetch_section_data:180 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 14:51:27 - weekly_report - INFO - execute_metabase_query:100 - 正在执行Metabase查询...
2026-02-24 14:51:27 - weekly_report - ERROR - execute_metabase_query:118 - Metabase查询失败: HTTP 401
2026-02-24 14:51:27 - weekly_report - ERROR - execute_metabase_query:119 - 响应内容: Unauthenticated
2026-02-24 14:51:27 - weekly_report - INFO - fetch_section_data:180 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 14:51:27 - weekly_report - INFO - execute_metabase_query:100 - 正在执行Metabase查询...
2026-02-24 14:51:27 - weekly_report - ERROR - execute_metabase_query:118 - Metabase查询失败: HTTP 401
2026-02-24 14:51:27 - weekly_report - ERROR - execute_metabase_query:119 - 响应内容: Unauthenticated
2026-02-24 14:51:27 - weekly_report - INFO - fetch_section_data:180 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 14:51:27 - weekly_report - INFO - execute_metabase_query:100 - 正在执行Metabase查询...
2026-02-24 14:51:27 - weekly_report - ERROR - execute_metabase_query:118 - Metabase查询失败: HTTP 401
2026-02-24 14:51:27 - weekly_report - ERROR - execute_metabase_query:119 - 响应内容: Unauthenticated
2026-02-24 14:51:27 - weekly_report - INFO - fetch_section_data:180 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 14:51:27 - weekly_report - INFO - execute_metabase_query:100 - 正在执行Metabase查询...
2026-02-24 14:51:27 - weekly_report - ERROR - execute_metabase_query:118 - Metabase查询失败: HTTP 401
2026-02-24 14:51:27 - weekly_report - ERROR - execute_metabase_query:119 - 响应内容: Unauthenticated
2026-02-24 14:51:27 - weekly_report - INFO - fetch_all_sections:231 - ✅ 数据获取完成
2026-02-24 14:51:27 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 14:51:27 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 14:51:27 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 14:51:27 - weekly_report - INFO - analyze_all_sections:150 - 开始分析所有部分...
2026-02-24 14:51:27 - weekly_report - INFO - analyze_all_sections:170 - ✅ 所有部分分析完成
2026-02-24 14:51:27 - weekly_report - INFO - main:240 - 
============================================================
2026-02-24 14:51:27 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-24 14:51:27 - weekly_report - INFO - main:242 - ============================================================
2026-02-24 14:51:27 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 14:51:27 - weekly_report - INFO - generate_full_report:591 - 生成完整报告HTML...
2026-02-24 14:51:27 - weekly_report - INFO - generate_full_report:615 - ✅ 完整报告HTML生成完成
2026-02-24 14:51:27 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-24 14:51:27 - weekly_report - INFO - main:258 - 
============================================================
2026-02-24 14:51:27 - weekly_report - INFO - main:259 - 第四阶段：保存报告到文件
2026-02-24 14:51:27 - weekly_report - INFO - main:260 - ============================================================
2026-02-24 14:51:27 - weekly_report - INFO - save_html_to_file:199 - ✅ HTML已保存到: confluence_report_2026-02-28.html
2026-02-24 14:51:27 - weekly_report - INFO - main:267 - 
============================================================
2026-02-24 14:51:27 - weekly_report - INFO - main:268 - ✅ 报告已保存到本地文件！
2026-02-24 14:51:27 - weekly_report - INFO - main:269 - ============================================================
2026-02-24 14:51:27 - weekly_report - INFO - main:270 - 文件路径: output/confluence_report_2026-02-28.html
2026-02-24 14:51:27 - weekly_report - INFO - main:271 - 报告日期: 2026-02-28
2026-02-24 14:52:08 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 14:52:08 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 14:52:08 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 14:52:08 - weekly_report - INFO - main:164 - 目标周: 本周
2026-02-24 14:52:08 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 14:52:08 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 14:52:08 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 14:52:08 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 14:52:08 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 14:52:08 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 14:52:08 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 14:52:08 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 14:52:08 - weekly_report - INFO - fetch_all_sections:226 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 14:52:08 - weekly_report - INFO - fetch_section_data:192 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 14:52:08 - weekly_report - INFO - execute_metabase_query:112 - 正在执行Metabase查询...
2026-02-24 14:52:08 - weekly_report - ERROR - execute_metabase_query:165 - ❌ 查询执行异常: 'DataFetcher' object has no attribute 'api_token'
2026-02-24 14:52:08 - weekly_report - INFO - fetch_section_data:192 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 14:52:08 - weekly_report - INFO - execute_metabase_query:112 - 正在执行Metabase查询...
2026-02-24 14:52:09 - weekly_report - ERROR - execute_metabase_query:130 - Metabase查询失败: HTTP 401
2026-02-24 14:52:09 - weekly_report - ERROR - execute_metabase_query:131 - 响应内容: Unauthenticated
2026-02-24 14:52:09 - weekly_report - INFO - fetch_section_data:192 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 14:52:09 - weekly_report - INFO - execute_metabase_query:112 - 正在执行Metabase查询...
2026-02-24 14:52:09 - weekly_report - ERROR - execute_metabase_query:130 - Metabase查询失败: HTTP 401
2026-02-24 14:52:09 - weekly_report - ERROR - execute_metabase_query:131 - 响应内容: Unauthenticated
2026-02-24 14:52:09 - weekly_report - INFO - fetch_section_data:192 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 14:52:09 - weekly_report - INFO - execute_metabase_query:112 - 正在执行Metabase查询...
2026-02-24 14:52:09 - weekly_report - ERROR - execute_metabase_query:130 - Metabase查询失败: HTTP 401
2026-02-24 14:52:09 - weekly_report - ERROR - execute_metabase_query:131 - 响应内容: Unauthenticated
2026-02-24 14:52:09 - weekly_report - INFO - fetch_section_data:192 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 14:52:09 - weekly_report - INFO - execute_metabase_query:112 - 正在执行Metabase查询...
2026-02-24 14:52:09 - weekly_report - ERROR - execute_metabase_query:130 - Metabase查询失败: HTTP 401
2026-02-24 14:52:09 - weekly_report - ERROR - execute_metabase_query:131 - 响应内容: Unauthenticated
2026-02-24 14:52:09 - weekly_report - INFO - fetch_section_data:192 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 14:52:09 - weekly_report - INFO - execute_metabase_query:112 - 正在执行Metabase查询...
2026-02-24 14:52:09 - weekly_report - ERROR - execute_metabase_query:130 - Metabase查询失败: HTTP 401
2026-02-24 14:52:09 - weekly_report - ERROR - execute_metabase_query:131 - 响应内容: Unauthenticated
2026-02-24 14:52:09 - weekly_report - INFO - fetch_all_sections:243 - ✅ 数据获取完成
2026-02-24 14:52:09 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 14:52:09 - weekly_report - WARNING - main:219 - ⚠️  6 个部分无数据
2026-02-24 14:52:09 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 14:52:09 - weekly_report - INFO - fetch_all_sections:226 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 14:52:09 - weekly_report - INFO - fetch_section_data:192 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 14:52:09 - weekly_report - INFO - execute_metabase_query:112 - 正在执行Metabase查询...
2026-02-24 14:52:09 - weekly_report - ERROR - execute_metabase_query:130 - Metabase查询失败: HTTP 401
2026-02-24 14:52:09 - weekly_report - ERROR - execute_metabase_query:131 - 响应内容: Unauthenticated
2026-02-24 14:52:09 - weekly_report - INFO - fetch_section_data:192 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 14:52:09 - weekly_report - INFO - execute_metabase_query:112 - 正在执行Metabase查询...
2026-02-24 14:52:09 - weekly_report - ERROR - execute_metabase_query:130 - Metabase查询失败: HTTP 401
2026-02-24 14:52:09 - weekly_report - ERROR - execute_metabase_query:131 - 响应内容: Unauthenticated
2026-02-24 14:52:09 - weekly_report - INFO - fetch_section_data:192 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 14:52:09 - weekly_report - INFO - execute_metabase_query:112 - 正在执行Metabase查询...
2026-02-24 14:52:12 - weekly_report - ERROR - execute_metabase_query:130 - Metabase查询失败: HTTP 401
2026-02-24 14:52:12 - weekly_report - ERROR - execute_metabase_query:131 - 响应内容: Unauthenticated
2026-02-24 14:52:12 - weekly_report - INFO - fetch_section_data:192 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 14:52:12 - weekly_report - INFO - execute_metabase_query:112 - 正在执行Metabase查询...
2026-02-24 14:52:12 - weekly_report - ERROR - execute_metabase_query:130 - Metabase查询失败: HTTP 401
2026-02-24 14:52:12 - weekly_report - ERROR - execute_metabase_query:131 - 响应内容: Unauthenticated
2026-02-24 14:52:12 - weekly_report - INFO - fetch_section_data:192 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 14:52:12 - weekly_report - INFO - execute_metabase_query:112 - 正在执行Metabase查询...
2026-02-24 14:52:13 - weekly_report - ERROR - execute_metabase_query:130 - Metabase查询失败: HTTP 401
2026-02-24 14:52:13 - weekly_report - ERROR - execute_metabase_query:131 - 响应内容: Unauthenticated
2026-02-24 14:52:13 - weekly_report - INFO - fetch_section_data:192 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 14:52:13 - weekly_report - INFO - execute_metabase_query:112 - 正在执行Metabase查询...
2026-02-24 14:52:13 - weekly_report - ERROR - execute_metabase_query:130 - Metabase查询失败: HTTP 401
2026-02-24 14:52:13 - weekly_report - ERROR - execute_metabase_query:131 - 响应内容: Unauthenticated
2026-02-24 14:52:13 - weekly_report - INFO - fetch_all_sections:243 - ✅ 数据获取完成
2026-02-24 14:52:13 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 14:52:13 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 14:52:13 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 14:52:13 - weekly_report - INFO - analyze_all_sections:150 - 开始分析所有部分...
2026-02-24 14:52:13 - weekly_report - INFO - analyze_all_sections:170 - ✅ 所有部分分析完成
2026-02-24 14:52:13 - weekly_report - INFO - main:240 - 
============================================================
2026-02-24 14:52:13 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-24 14:52:13 - weekly_report - INFO - main:242 - ============================================================
2026-02-24 14:52:13 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 14:52:13 - weekly_report - INFO - generate_full_report:591 - 生成完整报告HTML...
2026-02-24 14:52:13 - weekly_report - INFO - generate_full_report:615 - ✅ 完整报告HTML生成完成
2026-02-24 14:52:13 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-24 14:52:13 - weekly_report - INFO - main:258 - 
============================================================
2026-02-24 14:52:13 - weekly_report - INFO - main:259 - 第四阶段：保存报告到文件
2026-02-24 14:52:13 - weekly_report - INFO - main:260 - ============================================================
2026-02-24 14:52:13 - weekly_report - INFO - save_html_to_file:199 - ✅ HTML已保存到: confluence_report_2026-02-28.html
2026-02-24 14:52:13 - weekly_report - INFO - main:267 - 
============================================================
2026-02-24 14:52:13 - weekly_report - INFO - main:268 - ✅ 报告已保存到本地文件！
2026-02-24 14:52:13 - weekly_report - INFO - main:269 - ============================================================
2026-02-24 14:52:13 - weekly_report - INFO - main:270 - 文件路径: output/confluence_report_2026-02-28.html
2026-02-24 14:52:13 - weekly_report - INFO - main:271 - 报告日期: 2026-02-28
2026-02-24 14:52:50 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 14:52:50 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 14:52:50 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 14:52:50 - weekly_report - INFO - main:164 - 目标周: 本周
2026-02-24 14:52:50 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 14:52:50 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 14:52:50 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 14:52:50 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 14:52:50 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 14:52:50 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 14:52:50 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 14:52:50 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 14:52:50 - weekly_report - INFO - fetch_all_sections:227 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 14:52:50 - weekly_report - INFO - fetch_section_data:193 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 14:52:50 - weekly_report - INFO - execute_metabase_query:113 - 正在执行Metabase查询...
2026-02-24 14:52:50 - weekly_report - INFO - _get_session:65 - 使用API Token认证...
2026-02-24 14:52:50 - weekly_report - INFO - _get_session:70 - ✅ Metabase API Token配置成功
2026-02-24 14:52:50 - weekly_report - ERROR - execute_metabase_query:131 - Metabase查询失败: HTTP 401
2026-02-24 14:52:50 - weekly_report - ERROR - execute_metabase_query:132 - 响应内容: Unauthenticated
2026-02-24 14:52:50 - weekly_report - INFO - fetch_section_data:193 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 14:52:50 - weekly_report - INFO - execute_metabase_query:113 - 正在执行Metabase查询...
2026-02-24 14:52:50 - weekly_report - ERROR - execute_metabase_query:131 - Metabase查询失败: HTTP 401
2026-02-24 14:52:50 - weekly_report - ERROR - execute_metabase_query:132 - 响应内容: Unauthenticated
2026-02-24 14:52:50 - weekly_report - INFO - fetch_section_data:193 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 14:52:50 - weekly_report - INFO - execute_metabase_query:113 - 正在执行Metabase查询...
2026-02-24 14:52:50 - weekly_report - ERROR - execute_metabase_query:131 - Metabase查询失败: HTTP 401
2026-02-24 14:52:50 - weekly_report - ERROR - execute_metabase_query:132 - 响应内容: Unauthenticated
2026-02-24 14:52:50 - weekly_report - INFO - fetch_section_data:193 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 14:52:50 - weekly_report - INFO - execute_metabase_query:113 - 正在执行Metabase查询...
2026-02-24 14:52:50 - weekly_report - ERROR - execute_metabase_query:131 - Metabase查询失败: HTTP 401
2026-02-24 14:52:50 - weekly_report - ERROR - execute_metabase_query:132 - 响应内容: Unauthenticated
2026-02-24 14:52:50 - weekly_report - INFO - fetch_section_data:193 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 14:52:50 - weekly_report - INFO - execute_metabase_query:113 - 正在执行Metabase查询...
2026-02-24 14:52:50 - weekly_report - ERROR - execute_metabase_query:131 - Metabase查询失败: HTTP 401
2026-02-24 14:52:50 - weekly_report - ERROR - execute_metabase_query:132 - 响应内容: Unauthenticated
2026-02-24 14:52:50 - weekly_report - INFO - fetch_section_data:193 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 14:52:50 - weekly_report - INFO - execute_metabase_query:113 - 正在执行Metabase查询...
2026-02-24 14:52:50 - weekly_report - ERROR - execute_metabase_query:131 - Metabase查询失败: HTTP 401
2026-02-24 14:52:50 - weekly_report - ERROR - execute_metabase_query:132 - 响应内容: Unauthenticated
2026-02-24 14:52:50 - weekly_report - INFO - fetch_all_sections:244 - ✅ 数据获取完成
2026-02-24 14:52:50 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 14:52:50 - weekly_report - WARNING - main:219 - ⚠️  6 个部分无数据
2026-02-24 14:52:50 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 14:52:50 - weekly_report - INFO - fetch_all_sections:227 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 14:52:50 - weekly_report - INFO - fetch_section_data:193 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 14:52:50 - weekly_report - INFO - execute_metabase_query:113 - 正在执行Metabase查询...
2026-02-24 14:52:50 - weekly_report - ERROR - execute_metabase_query:131 - Metabase查询失败: HTTP 401
2026-02-24 14:52:50 - weekly_report - ERROR - execute_metabase_query:132 - 响应内容: Unauthenticated
2026-02-24 14:52:50 - weekly_report - INFO - fetch_section_data:193 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 14:52:50 - weekly_report - INFO - execute_metabase_query:113 - 正在执行Metabase查询...
2026-02-24 14:52:50 - weekly_report - ERROR - execute_metabase_query:131 - Metabase查询失败: HTTP 401
2026-02-24 14:52:50 - weekly_report - ERROR - execute_metabase_query:132 - 响应内容: Unauthenticated
2026-02-24 14:52:50 - weekly_report - INFO - fetch_section_data:193 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 14:52:50 - weekly_report - INFO - execute_metabase_query:113 - 正在执行Metabase查询...
2026-02-24 14:52:50 - weekly_report - ERROR - execute_metabase_query:131 - Metabase查询失败: HTTP 401
2026-02-24 14:52:50 - weekly_report - ERROR - execute_metabase_query:132 - 响应内容: Unauthenticated
2026-02-24 14:52:50 - weekly_report - INFO - fetch_section_data:193 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 14:52:50 - weekly_report - INFO - execute_metabase_query:113 - 正在执行Metabase查询...
2026-02-24 14:52:51 - weekly_report - ERROR - execute_metabase_query:131 - Metabase查询失败: HTTP 401
2026-02-24 14:52:51 - weekly_report - ERROR - execute_metabase_query:132 - 响应内容: Unauthenticated
2026-02-24 14:52:51 - weekly_report - INFO - fetch_section_data:193 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 14:52:51 - weekly_report - INFO - execute_metabase_query:113 - 正在执行Metabase查询...
2026-02-24 14:52:51 - weekly_report - ERROR - execute_metabase_query:131 - Metabase查询失败: HTTP 401
2026-02-24 14:52:51 - weekly_report - ERROR - execute_metabase_query:132 - 响应内容: Unauthenticated
2026-02-24 14:52:51 - weekly_report - INFO - fetch_section_data:193 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 14:52:51 - weekly_report - INFO - execute_metabase_query:113 - 正在执行Metabase查询...
2026-02-24 14:52:51 - weekly_report - ERROR - execute_metabase_query:131 - Metabase查询失败: HTTP 401
2026-02-24 14:52:51 - weekly_report - ERROR - execute_metabase_query:132 - 响应内容: Unauthenticated
2026-02-24 14:52:51 - weekly_report - INFO - fetch_all_sections:244 - ✅ 数据获取完成
2026-02-24 14:52:51 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 14:52:51 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 14:52:51 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 14:52:51 - weekly_report - INFO - analyze_all_sections:150 - 开始分析所有部分...
2026-02-24 14:52:51 - weekly_report - INFO - analyze_all_sections:170 - ✅ 所有部分分析完成
2026-02-24 14:52:51 - weekly_report - INFO - main:240 - 
============================================================
2026-02-24 14:52:51 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-24 14:52:51 - weekly_report - INFO - main:242 - ============================================================
2026-02-24 14:52:51 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 14:52:51 - weekly_report - INFO - generate_full_report:591 - 生成完整报告HTML...
2026-02-24 14:52:51 - weekly_report - INFO - generate_full_report:615 - ✅ 完整报告HTML生成完成
2026-02-24 14:52:51 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-24 14:52:51 - weekly_report - INFO - main:258 - 
============================================================
2026-02-24 14:52:51 - weekly_report - INFO - main:259 - 第四阶段：保存报告到文件
2026-02-24 14:52:51 - weekly_report - INFO - main:260 - ============================================================
2026-02-24 14:52:51 - weekly_report - INFO - save_html_to_file:199 - ✅ HTML已保存到: confluence_report_2026-02-28.html
2026-02-24 14:52:51 - weekly_report - INFO - main:267 - 
============================================================
2026-02-24 14:52:51 - weekly_report - INFO - main:268 - ✅ 报告已保存到本地文件！
2026-02-24 14:52:51 - weekly_report - INFO - main:269 - ============================================================
2026-02-24 14:52:51 - weekly_report - INFO - main:270 - 文件路径: output/confluence_report_2026-02-28.html
2026-02-24 14:52:51 - weekly_report - INFO - main:271 - 报告日期: 2026-02-28
2026-02-24 14:53:06 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 14:53:06 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 14:53:06 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 14:53:06 - weekly_report - INFO - main:164 - 目标周: 本周
2026-02-24 14:53:06 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 14:53:06 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 14:53:06 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 14:53:06 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 14:53:06 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 14:53:06 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 14:53:06 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 14:53:06 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 14:53:06 - weekly_report - INFO - fetch_all_sections:228 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 14:53:06 - weekly_report - INFO - fetch_section_data:194 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 14:53:06 - weekly_report - INFO - execute_metabase_query:114 - 正在执行Metabase查询...
2026-02-24 14:53:06 - weekly_report - INFO - _get_session:65 - 使用API Token认证...
2026-02-24 14:53:06 - weekly_report - INFO - _get_session:71 - ✅ Metabase API Token配置成功
2026-02-24 14:53:07 - weekly_report - ERROR - execute_metabase_query:132 - Metabase查询失败: HTTP 401
2026-02-24 14:53:07 - weekly_report - ERROR - execute_metabase_query:133 - 响应内容: Unauthenticated
2026-02-24 14:53:07 - weekly_report - INFO - fetch_section_data:194 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 14:53:07 - weekly_report - INFO - execute_metabase_query:114 - 正在执行Metabase查询...
2026-02-24 14:53:07 - weekly_report - ERROR - execute_metabase_query:132 - Metabase查询失败: HTTP 401
2026-02-24 14:53:07 - weekly_report - ERROR - execute_metabase_query:133 - 响应内容: Unauthenticated
2026-02-24 14:53:07 - weekly_report - INFO - fetch_section_data:194 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 14:53:07 - weekly_report - INFO - execute_metabase_query:114 - 正在执行Metabase查询...
2026-02-24 14:53:07 - weekly_report - ERROR - execute_metabase_query:132 - Metabase查询失败: HTTP 401
2026-02-24 14:53:07 - weekly_report - ERROR - execute_metabase_query:133 - 响应内容: Unauthenticated
2026-02-24 14:53:07 - weekly_report - INFO - fetch_section_data:194 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 14:53:07 - weekly_report - INFO - execute_metabase_query:114 - 正在执行Metabase查询...
2026-02-24 14:53:07 - weekly_report - ERROR - execute_metabase_query:132 - Metabase查询失败: HTTP 401
2026-02-24 14:53:07 - weekly_report - ERROR - execute_metabase_query:133 - 响应内容: Unauthenticated
2026-02-24 14:53:07 - weekly_report - INFO - fetch_section_data:194 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 14:53:07 - weekly_report - INFO - execute_metabase_query:114 - 正在执行Metabase查询...
2026-02-24 14:53:07 - weekly_report - ERROR - execute_metabase_query:132 - Metabase查询失败: HTTP 401
2026-02-24 14:53:07 - weekly_report - ERROR - execute_metabase_query:133 - 响应内容: Unauthenticated
2026-02-24 14:53:07 - weekly_report - INFO - fetch_section_data:194 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 14:53:07 - weekly_report - INFO - execute_metabase_query:114 - 正在执行Metabase查询...
2026-02-24 14:53:07 - weekly_report - ERROR - execute_metabase_query:132 - Metabase查询失败: HTTP 401
2026-02-24 14:53:07 - weekly_report - ERROR - execute_metabase_query:133 - 响应内容: Unauthenticated
2026-02-24 14:53:07 - weekly_report - INFO - fetch_all_sections:245 - ✅ 数据获取完成
2026-02-24 14:53:07 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 14:53:07 - weekly_report - WARNING - main:219 - ⚠️  6 个部分无数据
2026-02-24 14:53:07 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 14:53:07 - weekly_report - INFO - fetch_all_sections:228 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 14:53:07 - weekly_report - INFO - fetch_section_data:194 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 14:53:07 - weekly_report - INFO - execute_metabase_query:114 - 正在执行Metabase查询...
2026-02-24 14:53:07 - weekly_report - ERROR - execute_metabase_query:132 - Metabase查询失败: HTTP 401
2026-02-24 14:53:07 - weekly_report - ERROR - execute_metabase_query:133 - 响应内容: Unauthenticated
2026-02-24 14:53:07 - weekly_report - INFO - fetch_section_data:194 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 14:53:07 - weekly_report - INFO - execute_metabase_query:114 - 正在执行Metabase查询...
2026-02-24 14:53:07 - weekly_report - ERROR - execute_metabase_query:132 - Metabase查询失败: HTTP 401
2026-02-24 14:53:07 - weekly_report - ERROR - execute_metabase_query:133 - 响应内容: Unauthenticated
2026-02-24 14:53:07 - weekly_report - INFO - fetch_section_data:194 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 14:53:07 - weekly_report - INFO - execute_metabase_query:114 - 正在执行Metabase查询...
2026-02-24 14:53:07 - weekly_report - ERROR - execute_metabase_query:132 - Metabase查询失败: HTTP 401
2026-02-24 14:53:07 - weekly_report - ERROR - execute_metabase_query:133 - 响应内容: Unauthenticated
2026-02-24 14:53:07 - weekly_report - INFO - fetch_section_data:194 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 14:53:07 - weekly_report - INFO - execute_metabase_query:114 - 正在执行Metabase查询...
2026-02-24 14:53:07 - weekly_report - ERROR - execute_metabase_query:132 - Metabase查询失败: HTTP 401
2026-02-24 14:53:07 - weekly_report - ERROR - execute_metabase_query:133 - 响应内容: Unauthenticated
2026-02-24 14:53:07 - weekly_report - INFO - fetch_section_data:194 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 14:53:07 - weekly_report - INFO - execute_metabase_query:114 - 正在执行Metabase查询...
2026-02-24 14:53:07 - weekly_report - ERROR - execute_metabase_query:132 - Metabase查询失败: HTTP 401
2026-02-24 14:53:07 - weekly_report - ERROR - execute_metabase_query:133 - 响应内容: Unauthenticated
2026-02-24 14:53:07 - weekly_report - INFO - fetch_section_data:194 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 14:53:07 - weekly_report - INFO - execute_metabase_query:114 - 正在执行Metabase查询...
2026-02-24 14:53:07 - weekly_report - ERROR - execute_metabase_query:132 - Metabase查询失败: HTTP 401
2026-02-24 14:53:07 - weekly_report - ERROR - execute_metabase_query:133 - 响应内容: Unauthenticated
2026-02-24 14:53:07 - weekly_report - INFO - fetch_all_sections:245 - ✅ 数据获取完成
2026-02-24 14:53:07 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 14:53:07 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 14:53:07 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 14:53:07 - weekly_report - INFO - analyze_all_sections:150 - 开始分析所有部分...
2026-02-24 14:53:07 - weekly_report - INFO - analyze_all_sections:170 - ✅ 所有部分分析完成
2026-02-24 14:53:07 - weekly_report - INFO - main:240 - 
============================================================
2026-02-24 14:53:07 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-24 14:53:07 - weekly_report - INFO - main:242 - ============================================================
2026-02-24 14:53:07 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 14:53:07 - weekly_report - INFO - generate_full_report:591 - 生成完整报告HTML...
2026-02-24 14:53:07 - weekly_report - INFO - generate_full_report:615 - ✅ 完整报告HTML生成完成
2026-02-24 14:53:07 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-24 14:53:07 - weekly_report - INFO - main:258 - 
============================================================
2026-02-24 14:53:07 - weekly_report - INFO - main:259 - 第四阶段：保存报告到文件
2026-02-24 14:53:07 - weekly_report - INFO - main:260 - ============================================================
2026-02-24 14:53:07 - weekly_report - INFO - save_html_to_file:199 - ✅ HTML已保存到: confluence_report_2026-02-28.html
2026-02-24 14:53:07 - weekly_report - INFO - main:267 - 
============================================================
2026-02-24 14:53:07 - weekly_report - INFO - main:268 - ✅ 报告已保存到本地文件！
2026-02-24 14:53:07 - weekly_report - INFO - main:269 - ============================================================
2026-02-24 14:53:07 - weekly_report - INFO - main:270 - 文件路径: output/confluence_report_2026-02-28.html
2026-02-24 14:53:07 - weekly_report - INFO - main:271 - 报告日期: 2026-02-28
2026-02-24 14:53:55 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 14:53:55 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 14:53:55 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 14:53:55 - weekly_report - INFO - main:164 - 目标周: 本周
2026-02-24 14:53:55 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 14:53:55 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 14:53:55 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 14:53:55 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 14:53:55 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 14:53:55 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 14:53:55 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 14:53:55 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 14:53:55 - weekly_report - INFO - fetch_all_sections:218 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 14:53:55 - weekly_report - INFO - fetch_section_data:184 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 14:53:55 - weekly_report - INFO - execute_metabase_query:114 - 正在执行Metabase查询...
2026-02-24 14:53:55 - weekly_report - INFO - _get_session:65 - 使用API Token认证...
2026-02-24 14:53:55 - weekly_report - INFO - _get_session:71 - ✅ Metabase API Token配置成功
2026-02-24 14:53:55 - weekly_report - INFO - fetch_section_data:184 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 14:53:55 - weekly_report - INFO - execute_metabase_query:114 - 正在执行Metabase查询...
2026-02-24 14:53:55 - weekly_report - INFO - fetch_section_data:184 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 14:53:55 - weekly_report - INFO - execute_metabase_query:114 - 正在执行Metabase查询...
2026-02-24 14:53:55 - weekly_report - INFO - fetch_section_data:184 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 14:53:55 - weekly_report - INFO - execute_metabase_query:114 - 正在执行Metabase查询...
2026-02-24 14:53:55 - weekly_report - INFO - fetch_section_data:184 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 14:53:55 - weekly_report - INFO - execute_metabase_query:114 - 正在执行Metabase查询...
2026-02-24 14:53:55 - weekly_report - INFO - fetch_section_data:184 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 14:53:55 - weekly_report - INFO - execute_metabase_query:114 - 正在执行Metabase查询...
2026-02-24 14:53:56 - weekly_report - INFO - fetch_all_sections:235 - ✅ 数据获取完成
2026-02-24 14:53:56 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 14:53:56 - weekly_report - WARNING - main:219 - ⚠️  6 个部分无数据
2026-02-24 14:53:56 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 14:53:56 - weekly_report - INFO - fetch_all_sections:218 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 14:53:56 - weekly_report - INFO - fetch_section_data:184 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 14:53:56 - weekly_report - INFO - execute_metabase_query:114 - 正在执行Metabase查询...
2026-02-24 14:53:56 - weekly_report - INFO - fetch_section_data:184 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 14:53:56 - weekly_report - INFO - execute_metabase_query:114 - 正在执行Metabase查询...
2026-02-24 14:53:56 - weekly_report - INFO - fetch_section_data:184 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 14:53:56 - weekly_report - INFO - execute_metabase_query:114 - 正在执行Metabase查询...
2026-02-24 14:53:56 - weekly_report - INFO - fetch_section_data:184 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 14:53:56 - weekly_report - INFO - execute_metabase_query:114 - 正在执行Metabase查询...
2026-02-24 14:53:59 - weekly_report - INFO - fetch_section_data:184 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 14:53:59 - weekly_report - INFO - execute_metabase_query:114 - 正在执行Metabase查询...
2026-02-24 14:53:59 - weekly_report - INFO - fetch_section_data:184 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 14:53:59 - weekly_report - INFO - execute_metabase_query:114 - 正在执行Metabase查询...
2026-02-24 14:53:59 - weekly_report - INFO - fetch_all_sections:235 - ✅ 数据获取完成
2026-02-24 14:53:59 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 14:53:59 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 14:53:59 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 14:53:59 - weekly_report - INFO - analyze_all_sections:150 - 开始分析所有部分...
2026-02-24 14:53:59 - weekly_report - INFO - analyze_all_sections:170 - ✅ 所有部分分析完成
2026-02-24 14:53:59 - weekly_report - INFO - main:240 - 
============================================================
2026-02-24 14:53:59 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-24 14:53:59 - weekly_report - INFO - main:242 - ============================================================
2026-02-24 14:53:59 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 14:53:59 - weekly_report - INFO - generate_full_report:591 - 生成完整报告HTML...
2026-02-24 14:53:59 - weekly_report - INFO - generate_full_report:615 - ✅ 完整报告HTML生成完成
2026-02-24 14:53:59 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-24 14:53:59 - weekly_report - INFO - main:258 - 
============================================================
2026-02-24 14:53:59 - weekly_report - INFO - main:259 - 第四阶段：保存报告到文件
2026-02-24 14:53:59 - weekly_report - INFO - main:260 - ============================================================
2026-02-24 14:53:59 - weekly_report - INFO - save_html_to_file:199 - ✅ HTML已保存到: confluence_report_2026-02-28.html
2026-02-24 14:53:59 - weekly_report - INFO - main:267 - 
============================================================
2026-02-24 14:53:59 - weekly_report - INFO - main:268 - ✅ 报告已保存到本地文件！
2026-02-24 14:53:59 - weekly_report - INFO - main:269 - ============================================================
2026-02-24 14:53:59 - weekly_report - INFO - main:270 - 文件路径: output/confluence_report_2026-02-28.html
2026-02-24 14:53:59 - weekly_report - INFO - main:271 - 报告日期: 2026-02-28
2026-02-24 14:58:23 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 14:58:23 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 14:58:23 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 14:58:23 - weekly_report - INFO - main:164 - 目标周: 本周
2026-02-24 14:58:23 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 14:58:23 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 14:58:23 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 14:58:23 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 14:58:23 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 14:58:23 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 14:58:23 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 14:58:23 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 14:58:23 - weekly_report - INFO - fetch_all_sections:218 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 14:58:23 - weekly_report - INFO - fetch_section_data:184 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 14:58:23 - weekly_report - INFO - execute_metabase_query:114 - 正在执行Metabase查询...
2026-02-24 14:58:23 - weekly_report - INFO - _get_session:65 - 使用API Token认证...
2026-02-24 14:58:23 - weekly_report - INFO - _get_session:71 - ✅ Metabase API Token配置成功
2026-02-24 14:58:25 - weekly_report - ERROR - execute_metabase_query:152 - ❌ 网络请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/database/4/query (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2026-02-24 14:58:25 - weekly_report - INFO - fetch_section_data:184 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 14:58:25 - weekly_report - INFO - execute_metabase_query:114 - 正在执行Metabase查询...
2026-02-24 14:58:25 - weekly_report - ERROR - execute_metabase_query:152 - ❌ 网络请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/database/4/query (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2026-02-24 14:58:25 - weekly_report - INFO - fetch_section_data:184 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 14:58:25 - weekly_report - INFO - execute_metabase_query:114 - 正在执行Metabase查询...
2026-02-24 14:58:26 - weekly_report - ERROR - execute_metabase_query:152 - ❌ 网络请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/database/4/query (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2026-02-24 14:58:26 - weekly_report - INFO - fetch_section_data:184 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 14:58:26 - weekly_report - INFO - execute_metabase_query:114 - 正在执行Metabase查询...
2026-02-24 14:58:26 - weekly_report - ERROR - execute_metabase_query:152 - ❌ 网络请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/database/4/query (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2026-02-24 14:58:26 - weekly_report - INFO - fetch_section_data:184 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 14:58:26 - weekly_report - INFO - execute_metabase_query:114 - 正在执行Metabase查询...
2026-02-24 14:58:27 - weekly_report - ERROR - execute_metabase_query:152 - ❌ 网络请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/database/4/query (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2026-02-24 14:58:27 - weekly_report - INFO - fetch_section_data:184 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 14:58:27 - weekly_report - INFO - execute_metabase_query:114 - 正在执行Metabase查询...
2026-02-24 14:58:28 - weekly_report - ERROR - execute_metabase_query:152 - ❌ 网络请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/database/4/query (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2026-02-24 14:58:28 - weekly_report - INFO - fetch_all_sections:235 - ✅ 数据获取完成
2026-02-24 14:58:28 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 14:58:28 - weekly_report - WARNING - main:219 - ⚠️  6 个部分无数据
2026-02-24 14:58:28 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 14:58:28 - weekly_report - INFO - fetch_all_sections:218 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 14:58:28 - weekly_report - INFO - fetch_section_data:184 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 14:58:28 - weekly_report - INFO - execute_metabase_query:114 - 正在执行Metabase查询...
2026-02-24 14:58:28 - weekly_report - ERROR - execute_metabase_query:152 - ❌ 网络请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/database/4/query (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2026-02-24 14:58:28 - weekly_report - INFO - fetch_section_data:184 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 14:58:28 - weekly_report - INFO - execute_metabase_query:114 - 正在执行Metabase查询...
2026-02-24 14:58:28 - weekly_report - ERROR - execute_metabase_query:152 - ❌ 网络请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/database/4/query (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2026-02-24 14:58:28 - weekly_report - INFO - fetch_section_data:184 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 14:58:28 - weekly_report - INFO - execute_metabase_query:114 - 正在执行Metabase查询...
2026-02-24 14:58:29 - weekly_report - ERROR - execute_metabase_query:152 - ❌ 网络请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/database/4/query (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2026-02-24 14:58:29 - weekly_report - INFO - fetch_section_data:184 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 14:58:29 - weekly_report - INFO - execute_metabase_query:114 - 正在执行Metabase查询...
2026-02-24 14:58:29 - weekly_report - ERROR - execute_metabase_query:152 - ❌ 网络请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/database/4/query (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2026-02-24 14:58:29 - weekly_report - INFO - fetch_section_data:184 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 14:58:29 - weekly_report - INFO - execute_metabase_query:114 - 正在执行Metabase查询...
2026-02-24 14:58:30 - weekly_report - ERROR - execute_metabase_query:152 - ❌ 网络请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/database/4/query (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2026-02-24 14:58:30 - weekly_report - INFO - fetch_section_data:184 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 14:58:30 - weekly_report - INFO - execute_metabase_query:114 - 正在执行Metabase查询...
2026-02-24 14:58:30 - weekly_report - ERROR - execute_metabase_query:152 - ❌ 网络请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/database/4/query (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2026-02-24 14:58:30 - weekly_report - INFO - fetch_all_sections:235 - ✅ 数据获取完成
2026-02-24 14:58:30 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 14:58:30 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 14:58:30 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 14:58:30 - weekly_report - INFO - analyze_all_sections:150 - 开始分析所有部分...
2026-02-24 14:58:30 - weekly_report - INFO - analyze_all_sections:170 - ✅ 所有部分分析完成
2026-02-24 14:58:30 - weekly_report - INFO - main:240 - 
============================================================
2026-02-24 14:58:30 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-24 14:58:30 - weekly_report - INFO - main:242 - ============================================================
2026-02-24 14:58:30 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 14:58:30 - weekly_report - INFO - generate_full_report:591 - 生成完整报告HTML...
2026-02-24 14:58:30 - weekly_report - INFO - generate_full_report:615 - ✅ 完整报告HTML生成完成
2026-02-24 14:58:30 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-24 14:58:30 - weekly_report - INFO - main:258 - 
============================================================
2026-02-24 14:58:30 - weekly_report - INFO - main:259 - 第四阶段：保存报告到文件
2026-02-24 14:58:30 - weekly_report - INFO - main:260 - ============================================================
2026-02-24 14:58:30 - weekly_report - INFO - save_html_to_file:199 - ✅ HTML已保存到: confluence_report_2026-02-28.html
2026-02-24 14:58:30 - weekly_report - INFO - main:267 - 
============================================================
2026-02-24 14:58:30 - weekly_report - INFO - main:268 - ✅ 报告已保存到本地文件！
2026-02-24 14:58:30 - weekly_report - INFO - main:269 - ============================================================
2026-02-24 14:58:30 - weekly_report - INFO - main:270 - 文件路径: output/confluence_report_2026-02-28.html
2026-02-24 14:58:30 - weekly_report - INFO - main:271 - 报告日期: 2026-02-28
2026-02-24 15:07:01 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 15:07:01 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 15:07:01 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 15:07:01 - weekly_report - INFO - main:164 - 目标周: 本周
2026-02-24 15:07:01 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 15:07:01 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 15:07:01 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 15:07:01 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 15:07:01 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 15:07:01 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 15:07:01 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 15:07:01 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 15:07:01 - weekly_report - INFO - fetch_all_sections:230 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 15:07:01 - weekly_report - INFO - fetch_section_data:196 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 15:07:01 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:07:01 - weekly_report - INFO - execute_metabase_query:64 - 使用MCP工具执行查询...
2026-02-24 15:07:01 - weekly_report - WARNING - execute_metabase_query:67 - MCP模式：需要通过主程序运行
2026-02-24 15:07:01 - weekly_report - INFO - fetch_section_data:196 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 15:07:01 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:07:01 - weekly_report - INFO - execute_metabase_query:64 - 使用MCP工具执行查询...
2026-02-24 15:07:01 - weekly_report - WARNING - execute_metabase_query:67 - MCP模式：需要通过主程序运行
2026-02-24 15:07:01 - weekly_report - INFO - fetch_section_data:196 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 15:07:01 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:07:01 - weekly_report - INFO - execute_metabase_query:64 - 使用MCP工具执行查询...
2026-02-24 15:07:01 - weekly_report - WARNING - execute_metabase_query:67 - MCP模式：需要通过主程序运行
2026-02-24 15:07:01 - weekly_report - INFO - fetch_section_data:196 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 15:07:01 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:07:01 - weekly_report - INFO - execute_metabase_query:64 - 使用MCP工具执行查询...
2026-02-24 15:07:01 - weekly_report - WARNING - execute_metabase_query:67 - MCP模式：需要通过主程序运行
2026-02-24 15:07:01 - weekly_report - INFO - fetch_section_data:196 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 15:07:01 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:07:01 - weekly_report - INFO - execute_metabase_query:64 - 使用MCP工具执行查询...
2026-02-24 15:07:01 - weekly_report - WARNING - execute_metabase_query:67 - MCP模式：需要通过主程序运行
2026-02-24 15:07:01 - weekly_report - INFO - fetch_section_data:196 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 15:07:01 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:07:01 - weekly_report - INFO - execute_metabase_query:64 - 使用MCP工具执行查询...
2026-02-24 15:07:01 - weekly_report - WARNING - execute_metabase_query:67 - MCP模式：需要通过主程序运行
2026-02-24 15:07:01 - weekly_report - INFO - fetch_all_sections:247 - ✅ 数据获取完成
2026-02-24 15:07:01 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 15:07:01 - weekly_report - WARNING - main:219 - ⚠️  6 个部分无数据
2026-02-24 15:07:01 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 15:07:01 - weekly_report - INFO - fetch_all_sections:230 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 15:07:01 - weekly_report - INFO - fetch_section_data:196 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 15:07:01 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:07:01 - weekly_report - INFO - execute_metabase_query:64 - 使用MCP工具执行查询...
2026-02-24 15:07:01 - weekly_report - WARNING - execute_metabase_query:67 - MCP模式：需要通过主程序运行
2026-02-24 15:07:01 - weekly_report - INFO - fetch_section_data:196 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 15:07:01 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:07:01 - weekly_report - INFO - execute_metabase_query:64 - 使用MCP工具执行查询...
2026-02-24 15:07:01 - weekly_report - WARNING - execute_metabase_query:67 - MCP模式：需要通过主程序运行
2026-02-24 15:07:01 - weekly_report - INFO - fetch_section_data:196 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 15:07:01 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:07:01 - weekly_report - INFO - execute_metabase_query:64 - 使用MCP工具执行查询...
2026-02-24 15:07:01 - weekly_report - WARNING - execute_metabase_query:67 - MCP模式：需要通过主程序运行
2026-02-24 15:07:01 - weekly_report - INFO - fetch_section_data:196 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 15:07:01 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:07:01 - weekly_report - INFO - execute_metabase_query:64 - 使用MCP工具执行查询...
2026-02-24 15:07:01 - weekly_report - WARNING - execute_metabase_query:67 - MCP模式：需要通过主程序运行
2026-02-24 15:07:01 - weekly_report - INFO - fetch_section_data:196 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 15:07:01 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:07:01 - weekly_report - INFO - execute_metabase_query:64 - 使用MCP工具执行查询...
2026-02-24 15:07:01 - weekly_report - WARNING - execute_metabase_query:67 - MCP模式：需要通过主程序运行
2026-02-24 15:07:01 - weekly_report - INFO - fetch_section_data:196 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 15:07:01 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:07:01 - weekly_report - INFO - execute_metabase_query:64 - 使用MCP工具执行查询...
2026-02-24 15:07:01 - weekly_report - WARNING - execute_metabase_query:67 - MCP模式：需要通过主程序运行
2026-02-24 15:07:01 - weekly_report - INFO - fetch_all_sections:247 - ✅ 数据获取完成
2026-02-24 15:07:01 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 15:07:01 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 15:07:01 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 15:07:01 - weekly_report - INFO - analyze_all_sections:150 - 开始分析所有部分...
2026-02-24 15:07:01 - weekly_report - INFO - analyze_all_sections:170 - ✅ 所有部分分析完成
2026-02-24 15:07:01 - weekly_report - INFO - main:240 - 
============================================================
2026-02-24 15:07:01 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-24 15:07:01 - weekly_report - INFO - main:242 - ============================================================
2026-02-24 15:07:01 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 15:07:01 - weekly_report - INFO - generate_full_report:591 - 生成完整报告HTML...
2026-02-24 15:07:01 - weekly_report - INFO - generate_full_report:615 - ✅ 完整报告HTML生成完成
2026-02-24 15:07:01 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-24 15:07:01 - weekly_report - INFO - main:258 - 
============================================================
2026-02-24 15:07:01 - weekly_report - INFO - main:259 - 第四阶段：保存报告到文件
2026-02-24 15:07:01 - weekly_report - INFO - main:260 - ============================================================
2026-02-24 15:07:01 - weekly_report - INFO - save_html_to_file:199 - ✅ HTML已保存到: confluence_report_2026-02-28.html
2026-02-24 15:07:01 - weekly_report - INFO - main:267 - 
============================================================
2026-02-24 15:07:01 - weekly_report - INFO - main:268 - ✅ 报告已保存到本地文件！
2026-02-24 15:07:01 - weekly_report - INFO - main:269 - ============================================================
2026-02-24 15:07:01 - weekly_report - INFO - main:270 - 文件路径: output/confluence_report_2026-02-28.html
2026-02-24 15:07:01 - weekly_report - INFO - main:271 - 报告日期: 2026-02-28
2026-02-24 15:07:32 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 15:07:32 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 15:07:32 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 15:07:32 - weekly_report - INFO - main:164 - 目标周: 本周
2026-02-24 15:07:32 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 15:07:32 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 15:07:32 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 15:07:32 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 15:07:32 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 15:07:32 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 15:07:32 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 15:07:32 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 15:07:32 - weekly_report - INFO - fetch_all_sections:230 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 15:07:32 - weekly_report - INFO - fetch_section_data:196 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 15:07:32 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:07:32 - weekly_report - INFO - _execute_via_api:98 - 使用API Key认证...
2026-02-24 15:07:32 - weekly_report - INFO - _execute_via_api:103 - ✅ Metabase API Key配置成功
2026-02-24 15:07:33 - weekly_report - ERROR - _execute_via_api:163 - ❌ 网络请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/v2/database/4/query_native (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2026-02-24 15:07:33 - weekly_report - INFO - fetch_section_data:196 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 15:07:33 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:07:33 - weekly_report - INFO - _execute_via_api:98 - 使用API Key认证...
2026-02-24 15:07:33 - weekly_report - INFO - _execute_via_api:103 - ✅ Metabase API Key配置成功
2026-02-24 15:07:33 - weekly_report - ERROR - _execute_via_api:163 - ❌ 网络请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/v2/database/4/query_native (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2026-02-24 15:07:33 - weekly_report - INFO - fetch_section_data:196 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 15:07:33 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:07:33 - weekly_report - INFO - _execute_via_api:98 - 使用API Key认证...
2026-02-24 15:07:33 - weekly_report - INFO - _execute_via_api:103 - ✅ Metabase API Key配置成功
2026-02-24 15:07:33 - weekly_report - ERROR - _execute_via_api:163 - ❌ 网络请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/v2/database/4/query_native (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2026-02-24 15:07:33 - weekly_report - INFO - fetch_section_data:196 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 15:07:33 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:07:33 - weekly_report - INFO - _execute_via_api:98 - 使用API Key认证...
2026-02-24 15:07:33 - weekly_report - INFO - _execute_via_api:103 - ✅ Metabase API Key配置成功
2026-02-24 15:07:37 - weekly_report - ERROR - _execute_via_api:163 - ❌ 网络请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/v2/database/4/query_native (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2026-02-24 15:07:37 - weekly_report - INFO - fetch_section_data:196 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 15:07:37 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:07:37 - weekly_report - INFO - _execute_via_api:98 - 使用API Key认证...
2026-02-24 15:07:37 - weekly_report - INFO - _execute_via_api:103 - ✅ Metabase API Key配置成功
2026-02-24 15:07:40 - weekly_report - ERROR - _execute_via_api:163 - ❌ 网络请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/v2/database/4/query_native (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2026-02-24 15:07:40 - weekly_report - INFO - fetch_section_data:196 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 15:07:40 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:07:40 - weekly_report - INFO - _execute_via_api:98 - 使用API Key认证...
2026-02-24 15:07:40 - weekly_report - INFO - _execute_via_api:103 - ✅ Metabase API Key配置成功
2026-02-24 15:07:40 - weekly_report - ERROR - _execute_via_api:163 - ❌ 网络请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/v2/database/4/query_native (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2026-02-24 15:07:40 - weekly_report - INFO - fetch_all_sections:247 - ✅ 数据获取完成
2026-02-24 15:07:40 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 15:07:40 - weekly_report - WARNING - main:219 - ⚠️  6 个部分无数据
2026-02-24 15:07:40 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 15:07:40 - weekly_report - INFO - fetch_all_sections:230 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 15:07:40 - weekly_report - INFO - fetch_section_data:196 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 15:07:40 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:07:40 - weekly_report - INFO - _execute_via_api:98 - 使用API Key认证...
2026-02-24 15:07:40 - weekly_report - INFO - _execute_via_api:103 - ✅ Metabase API Key配置成功
2026-02-24 15:07:41 - weekly_report - ERROR - _execute_via_api:163 - ❌ 网络请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/v2/database/4/query_native (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2026-02-24 15:07:41 - weekly_report - INFO - fetch_section_data:196 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 15:07:41 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:07:41 - weekly_report - INFO - _execute_via_api:98 - 使用API Key认证...
2026-02-24 15:07:41 - weekly_report - INFO - _execute_via_api:103 - ✅ Metabase API Key配置成功
2026-02-24 15:07:41 - weekly_report - ERROR - _execute_via_api:163 - ❌ 网络请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/v2/database/4/query_native (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2026-02-24 15:07:41 - weekly_report - INFO - fetch_section_data:196 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 15:07:41 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:07:41 - weekly_report - INFO - _execute_via_api:98 - 使用API Key认证...
2026-02-24 15:07:41 - weekly_report - INFO - _execute_via_api:103 - ✅ Metabase API Key配置成功
2026-02-24 15:07:41 - weekly_report - ERROR - _execute_via_api:163 - ❌ 网络请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/v2/database/4/query_native (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2026-02-24 15:07:41 - weekly_report - INFO - fetch_section_data:196 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 15:07:41 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:07:41 - weekly_report - INFO - _execute_via_api:98 - 使用API Key认证...
2026-02-24 15:07:41 - weekly_report - INFO - _execute_via_api:103 - ✅ Metabase API Key配置成功
2026-02-24 15:07:42 - weekly_report - ERROR - _execute_via_api:163 - ❌ 网络请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/v2/database/4/query_native (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2026-02-24 15:07:42 - weekly_report - INFO - fetch_section_data:196 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 15:07:42 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:07:42 - weekly_report - INFO - _execute_via_api:98 - 使用API Key认证...
2026-02-24 15:07:42 - weekly_report - INFO - _execute_via_api:103 - ✅ Metabase API Key配置成功
2026-02-24 15:07:43 - weekly_report - ERROR - _execute_via_api:163 - ❌ 网络请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/v2/database/4/query_native (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2026-02-24 15:07:43 - weekly_report - INFO - fetch_section_data:196 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 15:07:43 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:07:43 - weekly_report - INFO - _execute_via_api:98 - 使用API Key认证...
2026-02-24 15:07:43 - weekly_report - INFO - _execute_via_api:103 - ✅ Metabase API Key配置成功
2026-02-24 15:07:43 - weekly_report - ERROR - _execute_via_api:163 - ❌ 网络请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/v2/database/4/query_native (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2026-02-24 15:07:43 - weekly_report - INFO - fetch_all_sections:247 - ✅ 数据获取完成
2026-02-24 15:07:43 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 15:07:43 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 15:07:43 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 15:07:43 - weekly_report - INFO - analyze_all_sections:150 - 开始分析所有部分...
2026-02-24 15:07:43 - weekly_report - INFO - analyze_all_sections:170 - ✅ 所有部分分析完成
2026-02-24 15:07:43 - weekly_report - INFO - main:240 - 
============================================================
2026-02-24 15:07:43 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-24 15:07:43 - weekly_report - INFO - main:242 - ============================================================
2026-02-24 15:07:43 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 15:07:43 - weekly_report - INFO - generate_full_report:591 - 生成完整报告HTML...
2026-02-24 15:07:43 - weekly_report - INFO - generate_full_report:615 - ✅ 完整报告HTML生成完成
2026-02-24 15:07:43 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-24 15:07:43 - weekly_report - INFO - main:258 - 
============================================================
2026-02-24 15:07:43 - weekly_report - INFO - main:259 - 第四阶段：保存报告到文件
2026-02-24 15:07:43 - weekly_report - INFO - main:260 - ============================================================
2026-02-24 15:07:43 - weekly_report - INFO - save_html_to_file:199 - ✅ HTML已保存到: confluence_report_2026-02-28.html
2026-02-24 15:07:43 - weekly_report - INFO - main:267 - 
============================================================
2026-02-24 15:07:43 - weekly_report - INFO - main:268 - ✅ 报告已保存到本地文件！
2026-02-24 15:07:43 - weekly_report - INFO - main:269 - ============================================================
2026-02-24 15:07:43 - weekly_report - INFO - main:270 - 文件路径: output/confluence_report_2026-02-28.html
2026-02-24 15:07:43 - weekly_report - INFO - main:271 - 报告日期: 2026-02-28
2026-02-24 15:10:20 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 15:10:20 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 15:10:20 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 15:10:20 - weekly_report - INFO - main:164 - 目标周: 本周
2026-02-24 15:10:20 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 15:10:20 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 15:10:20 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 15:10:20 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 15:10:20 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 15:10:20 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 15:10:20 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 15:10:20 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 15:10:20 - weekly_report - INFO - fetch_all_sections:235 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 15:10:20 - weekly_report - INFO - fetch_section_data:201 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 15:10:20 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:10:20 - weekly_report - INFO - _execute_via_api:102 - 使用API Key认证...
2026-02-24 15:10:20 - weekly_report - INFO - _execute_via_api:107 - ✅ Metabase API Key配置成功
2026-02-24 15:10:22 - weekly_report - ERROR - _execute_via_api:168 - ❌ 网络请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/v2/database/4/query_native (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2026-02-24 15:10:22 - weekly_report - INFO - fetch_section_data:201 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 15:10:22 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:10:22 - weekly_report - INFO - _execute_via_api:102 - 使用API Key认证...
2026-02-24 15:10:22 - weekly_report - INFO - _execute_via_api:107 - ✅ Metabase API Key配置成功
2026-02-24 15:10:23 - weekly_report - ERROR - _execute_via_api:168 - ❌ 网络请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/v2/database/4/query_native (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2026-02-24 15:10:23 - weekly_report - INFO - fetch_section_data:201 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 15:10:23 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:10:23 - weekly_report - INFO - _execute_via_api:102 - 使用API Key认证...
2026-02-24 15:10:23 - weekly_report - INFO - _execute_via_api:107 - ✅ Metabase API Key配置成功
2026-02-24 15:10:24 - weekly_report - ERROR - _execute_via_api:168 - ❌ 网络请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/v2/database/4/query_native (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2026-02-24 15:10:24 - weekly_report - INFO - fetch_section_data:201 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 15:10:24 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:10:24 - weekly_report - INFO - _execute_via_api:102 - 使用API Key认证...
2026-02-24 15:10:24 - weekly_report - INFO - _execute_via_api:107 - ✅ Metabase API Key配置成功
2026-02-24 15:10:25 - weekly_report - ERROR - _execute_via_api:168 - ❌ 网络请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/v2/database/4/query_native (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2026-02-24 15:10:25 - weekly_report - INFO - fetch_section_data:201 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 15:10:25 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:10:25 - weekly_report - INFO - _execute_via_api:102 - 使用API Key认证...
2026-02-24 15:10:25 - weekly_report - INFO - _execute_via_api:107 - ✅ Metabase API Key配置成功
2026-02-24 15:10:26 - weekly_report - ERROR - _execute_via_api:168 - ❌ 网络请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/v2/database/4/query_native (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2026-02-24 15:10:26 - weekly_report - INFO - fetch_section_data:201 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 15:10:26 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:10:26 - weekly_report - INFO - _execute_via_api:102 - 使用API Key认证...
2026-02-24 15:10:26 - weekly_report - INFO - _execute_via_api:107 - ✅ Metabase API Key配置成功
2026-02-24 15:10:26 - weekly_report - ERROR - _execute_via_api:168 - ❌ 网络请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/v2/database/4/query_native (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2026-02-24 15:10:26 - weekly_report - INFO - fetch_all_sections:252 - ✅ 数据获取完成
2026-02-24 15:10:26 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 15:10:26 - weekly_report - WARNING - main:219 - ⚠️  6 个部分无数据
2026-02-24 15:10:26 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 15:10:26 - weekly_report - INFO - fetch_all_sections:235 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 15:10:26 - weekly_report - INFO - fetch_section_data:201 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 15:10:26 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:10:26 - weekly_report - INFO - _execute_via_api:102 - 使用API Key认证...
2026-02-24 15:10:26 - weekly_report - INFO - _execute_via_api:107 - ✅ Metabase API Key配置成功
2026-02-24 15:10:28 - weekly_report - ERROR - _execute_via_api:168 - ❌ 网络请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/v2/database/4/query_native (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2026-02-24 15:10:28 - weekly_report - INFO - fetch_section_data:201 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 15:10:28 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:10:28 - weekly_report - INFO - _execute_via_api:102 - 使用API Key认证...
2026-02-24 15:10:28 - weekly_report - INFO - _execute_via_api:107 - ✅ Metabase API Key配置成功
2026-02-24 15:10:29 - weekly_report - ERROR - _execute_via_api:168 - ❌ 网络请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/v2/database/4/query_native (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2026-02-24 15:10:29 - weekly_report - INFO - fetch_section_data:201 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 15:10:29 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:10:29 - weekly_report - INFO - _execute_via_api:102 - 使用API Key认证...
2026-02-24 15:10:29 - weekly_report - INFO - _execute_via_api:107 - ✅ Metabase API Key配置成功
2026-02-24 15:10:29 - weekly_report - ERROR - _execute_via_api:168 - ❌ 网络请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/v2/database/4/query_native (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2026-02-24 15:10:29 - weekly_report - INFO - fetch_section_data:201 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 15:10:29 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:10:29 - weekly_report - INFO - _execute_via_api:102 - 使用API Key认证...
2026-02-24 15:10:29 - weekly_report - INFO - _execute_via_api:107 - ✅ Metabase API Key配置成功
2026-02-24 15:10:31 - weekly_report - ERROR - _execute_via_api:168 - ❌ 网络请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/v2/database/4/query_native (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2026-02-24 15:10:31 - weekly_report - INFO - fetch_section_data:201 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 15:10:31 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:10:31 - weekly_report - INFO - _execute_via_api:102 - 使用API Key认证...
2026-02-24 15:10:31 - weekly_report - INFO - _execute_via_api:107 - ✅ Metabase API Key配置成功
2026-02-24 15:10:31 - weekly_report - ERROR - _execute_via_api:168 - ❌ 网络请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/v2/database/4/query_native (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2026-02-24 15:10:31 - weekly_report - INFO - fetch_section_data:201 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 15:10:31 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:10:31 - weekly_report - INFO - _execute_via_api:102 - 使用API Key认证...
2026-02-24 15:10:31 - weekly_report - INFO - _execute_via_api:107 - ✅ Metabase API Key配置成功
2026-02-24 15:10:34 - weekly_report - ERROR - _execute_via_api:168 - ❌ 网络请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/v2/database/4/query_native (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))
2026-02-24 15:10:34 - weekly_report - INFO - fetch_all_sections:252 - ✅ 数据获取完成
2026-02-24 15:10:34 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 15:10:34 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 15:10:34 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 15:10:34 - weekly_report - INFO - analyze_all_sections:150 - 开始分析所有部分...
2026-02-24 15:10:34 - weekly_report - INFO - analyze_all_sections:170 - ✅ 所有部分分析完成
2026-02-24 15:10:34 - weekly_report - INFO - main:240 - 
============================================================
2026-02-24 15:10:34 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-24 15:10:34 - weekly_report - INFO - main:242 - ============================================================
2026-02-24 15:10:34 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 15:10:34 - weekly_report - INFO - generate_full_report:591 - 生成完整报告HTML...
2026-02-24 15:10:34 - weekly_report - INFO - generate_full_report:615 - ✅ 完整报告HTML生成完成
2026-02-24 15:10:34 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-24 15:10:34 - weekly_report - INFO - main:258 - 
============================================================
2026-02-24 15:10:34 - weekly_report - INFO - main:259 - 第四阶段：保存报告到文件
2026-02-24 15:10:34 - weekly_report - INFO - main:260 - ============================================================
2026-02-24 15:10:34 - weekly_report - INFO - save_html_to_file:203 - ✅ HTML已保存到: confluence_report_2026-02-28.html
2026-02-24 15:10:34 - weekly_report - INFO - main:267 - 
============================================================
2026-02-24 15:10:34 - weekly_report - INFO - main:268 - ✅ 报告已保存到本地文件！
2026-02-24 15:10:34 - weekly_report - INFO - main:269 - ============================================================
2026-02-24 15:10:34 - weekly_report - INFO - main:270 - 文件路径: output/confluence_report_2026-02-28.html
2026-02-24 15:10:34 - weekly_report - INFO - main:271 - 报告日期: 2026-02-28
2026-02-24 15:12:33 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 15:12:33 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 15:12:33 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 15:12:33 - weekly_report - INFO - main:164 - 目标周: 本周
2026-02-24 15:12:33 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 15:12:33 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 15:12:33 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 15:12:33 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 15:12:33 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 15:12:33 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 15:12:33 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 15:12:33 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 15:12:33 - weekly_report - INFO - fetch_all_sections:213 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 15:12:33 - weekly_report - INFO - fetch_section_data:179 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 15:12:33 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:12:33 - weekly_report - INFO - _execute_via_api:91 - 使用curl执行API查询...
2026-02-24 15:12:33 - weekly_report - WARNING - _execute_via_api:140 - ⚠️  返回数据格式不符合预期
2026-02-24 15:12:33 - weekly_report - INFO - fetch_section_data:179 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 15:12:33 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:12:33 - weekly_report - INFO - _execute_via_api:91 - 使用curl执行API查询...
2026-02-24 15:12:34 - weekly_report - WARNING - _execute_via_api:140 - ⚠️  返回数据格式不符合预期
2026-02-24 15:12:34 - weekly_report - INFO - fetch_section_data:179 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 15:12:34 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:12:34 - weekly_report - INFO - _execute_via_api:91 - 使用curl执行API查询...
2026-02-24 15:12:34 - weekly_report - WARNING - _execute_via_api:140 - ⚠️  返回数据格式不符合预期
2026-02-24 15:12:34 - weekly_report - INFO - fetch_section_data:179 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 15:12:34 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:12:34 - weekly_report - INFO - _execute_via_api:91 - 使用curl执行API查询...
2026-02-24 15:12:35 - weekly_report - WARNING - _execute_via_api:140 - ⚠️  返回数据格式不符合预期
2026-02-24 15:12:35 - weekly_report - INFO - fetch_section_data:179 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 15:12:35 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:12:35 - weekly_report - INFO - _execute_via_api:91 - 使用curl执行API查询...
2026-02-24 15:12:35 - weekly_report - WARNING - _execute_via_api:140 - ⚠️  返回数据格式不符合预期
2026-02-24 15:12:35 - weekly_report - INFO - fetch_section_data:179 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 15:12:35 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:12:35 - weekly_report - INFO - _execute_via_api:91 - 使用curl执行API查询...
2026-02-24 15:12:35 - weekly_report - WARNING - _execute_via_api:140 - ⚠️  返回数据格式不符合预期
2026-02-24 15:12:35 - weekly_report - INFO - fetch_all_sections:230 - ✅ 数据获取完成
2026-02-24 15:12:35 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 15:12:35 - weekly_report - WARNING - main:219 - ⚠️  6 个部分无数据
2026-02-24 15:12:35 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 15:12:35 - weekly_report - INFO - fetch_all_sections:213 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 15:12:35 - weekly_report - INFO - fetch_section_data:179 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 15:12:35 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:12:35 - weekly_report - INFO - _execute_via_api:91 - 使用curl执行API查询...
2026-02-24 15:12:36 - weekly_report - WARNING - _execute_via_api:140 - ⚠️  返回数据格式不符合预期
2026-02-24 15:12:36 - weekly_report - INFO - fetch_section_data:179 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 15:12:36 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:12:36 - weekly_report - INFO - _execute_via_api:91 - 使用curl执行API查询...
2026-02-24 15:12:36 - weekly_report - WARNING - _execute_via_api:140 - ⚠️  返回数据格式不符合预期
2026-02-24 15:12:36 - weekly_report - INFO - fetch_section_data:179 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 15:12:36 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:12:36 - weekly_report - INFO - _execute_via_api:91 - 使用curl执行API查询...
2026-02-24 15:12:36 - weekly_report - WARNING - _execute_via_api:140 - ⚠️  返回数据格式不符合预期
2026-02-24 15:12:36 - weekly_report - INFO - fetch_section_data:179 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 15:12:36 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:12:36 - weekly_report - INFO - _execute_via_api:91 - 使用curl执行API查询...
2026-02-24 15:12:37 - weekly_report - WARNING - _execute_via_api:140 - ⚠️  返回数据格式不符合预期
2026-02-24 15:12:37 - weekly_report - INFO - fetch_section_data:179 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 15:12:37 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:12:37 - weekly_report - INFO - _execute_via_api:91 - 使用curl执行API查询...
2026-02-24 15:12:37 - weekly_report - WARNING - _execute_via_api:140 - ⚠️  返回数据格式不符合预期
2026-02-24 15:12:37 - weekly_report - INFO - fetch_section_data:179 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 15:12:37 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:12:37 - weekly_report - INFO - _execute_via_api:91 - 使用curl执行API查询...
2026-02-24 15:12:38 - weekly_report - WARNING - _execute_via_api:140 - ⚠️  返回数据格式不符合预期
2026-02-24 15:12:38 - weekly_report - INFO - fetch_all_sections:230 - ✅ 数据获取完成
2026-02-24 15:12:38 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 15:12:38 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 15:12:38 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 15:12:38 - weekly_report - INFO - analyze_all_sections:150 - 开始分析所有部分...
2026-02-24 15:12:38 - weekly_report - INFO - analyze_all_sections:170 - ✅ 所有部分分析完成
2026-02-24 15:12:38 - weekly_report - INFO - main:240 - 
============================================================
2026-02-24 15:12:38 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-24 15:12:38 - weekly_report - INFO - main:242 - ============================================================
2026-02-24 15:12:38 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 15:12:38 - weekly_report - INFO - generate_full_report:591 - 生成完整报告HTML...
2026-02-24 15:12:38 - weekly_report - INFO - generate_full_report:615 - ✅ 完整报告HTML生成完成
2026-02-24 15:12:38 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-24 15:12:38 - weekly_report - INFO - main:258 - 
============================================================
2026-02-24 15:12:38 - weekly_report - INFO - main:259 - 第四阶段：保存报告到文件
2026-02-24 15:12:38 - weekly_report - INFO - main:260 - ============================================================
2026-02-24 15:12:38 - weekly_report - INFO - save_html_to_file:203 - ✅ HTML已保存到: confluence_report_2026-02-28.html
2026-02-24 15:12:38 - weekly_report - INFO - main:267 - 
============================================================
2026-02-24 15:12:38 - weekly_report - INFO - main:268 - ✅ 报告已保存到本地文件！
2026-02-24 15:12:38 - weekly_report - INFO - main:269 - ============================================================
2026-02-24 15:12:38 - weekly_report - INFO - main:270 - 文件路径: output/confluence_report_2026-02-28.html
2026-02-24 15:12:38 - weekly_report - INFO - main:271 - 报告日期: 2026-02-28
2026-02-24 15:26:38 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 15:26:38 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 15:26:38 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 15:26:38 - weekly_report - INFO - main:164 - 目标周: 本周
2026-02-24 15:26:38 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 15:26:38 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 15:26:38 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 15:26:38 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 15:26:38 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 15:26:38 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 15:26:38 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 15:26:38 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 15:26:38 - weekly_report - INFO - fetch_all_sections:150 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 15:26:38 - weekly_report - INFO - fetch_section_data:116 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 15:26:38 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:26:38 - weekly_report - WARNING - _execute_via_api:89 - ⚠️  当前环境无法直接访问Metabase API
2026-02-24 15:26:38 - weekly_report - WARNING - _execute_via_api:90 - ⚠️  请使用MCP CLI运行此程序以获取真实数据
2026-02-24 15:26:38 - weekly_report - WARNING - _execute_via_api:91 - ⚠️  返回空列表
2026-02-24 15:26:38 - weekly_report - INFO - fetch_section_data:116 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 15:26:38 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:26:38 - weekly_report - WARNING - _execute_via_api:89 - ⚠️  当前环境无法直接访问Metabase API
2026-02-24 15:26:38 - weekly_report - WARNING - _execute_via_api:90 - ⚠️  请使用MCP CLI运行此程序以获取真实数据
2026-02-24 15:26:38 - weekly_report - WARNING - _execute_via_api:91 - ⚠️  返回空列表
2026-02-24 15:26:38 - weekly_report - INFO - fetch_section_data:116 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 15:26:38 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:26:38 - weekly_report - WARNING - _execute_via_api:89 - ⚠️  当前环境无法直接访问Metabase API
2026-02-24 15:26:38 - weekly_report - WARNING - _execute_via_api:90 - ⚠️  请使用MCP CLI运行此程序以获取真实数据
2026-02-24 15:26:38 - weekly_report - WARNING - _execute_via_api:91 - ⚠️  返回空列表
2026-02-24 15:26:38 - weekly_report - INFO - fetch_section_data:116 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 15:26:38 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:26:38 - weekly_report - WARNING - _execute_via_api:89 - ⚠️  当前环境无法直接访问Metabase API
2026-02-24 15:26:38 - weekly_report - WARNING - _execute_via_api:90 - ⚠️  请使用MCP CLI运行此程序以获取真实数据
2026-02-24 15:26:38 - weekly_report - WARNING - _execute_via_api:91 - ⚠️  返回空列表
2026-02-24 15:26:38 - weekly_report - INFO - fetch_section_data:116 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 15:26:38 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:26:38 - weekly_report - WARNING - _execute_via_api:89 - ⚠️  当前环境无法直接访问Metabase API
2026-02-24 15:26:38 - weekly_report - WARNING - _execute_via_api:90 - ⚠️  请使用MCP CLI运行此程序以获取真实数据
2026-02-24 15:26:38 - weekly_report - WARNING - _execute_via_api:91 - ⚠️  返回空列表
2026-02-24 15:26:38 - weekly_report - INFO - fetch_section_data:116 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 15:26:38 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:26:38 - weekly_report - WARNING - _execute_via_api:89 - ⚠️  当前环境无法直接访问Metabase API
2026-02-24 15:26:38 - weekly_report - WARNING - _execute_via_api:90 - ⚠️  请使用MCP CLI运行此程序以获取真实数据
2026-02-24 15:26:38 - weekly_report - WARNING - _execute_via_api:91 - ⚠️  返回空列表
2026-02-24 15:26:38 - weekly_report - INFO - fetch_all_sections:167 - ✅ 数据获取完成
2026-02-24 15:26:38 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 15:26:38 - weekly_report - WARNING - main:219 - ⚠️  6 个部分无数据
2026-02-24 15:26:38 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 15:26:38 - weekly_report - INFO - fetch_all_sections:150 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 15:26:38 - weekly_report - INFO - fetch_section_data:116 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 15:26:38 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:26:38 - weekly_report - WARNING - _execute_via_api:89 - ⚠️  当前环境无法直接访问Metabase API
2026-02-24 15:26:38 - weekly_report - WARNING - _execute_via_api:90 - ⚠️  请使用MCP CLI运行此程序以获取真实数据
2026-02-24 15:26:38 - weekly_report - WARNING - _execute_via_api:91 - ⚠️  返回空列表
2026-02-24 15:26:38 - weekly_report - INFO - fetch_section_data:116 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 15:26:38 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:26:38 - weekly_report - WARNING - _execute_via_api:89 - ⚠️  当前环境无法直接访问Metabase API
2026-02-24 15:26:38 - weekly_report - WARNING - _execute_via_api:90 - ⚠️  请使用MCP CLI运行此程序以获取真实数据
2026-02-24 15:26:38 - weekly_report - WARNING - _execute_via_api:91 - ⚠️  返回空列表
2026-02-24 15:26:38 - weekly_report - INFO - fetch_section_data:116 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 15:26:38 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:26:38 - weekly_report - WARNING - _execute_via_api:89 - ⚠️  当前环境无法直接访问Metabase API
2026-02-24 15:26:38 - weekly_report - WARNING - _execute_via_api:90 - ⚠️  请使用MCP CLI运行此程序以获取真实数据
2026-02-24 15:26:38 - weekly_report - WARNING - _execute_via_api:91 - ⚠️  返回空列表
2026-02-24 15:26:38 - weekly_report - INFO - fetch_section_data:116 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 15:26:38 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:26:38 - weekly_report - WARNING - _execute_via_api:89 - ⚠️  当前环境无法直接访问Metabase API
2026-02-24 15:26:38 - weekly_report - WARNING - _execute_via_api:90 - ⚠️  请使用MCP CLI运行此程序以获取真实数据
2026-02-24 15:26:38 - weekly_report - WARNING - _execute_via_api:91 - ⚠️  返回空列表
2026-02-24 15:26:38 - weekly_report - INFO - fetch_section_data:116 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 15:26:38 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:26:38 - weekly_report - WARNING - _execute_via_api:89 - ⚠️  当前环境无法直接访问Metabase API
2026-02-24 15:26:38 - weekly_report - WARNING - _execute_via_api:90 - ⚠️  请使用MCP CLI运行此程序以获取真实数据
2026-02-24 15:26:38 - weekly_report - WARNING - _execute_via_api:91 - ⚠️  返回空列表
2026-02-24 15:26:38 - weekly_report - INFO - fetch_section_data:116 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 15:26:38 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:26:38 - weekly_report - WARNING - _execute_via_api:89 - ⚠️  当前环境无法直接访问Metabase API
2026-02-24 15:26:38 - weekly_report - WARNING - _execute_via_api:90 - ⚠️  请使用MCP CLI运行此程序以获取真实数据
2026-02-24 15:26:38 - weekly_report - WARNING - _execute_via_api:91 - ⚠️  返回空列表
2026-02-24 15:26:38 - weekly_report - INFO - fetch_all_sections:167 - ✅ 数据获取完成
2026-02-24 15:26:38 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 15:26:38 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 15:26:38 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 15:26:38 - weekly_report - INFO - analyze_all_sections:150 - 开始分析所有部分...
2026-02-24 15:26:38 - weekly_report - INFO - analyze_all_sections:170 - ✅ 所有部分分析完成
2026-02-24 15:26:38 - weekly_report - INFO - main:240 - 
============================================================
2026-02-24 15:26:38 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-24 15:26:38 - weekly_report - INFO - main:242 - ============================================================
2026-02-24 15:26:38 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 15:26:38 - weekly_report - INFO - generate_full_report:591 - 生成完整报告HTML...
2026-02-24 15:26:38 - weekly_report - INFO - generate_full_report:615 - ✅ 完整报告HTML生成完成
2026-02-24 15:26:38 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-24 15:26:38 - weekly_report - INFO - main:258 - 
============================================================
2026-02-24 15:26:38 - weekly_report - INFO - main:259 - 第四阶段：保存报告到文件
2026-02-24 15:26:38 - weekly_report - INFO - main:260 - ============================================================
2026-02-24 15:26:38 - weekly_report - INFO - save_html_to_file:203 - ✅ HTML已保存到: confluence_report_2026-02-28.html
2026-02-24 15:26:38 - weekly_report - INFO - main:267 - 
============================================================
2026-02-24 15:26:38 - weekly_report - INFO - main:268 - ✅ 报告已保存到本地文件！
2026-02-24 15:26:38 - weekly_report - INFO - main:269 - ============================================================
2026-02-24 15:26:38 - weekly_report - INFO - main:270 - 文件路径: output/confluence_report_2026-02-28.html
2026-02-24 15:26:38 - weekly_report - INFO - main:271 - 报告日期: 2026-02-28
2026-02-24 15:48:50 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 15:48:50 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 15:48:50 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 15:48:50 - weekly_report - INFO - main:164 - 目标周: 本周
2026-02-24 15:48:50 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 15:48:50 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 15:48:50 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 15:48:50 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 15:48:50 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 15:48:50 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 15:48:50 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 15:48:50 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 15:48:50 - weekly_report - INFO - fetch_all_sections:226 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 15:48:50 - weekly_report - INFO - fetch_section_data:192 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 15:48:50 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:48:50 - weekly_report - INFO - _execute_via_api:92 - 使用MCP工具通过subprocess执行查询...
2026-02-24 15:48:50 - weekly_report - ERROR - _execute_via_api:165 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 15:48:50 - weekly_report - INFO - fetch_section_data:192 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 15:48:50 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:48:50 - weekly_report - INFO - _execute_via_api:92 - 使用MCP工具通过subprocess执行查询...
2026-02-24 15:48:50 - weekly_report - ERROR - _execute_via_api:165 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 15:48:50 - weekly_report - INFO - fetch_section_data:192 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 15:48:50 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:48:50 - weekly_report - INFO - _execute_via_api:92 - 使用MCP工具通过subprocess执行查询...
2026-02-24 15:48:50 - weekly_report - ERROR - _execute_via_api:165 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 15:48:50 - weekly_report - INFO - fetch_section_data:192 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 15:48:50 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:48:50 - weekly_report - INFO - _execute_via_api:92 - 使用MCP工具通过subprocess执行查询...
2026-02-24 15:48:50 - weekly_report - ERROR - _execute_via_api:165 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 15:48:50 - weekly_report - INFO - fetch_section_data:192 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 15:48:50 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:48:50 - weekly_report - INFO - _execute_via_api:92 - 使用MCP工具通过subprocess执行查询...
2026-02-24 15:48:50 - weekly_report - ERROR - _execute_via_api:165 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 15:48:50 - weekly_report - INFO - fetch_section_data:192 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 15:48:50 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:48:50 - weekly_report - INFO - _execute_via_api:92 - 使用MCP工具通过subprocess执行查询...
2026-02-24 15:48:50 - weekly_report - ERROR - _execute_via_api:165 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 15:48:50 - weekly_report - INFO - fetch_all_sections:243 - ✅ 数据获取完成
2026-02-24 15:48:50 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 15:48:50 - weekly_report - WARNING - main:219 - ⚠️  6 个部分无数据
2026-02-24 15:48:50 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 15:48:50 - weekly_report - INFO - fetch_all_sections:226 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 15:48:50 - weekly_report - INFO - fetch_section_data:192 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 15:48:50 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:48:50 - weekly_report - INFO - _execute_via_api:92 - 使用MCP工具通过subprocess执行查询...
2026-02-24 15:48:50 - weekly_report - ERROR - _execute_via_api:165 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 15:48:50 - weekly_report - INFO - fetch_section_data:192 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 15:48:50 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:48:50 - weekly_report - INFO - _execute_via_api:92 - 使用MCP工具通过subprocess执行查询...
2026-02-24 15:48:50 - weekly_report - ERROR - _execute_via_api:165 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 15:48:50 - weekly_report - INFO - fetch_section_data:192 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 15:48:50 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:48:50 - weekly_report - INFO - _execute_via_api:92 - 使用MCP工具通过subprocess执行查询...
2026-02-24 15:48:50 - weekly_report - ERROR - _execute_via_api:165 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 15:48:50 - weekly_report - INFO - fetch_section_data:192 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 15:48:50 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:48:50 - weekly_report - INFO - _execute_via_api:92 - 使用MCP工具通过subprocess执行查询...
2026-02-24 15:48:50 - weekly_report - ERROR - _execute_via_api:165 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 15:48:50 - weekly_report - INFO - fetch_section_data:192 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 15:48:50 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:48:50 - weekly_report - INFO - _execute_via_api:92 - 使用MCP工具通过subprocess执行查询...
2026-02-24 15:48:50 - weekly_report - ERROR - _execute_via_api:165 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 15:48:50 - weekly_report - INFO - fetch_section_data:192 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 15:48:50 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:48:50 - weekly_report - INFO - _execute_via_api:92 - 使用MCP工具通过subprocess执行查询...
2026-02-24 15:48:50 - weekly_report - ERROR - _execute_via_api:165 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 15:48:50 - weekly_report - INFO - fetch_all_sections:243 - ✅ 数据获取完成
2026-02-24 15:48:50 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 15:48:50 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 15:48:50 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 15:48:50 - weekly_report - INFO - analyze_all_sections:150 - 开始分析所有部分...
2026-02-24 15:48:50 - weekly_report - INFO - analyze_all_sections:170 - ✅ 所有部分分析完成
2026-02-24 15:48:50 - weekly_report - INFO - main:240 - 
============================================================
2026-02-24 15:48:50 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-24 15:48:50 - weekly_report - INFO - main:242 - ============================================================
2026-02-24 15:48:50 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 15:48:50 - weekly_report - INFO - generate_full_report:591 - 生成完整报告HTML...
2026-02-24 15:48:50 - weekly_report - INFO - generate_full_report:615 - ✅ 完整报告HTML生成完成
2026-02-24 15:48:50 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-24 15:48:50 - weekly_report - INFO - main:258 - 
============================================================
2026-02-24 15:48:50 - weekly_report - INFO - main:259 - 第四阶段：保存报告到文件
2026-02-24 15:48:50 - weekly_report - INFO - main:260 - ============================================================
2026-02-24 15:48:50 - weekly_report - INFO - save_html_to_file:203 - ✅ HTML已保存到: confluence_report_2026-02-28.html
2026-02-24 15:48:50 - weekly_report - INFO - main:267 - 
============================================================
2026-02-24 15:48:50 - weekly_report - INFO - main:268 - ✅ 报告已保存到本地文件！
2026-02-24 15:48:50 - weekly_report - INFO - main:269 - ============================================================
2026-02-24 15:48:50 - weekly_report - INFO - main:270 - 文件路径: output/confluence_report_2026-02-28.html
2026-02-24 15:48:50 - weekly_report - INFO - main:271 - 报告日期: 2026-02-28
2026-02-24 15:57:33 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 15:57:33 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 15:57:33 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 15:57:33 - weekly_report - INFO - main:164 - 目标周: 本周
2026-02-24 15:57:33 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 15:57:33 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 15:57:33 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 15:57:33 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 15:57:33 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 15:57:33 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 15:57:33 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 15:57:33 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 15:57:33 - weekly_report - INFO - fetch_all_sections:226 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 15:57:33 - weekly_report - INFO - fetch_section_data:192 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 15:57:33 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:57:33 - weekly_report - INFO - _execute_via_api:92 - 使用MCP工具通过subprocess执行查询...
2026-02-24 15:57:33 - weekly_report - ERROR - _execute_via_api:165 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 15:57:33 - weekly_report - INFO - fetch_section_data:192 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 15:57:33 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:57:33 - weekly_report - INFO - _execute_via_api:92 - 使用MCP工具通过subprocess执行查询...
2026-02-24 15:57:33 - weekly_report - ERROR - _execute_via_api:165 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 15:57:33 - weekly_report - INFO - fetch_section_data:192 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 15:57:33 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:57:33 - weekly_report - INFO - _execute_via_api:92 - 使用MCP工具通过subprocess执行查询...
2026-02-24 15:57:33 - weekly_report - ERROR - _execute_via_api:165 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 15:57:33 - weekly_report - INFO - fetch_section_data:192 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 15:57:33 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:57:33 - weekly_report - INFO - _execute_via_api:92 - 使用MCP工具通过subprocess执行查询...
2026-02-24 15:57:33 - weekly_report - ERROR - _execute_via_api:165 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 15:57:33 - weekly_report - INFO - fetch_section_data:192 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 15:57:33 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:57:33 - weekly_report - INFO - _execute_via_api:92 - 使用MCP工具通过subprocess执行查询...
2026-02-24 15:57:33 - weekly_report - ERROR - _execute_via_api:165 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 15:57:33 - weekly_report - INFO - fetch_section_data:192 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 15:57:33 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:57:33 - weekly_report - INFO - _execute_via_api:92 - 使用MCP工具通过subprocess执行查询...
2026-02-24 15:57:33 - weekly_report - ERROR - _execute_via_api:165 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 15:57:33 - weekly_report - INFO - fetch_all_sections:243 - ✅ 数据获取完成
2026-02-24 15:57:33 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 15:57:33 - weekly_report - WARNING - main:219 - ⚠️  6 个部分无数据
2026-02-24 15:57:33 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 15:57:33 - weekly_report - INFO - fetch_all_sections:226 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 15:57:33 - weekly_report - INFO - fetch_section_data:192 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 15:57:33 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:57:33 - weekly_report - INFO - _execute_via_api:92 - 使用MCP工具通过subprocess执行查询...
2026-02-24 15:57:33 - weekly_report - ERROR - _execute_via_api:165 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 15:57:33 - weekly_report - INFO - fetch_section_data:192 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 15:57:33 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:57:33 - weekly_report - INFO - _execute_via_api:92 - 使用MCP工具通过subprocess执行查询...
2026-02-24 15:57:33 - weekly_report - ERROR - _execute_via_api:165 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 15:57:33 - weekly_report - INFO - fetch_section_data:192 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 15:57:33 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:57:33 - weekly_report - INFO - _execute_via_api:92 - 使用MCP工具通过subprocess执行查询...
2026-02-24 15:57:33 - weekly_report - ERROR - _execute_via_api:165 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 15:57:33 - weekly_report - INFO - fetch_section_data:192 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 15:57:33 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:57:33 - weekly_report - INFO - _execute_via_api:92 - 使用MCP工具通过subprocess执行查询...
2026-02-24 15:57:33 - weekly_report - ERROR - _execute_via_api:165 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 15:57:33 - weekly_report - INFO - fetch_section_data:192 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 15:57:33 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:57:33 - weekly_report - INFO - _execute_via_api:92 - 使用MCP工具通过subprocess执行查询...
2026-02-24 15:57:33 - weekly_report - ERROR - _execute_via_api:165 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 15:57:33 - weekly_report - INFO - fetch_section_data:192 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 15:57:33 - weekly_report - INFO - execute_metabase_query:59 - 正在执行Metabase查询...
2026-02-24 15:57:33 - weekly_report - INFO - _execute_via_api:92 - 使用MCP工具通过subprocess执行查询...
2026-02-24 15:57:33 - weekly_report - ERROR - _execute_via_api:165 - ❌ 查询执行异常: [Errno 2] No such file or directory: 'mcp'
2026-02-24 15:57:33 - weekly_report - INFO - fetch_all_sections:243 - ✅ 数据获取完成
2026-02-24 15:57:33 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 15:57:33 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 15:57:33 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 15:57:33 - weekly_report - INFO - analyze_all_sections:150 - 开始分析所有部分...
2026-02-24 15:57:33 - weekly_report - INFO - analyze_all_sections:170 - ✅ 所有部分分析完成
2026-02-24 15:57:33 - weekly_report - INFO - main:240 - 
============================================================
2026-02-24 15:57:33 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-24 15:57:33 - weekly_report - INFO - main:242 - ============================================================
2026-02-24 15:57:33 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 15:57:33 - weekly_report - INFO - generate_full_report:591 - 生成完整报告HTML...
2026-02-24 15:57:33 - weekly_report - INFO - generate_full_report:615 - ✅ 完整报告HTML生成完成
2026-02-24 15:57:33 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-24 15:57:33 - weekly_report - INFO - main:258 - 
============================================================
2026-02-24 15:57:33 - weekly_report - INFO - main:259 - 第四阶段：保存报告到文件
2026-02-24 15:57:33 - weekly_report - INFO - main:260 - ============================================================
2026-02-24 15:57:33 - weekly_report - INFO - save_html_to_file:203 - ✅ HTML已保存到: confluence_report_2026-02-28.html
2026-02-24 15:57:33 - weekly_report - INFO - main:267 - 
============================================================
2026-02-24 15:57:33 - weekly_report - INFO - main:268 - ✅ 报告已保存到本地文件！
2026-02-24 15:57:33 - weekly_report - INFO - main:269 - ============================================================
2026-02-24 15:57:33 - weekly_report - INFO - main:270 - 文件路径: output/confluence_report_2026-02-28.html
2026-02-24 15:57:33 - weekly_report - INFO - main:271 - 报告日期: 2026-02-28
2026-02-24 16:06:27 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 16:06:27 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 16:06:27 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 16:06:27 - weekly_report - INFO - main:164 - 目标周: 本周
2026-02-24 16:06:27 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 16:06:27 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 16:06:27 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 16:06:27 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 16:06:27 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 16:06:27 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 16:06:27 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 16:06:27 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 16:06:27 - weekly_report - INFO - fetch_all_sections:213 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 16:06:27 - weekly_report - INFO - fetch_section_data:179 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 16:06:27 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:06:27 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:06:28 - weekly_report - ERROR - _execute_via_api:114 - ❌ API请求失败，状态码: 202
2026-02-24 16:06:28 - weekly_report - ERROR - _execute_via_api:115 - 响应内容: {"data":{"rows":[["20260216","organic search",63895,5838,0.09136865169418577],["20260216","paid ads",36919,15792,0.42774723042335927],["20260216","referral",14398,32,0.0022225309070704265],["20260216","other",4734,387,0.0817490494296578],["20260216","ai search",3847,443,0.11515466597348584],["20260216","mobile app search",2239,162,0.07235372934345691],["20260216","affiliate & kol",1452,268,0.18457300275482094],["20260216","social media",716,94,0.13128491620111732],["20260216","operations",572,49
2026-02-24 16:06:28 - weekly_report - INFO - fetch_section_data:179 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 16:06:28 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:06:28 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:06:29 - weekly_report - ERROR - _execute_via_api:114 - ❌ API请求失败，状态码: 202
2026-02-24 16:06:29 - weekly_report - ERROR - _execute_via_api:115 - 响应内容: {"data":{"rows":[],"cols":[{"display_name":"日期","source":"native","field_ref":["field","日期",{"base-type":"type/Text"}],"name":"日期","base_type":"type/Text","database_type":"LONGTEXT","effective_type":"type/Text"},{"display_name":"新注册用户数","source":"native","field_ref":["field","新注册用户数",{"base-type":"type/BigInteger"}],"name":"新注册用户数","base_type":"type/BigInteger","database_type":"BIGINT","effective_type":"type/BigInteger"},{"display_name":"注册到进工具转化率","source":"native","field_ref":["field","注册到进工具转
2026-02-24 16:06:29 - weekly_report - INFO - fetch_section_data:179 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 16:06:29 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:06:29 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:06:30 - weekly_report - ERROR - _execute_via_api:114 - ❌ API请求失败，状态码: 202
2026-02-24 16:06:30 - weekly_report - ERROR - _execute_via_api:115 - 响应内容: {"data":{"rows":[["20250804","个人用户",58981],["20250811","个人用户",55884],["20250818","个人用户",56538],["20250825","个人用户",57041],["20250901","个人用户",58759],["20250908","个人用户",58206],["20250915","个人用户",57593],["20250922","个人用户",60518],["20250929","个人用户",59023],["20251006","个人用户",65714],["20251013","个人用户",69004],["20251020","个人用户",71624],["20251027","个人用户",74211],["20251103","个人用户",71413],["20251110","个人用户",76011],["20251117","个人用户",76215],["20251124","个人用户",62819],["20251201","个人用户",59655],["20251208","个人
2026-02-24 16:06:30 - weekly_report - INFO - fetch_section_data:179 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 16:06:30 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:06:30 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:06:31 - weekly_report - ERROR - _execute_via_api:114 - ❌ API请求失败，状态码: 202
2026-02-24 16:06:31 - weekly_report - ERROR - _execute_via_api:115 - 响应内容: {"data":{"rows":[["20251110","新注册",40050],["20251110","老用户",35961],["20251117","老用户",35945],["20251117","新注册",40270],["20251124","老用户",34542],["20251124","新注册",28277],["20251201","老用户",32459],["20251201","新注册",27196],["20251208","新注册",23332],["20251208","老用户",31463],["20251215","新注册",20266],["20251215","老用户",28704],["20251222","新注册",25728],["20251222","老用户",27510],["20251229","新注册",24219],["20251229","老用户",27615],["20260105","新注册",26109],["20260105","老用户",30761],["20260112","新注册",26240],["202601
2026-02-24 16:06:31 - weekly_report - INFO - fetch_section_data:179 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 16:06:31 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:06:31 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:06:32 - weekly_report - ERROR - _execute_via_api:114 - ❌ API请求失败，状态码: 202
2026-02-24 16:06:32 - weekly_report - ERROR - _execute_via_api:115 - 响应内容: {"data":{"rows":[["20251110","新注册",40050,4282,0.1069],["20251110","老用户",35961,15485,0.4306],["20251117","老用户",35945,15351,0.4271],["20251117","新注册",40270,4304,0.1069],["20251124","老用户",34542,14787,0.4281],["20251124","新注册",28277,3101,0.1097],["20251201","老用户",32459,14242,0.4388],["20251201","新注册",27196,2875,0.1057],["20251208","新注册",23332,2335,0.1001],["20251208","老用户",31463,13435,0.427],["20251215","新注册",20266,2338,0.1154],["20251215","老用户",28704,12020,0.4188],["20251222","新注册",25728,2642,0.102
2026-02-24 16:06:32 - weekly_report - INFO - fetch_section_data:179 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 16:06:32 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:06:32 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:06:33 - weekly_report - ERROR - _execute_via_api:114 - ❌ API请求失败，状态码: 202
2026-02-24 16:06:33 - weekly_report - ERROR - _execute_via_api:115 - 响应内容: {"database_id":4,"parameterized":false,"started_at":"2026-02-24T16:06:33.124404248+08:00","via":[{"status":"failed","class":"class org.mariadb.jdbc.internal.util.exceptions.MariaDbSqlException","error":"Failed to get table [kdw_dw.dim_coohom_freemium_region_country_a_d], msg: NoSuchObjectException: kdw_dw.dim_coohom_freemium_region_country_a_d table not found","stacktrace":["org.mariadb.jdbc.internal.util.exceptions.MariaDbSqlException.of(MariaDbSqlException.java:34)","org.mariadb.jdbc.internal.
2026-02-24 16:06:33 - weekly_report - INFO - fetch_all_sections:230 - ✅ 数据获取完成
2026-02-24 16:06:33 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 16:06:33 - weekly_report - WARNING - main:219 - ⚠️  6 个部分无数据
2026-02-24 16:06:33 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 16:06:33 - weekly_report - INFO - fetch_all_sections:213 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 16:06:33 - weekly_report - INFO - fetch_section_data:179 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 16:06:33 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:06:33 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:06:34 - weekly_report - ERROR - _execute_via_api:114 - ❌ API请求失败，状态码: 202
2026-02-24 16:06:34 - weekly_report - ERROR - _execute_via_api:115 - 响应内容: {"data":{"rows":[["20260216","organic search",63895,5838,0.09136865169418577],["20260216","paid ads",36919,15792,0.42774723042335927],["20260216","referral",14398,32,0.0022225309070704265],["20260216","other",4734,387,0.0817490494296578],["20260216","ai search",3847,443,0.11515466597348584],["20260216","mobile app search",2239,162,0.07235372934345691],["20260216","affiliate & kol",1452,268,0.18457300275482094],["20260216","social media",716,94,0.13128491620111732],["20260216","operations",572,49
2026-02-24 16:06:34 - weekly_report - INFO - fetch_section_data:179 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 16:06:34 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:06:34 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:06:34 - weekly_report - ERROR - _execute_via_api:114 - ❌ API请求失败，状态码: 202
2026-02-24 16:06:34 - weekly_report - ERROR - _execute_via_api:115 - 响应内容: {"data":{"rows":[],"cols":[{"display_name":"日期","source":"native","field_ref":["field","日期",{"base-type":"type/Text"}],"name":"日期","base_type":"type/Text","database_type":"LONGTEXT","effective_type":"type/Text"},{"display_name":"新注册用户数","source":"native","field_ref":["field","新注册用户数",{"base-type":"type/BigInteger"}],"name":"新注册用户数","base_type":"type/BigInteger","database_type":"BIGINT","effective_type":"type/BigInteger"},{"display_name":"注册到进工具转化率","source":"native","field_ref":["field","注册到进工具转
2026-02-24 16:06:34 - weekly_report - INFO - fetch_section_data:179 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 16:06:34 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:06:34 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:06:36 - weekly_report - ERROR - _execute_via_api:114 - ❌ API请求失败，状态码: 202
2026-02-24 16:06:36 - weekly_report - ERROR - _execute_via_api:115 - 响应内容: {"data":{"rows":[["20250804","个人用户",58981],["20250811","个人用户",55884],["20250818","个人用户",56538],["20250825","个人用户",57041],["20250901","个人用户",58759],["20250908","个人用户",58206],["20250915","个人用户",57593],["20250922","个人用户",60518],["20250929","个人用户",59023],["20251006","个人用户",65714],["20251013","个人用户",69004],["20251020","个人用户",71624],["20251027","个人用户",74211],["20251103","个人用户",71413],["20251110","个人用户",76011],["20251117","个人用户",76215],["20251124","个人用户",62819],["20251201","个人用户",59655],["20251208","个人
2026-02-24 16:06:36 - weekly_report - INFO - fetch_section_data:179 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 16:06:36 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:06:36 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:06:37 - weekly_report - ERROR - _execute_via_api:114 - ❌ API请求失败，状态码: 202
2026-02-24 16:06:37 - weekly_report - ERROR - _execute_via_api:115 - 响应内容: {"data":{"rows":[["20251110","新注册",40050],["20251110","老用户",35961],["20251117","老用户",35945],["20251117","新注册",40270],["20251124","老用户",34542],["20251124","新注册",28277],["20251201","老用户",32459],["20251201","新注册",27196],["20251208","新注册",23332],["20251208","老用户",31463],["20251215","新注册",20266],["20251215","老用户",28704],["20251222","新注册",25728],["20251222","老用户",27510],["20251229","新注册",24219],["20251229","老用户",27615],["20260105","新注册",26109],["20260105","老用户",30761],["20260112","新注册",26240],["202601
2026-02-24 16:06:37 - weekly_report - INFO - fetch_section_data:179 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 16:06:37 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:06:37 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:06:38 - weekly_report - ERROR - _execute_via_api:114 - ❌ API请求失败，状态码: 202
2026-02-24 16:06:38 - weekly_report - ERROR - _execute_via_api:115 - 响应内容: {"data":{"rows":[["20251110","新注册",40050,4282,0.1069],["20251110","老用户",35961,15485,0.4306],["20251117","老用户",35945,15351,0.4271],["20251117","新注册",40270,4304,0.1069],["20251124","老用户",34542,14787,0.4281],["20251124","新注册",28277,3101,0.1097],["20251201","老用户",32459,14242,0.4388],["20251201","新注册",27196,2875,0.1057],["20251208","新注册",23332,2335,0.1001],["20251208","老用户",31463,13435,0.427],["20251215","新注册",20266,2338,0.1154],["20251215","老用户",28704,12020,0.4188],["20251222","新注册",25728,2642,0.102
2026-02-24 16:06:38 - weekly_report - INFO - fetch_section_data:179 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 16:06:38 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:06:38 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:06:39 - weekly_report - ERROR - _execute_via_api:114 - ❌ API请求失败，状态码: 202
2026-02-24 16:06:39 - weekly_report - ERROR - _execute_via_api:115 - 响应内容: {"database_id":4,"parameterized":false,"started_at":"2026-02-24T16:06:39.194340318+08:00","via":[{"status":"failed","class":"class org.mariadb.jdbc.internal.util.exceptions.MariaDbSqlException","error":"Failed to get table [kdw_dw.dim_coohom_freemium_region_country_a_d], msg: NoSuchObjectException: kdw_dw.dim_coohom_freemium_region_country_a_d table not found","stacktrace":["org.mariadb.jdbc.internal.util.exceptions.MariaDbSqlException.of(MariaDbSqlException.java:34)","org.mariadb.jdbc.internal.
2026-02-24 16:06:39 - weekly_report - INFO - fetch_all_sections:230 - ✅ 数据获取完成
2026-02-24 16:06:39 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 16:06:39 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 16:06:39 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 16:06:39 - weekly_report - INFO - analyze_all_sections:150 - 开始分析所有部分...
2026-02-24 16:06:39 - weekly_report - INFO - analyze_all_sections:170 - ✅ 所有部分分析完成
2026-02-24 16:06:39 - weekly_report - INFO - main:240 - 
============================================================
2026-02-24 16:06:39 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-24 16:06:39 - weekly_report - INFO - main:242 - ============================================================
2026-02-24 16:06:39 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 16:06:39 - weekly_report - INFO - generate_full_report:591 - 生成完整报告HTML...
2026-02-24 16:06:39 - weekly_report - INFO - generate_full_report:615 - ✅ 完整报告HTML生成完成
2026-02-24 16:06:39 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-24 16:06:39 - weekly_report - INFO - main:258 - 
============================================================
2026-02-24 16:06:39 - weekly_report - INFO - main:259 - 第四阶段：保存报告到文件
2026-02-24 16:06:39 - weekly_report - INFO - main:260 - ============================================================
2026-02-24 16:06:39 - weekly_report - INFO - save_html_to_file:203 - ✅ HTML已保存到: confluence_report_2026-02-28.html
2026-02-24 16:06:39 - weekly_report - INFO - main:267 - 
============================================================
2026-02-24 16:06:39 - weekly_report - INFO - main:268 - ✅ 报告已保存到本地文件！
2026-02-24 16:06:39 - weekly_report - INFO - main:269 - ============================================================
2026-02-24 16:06:39 - weekly_report - INFO - main:270 - 文件路径: output/confluence_report_2026-02-28.html
2026-02-24 16:06:39 - weekly_report - INFO - main:271 - 报告日期: 2026-02-28
2026-02-24 16:07:07 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 16:07:07 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 16:07:07 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 16:07:07 - weekly_report - INFO - main:164 - 目标周: 本周
2026-02-24 16:07:07 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 16:07:07 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 16:07:07 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 16:07:07 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 16:07:07 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 16:07:07 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 16:07:07 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 16:07:07 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 16:07:07 - weekly_report - INFO - fetch_all_sections:219 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 16:07:07 - weekly_report - INFO - fetch_section_data:185 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 16:07:07 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:07:07 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:07:07 - weekly_report - INFO - _execute_via_api:134 - ✅ 查询成功，返回 22 行数据
2026-02-24 16:07:07 - weekly_report - INFO - fetch_section_data:185 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 16:07:07 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:07:07 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:07:08 - weekly_report - INFO - _execute_via_api:134 - ✅ 查询成功，返回 0 行数据
2026-02-24 16:07:08 - weekly_report - INFO - fetch_section_data:185 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 16:07:08 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:07:08 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:07:09 - weekly_report - INFO - _execute_via_api:134 - ✅ 查询成功，返回 29 行数据
2026-02-24 16:07:09 - weekly_report - INFO - fetch_section_data:185 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 16:07:09 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:07:09 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:07:10 - weekly_report - INFO - _execute_via_api:134 - ✅ 查询成功，返回 26 行数据
2026-02-24 16:07:10 - weekly_report - INFO - fetch_section_data:185 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 16:07:10 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:07:10 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:07:11 - weekly_report - INFO - _execute_via_api:134 - ✅ 查询成功，返回 30 行数据
2026-02-24 16:07:11 - weekly_report - INFO - fetch_section_data:185 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 16:07:11 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:07:11 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:07:12 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 16:07:12 - weekly_report - INFO - fetch_all_sections:236 - ✅ 数据获取完成
2026-02-24 16:07:12 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 16:07:12 - weekly_report - INFO - main:217 - ✅ 成功获取 4 个部分的数据
2026-02-24 16:07:12 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 16:07:12 - weekly_report - INFO - fetch_all_sections:219 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 16:07:12 - weekly_report - INFO - fetch_section_data:185 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 16:07:12 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:07:12 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:07:13 - weekly_report - INFO - _execute_via_api:134 - ✅ 查询成功，返回 22 行数据
2026-02-24 16:07:13 - weekly_report - INFO - fetch_section_data:185 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 16:07:13 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:07:13 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:07:13 - weekly_report - INFO - _execute_via_api:134 - ✅ 查询成功，返回 0 行数据
2026-02-24 16:07:13 - weekly_report - INFO - fetch_section_data:185 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 16:07:13 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:07:13 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:07:14 - weekly_report - INFO - _execute_via_api:134 - ✅ 查询成功，返回 29 行数据
2026-02-24 16:07:14 - weekly_report - INFO - fetch_section_data:185 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 16:07:14 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:07:14 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:07:16 - weekly_report - INFO - _execute_via_api:134 - ✅ 查询成功，返回 26 行数据
2026-02-24 16:07:16 - weekly_report - INFO - fetch_section_data:185 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 16:07:16 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:07:16 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:07:17 - weekly_report - INFO - _execute_via_api:134 - ✅ 查询成功，返回 30 行数据
2026-02-24 16:07:17 - weekly_report - INFO - fetch_section_data:185 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 16:07:17 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:07:17 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:07:18 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 16:07:18 - weekly_report - INFO - fetch_all_sections:236 - ✅ 数据获取完成
2026-02-24 16:07:18 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 16:07:18 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 16:07:18 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 16:07:18 - weekly_report - INFO - analyze_all_sections:150 - 开始分析所有部分...
2026-02-24 16:07:18 - weekly_report - INFO - analyze_traffic_data:82 - 分析流量数据...
2026-02-24 16:07:18 - weekly_report - ERROR - main:300 - 
❌ 执行过程中出现异常: 'list' object has no attribute 'get'
Traceback (most recent call last):
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/main.py", line 231, in main
    analysis_results = analyzer.analyze_all_sections(current_data, previous_data)
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/src/data_analyzer.py", line 156, in analyze_all_sections
    results['traffic'] = self.analyze_traffic_data(
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/src/data_analyzer.py", line 85, in analyze_traffic_data
    total_current = sum(row.get('new_visitors', 0) for row in current_data)
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/src/data_analyzer.py", line 85, in <genexpr>
    total_current = sum(row.get('new_visitors', 0) for row in current_data)
AttributeError: 'list' object has no attribute 'get'
2026-02-24 16:07:53 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 16:07:53 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 16:07:53 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 16:07:53 - weekly_report - INFO - main:164 - 目标周: 本周
2026-02-24 16:07:53 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 16:07:53 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 16:07:53 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 16:07:53 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 16:07:53 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 16:07:53 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 16:07:53 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 16:07:53 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 16:07:53 - weekly_report - INFO - fetch_all_sections:233 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 16:07:53 - weekly_report - INFO - fetch_section_data:199 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 16:07:53 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:07:53 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:07:53 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 22 行数据
2026-02-24 16:07:53 - weekly_report - INFO - fetch_section_data:199 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 16:07:53 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:07:53 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:07:54 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 0 行数据
2026-02-24 16:07:54 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 16:07:54 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:07:54 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:07:55 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 29 行数据
2026-02-24 16:07:55 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 16:07:55 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:07:55 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:07:56 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 26 行数据
2026-02-24 16:07:56 - weekly_report - INFO - fetch_section_data:199 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 16:07:56 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:07:56 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:07:57 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 30 行数据
2026-02-24 16:07:57 - weekly_report - INFO - fetch_section_data:199 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 16:07:57 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:07:57 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:07:57 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 16:07:57 - weekly_report - INFO - fetch_all_sections:250 - ✅ 数据获取完成
2026-02-24 16:07:57 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 16:07:57 - weekly_report - INFO - main:217 - ✅ 成功获取 4 个部分的数据
2026-02-24 16:07:57 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 16:07:57 - weekly_report - INFO - fetch_all_sections:233 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 16:07:57 - weekly_report - INFO - fetch_section_data:199 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 16:07:57 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:07:57 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:07:58 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 22 行数据
2026-02-24 16:07:58 - weekly_report - INFO - fetch_section_data:199 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 16:07:58 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:07:58 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:07:59 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 0 行数据
2026-02-24 16:07:59 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 16:07:59 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:07:59 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:08:00 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 29 行数据
2026-02-24 16:08:00 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 16:08:00 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:08:00 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:08:01 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 26 行数据
2026-02-24 16:08:01 - weekly_report - INFO - fetch_section_data:199 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 16:08:01 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:08:01 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:08:02 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 30 行数据
2026-02-24 16:08:02 - weekly_report - INFO - fetch_section_data:199 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 16:08:02 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:08:02 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:08:03 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 16:08:03 - weekly_report - INFO - fetch_all_sections:250 - ✅ 数据获取完成
2026-02-24 16:08:03 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 16:08:03 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 16:08:03 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 16:08:03 - weekly_report - INFO - analyze_all_sections:150 - 开始分析所有部分...
2026-02-24 16:08:03 - weekly_report - INFO - analyze_traffic_data:82 - 分析流量数据...
2026-02-24 16:08:03 - weekly_report - ERROR - main:300 - 
❌ 执行过程中出现异常: unsupported format string passed to NoneType.__format__
Traceback (most recent call last):
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/main.py", line 231, in main
    analysis_results = analyzer.analyze_all_sections(current_data, previous_data)
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/src/data_analyzer.py", line 156, in analyze_all_sections
    results['traffic'] = self.analyze_traffic_data(
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/src/data_analyzer.py", line 94, in analyze_traffic_data
    'summary': f"总新访客 {total_current:,.0f} 人，{wow['trend']} {wow['change_rate']:+.1f}%"
TypeError: unsupported format string passed to NoneType.__format__
2026-02-24 16:09:20 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 16:09:20 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 16:09:20 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 16:09:20 - weekly_report - INFO - main:164 - 目标周: 本周
2026-02-24 16:09:20 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 16:09:20 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 16:09:20 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 16:09:20 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 16:09:20 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 16:09:20 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 16:09:20 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 16:09:20 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 16:09:20 - weekly_report - INFO - fetch_all_sections:233 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 16:09:20 - weekly_report - INFO - fetch_section_data:199 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 16:09:20 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:09:20 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:09:27 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 22 行数据
2026-02-24 16:09:27 - weekly_report - INFO - fetch_section_data:199 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 16:09:27 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:09:27 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:09:27 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 0 行数据
2026-02-24 16:09:27 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 16:09:27 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:09:27 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:09:29 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 29 行数据
2026-02-24 16:09:29 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 16:09:29 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:09:29 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:09:30 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 26 行数据
2026-02-24 16:09:30 - weekly_report - INFO - fetch_section_data:199 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 16:09:30 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:09:30 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:09:31 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 30 行数据
2026-02-24 16:09:31 - weekly_report - INFO - fetch_section_data:199 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 16:09:31 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:09:31 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:09:32 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 16:09:32 - weekly_report - INFO - fetch_all_sections:250 - ✅ 数据获取完成
2026-02-24 16:09:32 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 16:09:32 - weekly_report - INFO - main:217 - ✅ 成功获取 4 个部分的数据
2026-02-24 16:09:32 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 16:09:32 - weekly_report - INFO - fetch_all_sections:233 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 16:09:32 - weekly_report - INFO - fetch_section_data:199 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 16:09:32 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:09:32 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:09:33 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 22 行数据
2026-02-24 16:09:33 - weekly_report - INFO - fetch_section_data:199 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 16:09:33 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:09:33 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:09:33 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 0 行数据
2026-02-24 16:09:33 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 16:09:33 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:09:33 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:09:34 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 29 行数据
2026-02-24 16:09:34 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 16:09:34 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:09:34 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:09:37 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 26 行数据
2026-02-24 16:09:37 - weekly_report - INFO - fetch_section_data:199 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 16:09:37 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:09:37 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:09:38 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 30 行数据
2026-02-24 16:09:38 - weekly_report - INFO - fetch_section_data:199 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 16:09:38 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:09:38 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:09:38 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 16:09:38 - weekly_report - INFO - fetch_all_sections:250 - ✅ 数据获取完成
2026-02-24 16:09:38 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 16:09:38 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 16:09:38 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 16:09:38 - weekly_report - INFO - analyze_all_sections:153 - 开始分析所有部分...
2026-02-24 16:09:38 - weekly_report - INFO - analyze_traffic_data:82 - 分析流量数据...
2026-02-24 16:09:38 - weekly_report - INFO - analyze_traffic_data:100 - ✅ 流量数据分析完成: 总新访客 0 人，N/A N/A
2026-02-24 16:09:38 - weekly_report - INFO - analyze_all_sections:173 - ✅ 所有部分分析完成
2026-02-24 16:09:38 - weekly_report - INFO - main:235 - 流量: 总新访客 0 人，N/A N/A
2026-02-24 16:09:38 - weekly_report - INFO - main:240 - 
============================================================
2026-02-24 16:09:38 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-24 16:09:38 - weekly_report - INFO - main:242 - ============================================================
2026-02-24 16:09:38 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 16:09:38 - weekly_report - INFO - generate_full_report:591 - 生成完整报告HTML...
2026-02-24 16:09:38 - weekly_report - INFO - generate_full_report:615 - ✅ 完整报告HTML生成完成
2026-02-24 16:09:38 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-24 16:09:38 - weekly_report - INFO - main:258 - 
============================================================
2026-02-24 16:09:38 - weekly_report - INFO - main:259 - 第四阶段：保存报告到文件
2026-02-24 16:09:38 - weekly_report - INFO - main:260 - ============================================================
2026-02-24 16:09:38 - weekly_report - INFO - save_html_to_file:203 - ✅ HTML已保存到: confluence_report_2026-02-28.html
2026-02-24 16:09:38 - weekly_report - INFO - main:267 - 
============================================================
2026-02-24 16:09:38 - weekly_report - INFO - main:268 - ✅ 报告已保存到本地文件！
2026-02-24 16:09:38 - weekly_report - INFO - main:269 - ============================================================
2026-02-24 16:09:38 - weekly_report - INFO - main:270 - 文件路径: output/confluence_report_2026-02-28.html
2026-02-24 16:09:38 - weekly_report - INFO - main:271 - 报告日期: 2026-02-28
2026-02-24 16:10:47 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 16:10:47 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 16:10:47 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 16:10:47 - weekly_report - INFO - main:164 - 目标周: 本周
2026-02-24 16:10:47 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 16:10:47 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 16:10:47 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 16:10:47 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 16:10:47 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 16:10:47 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 16:10:47 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 16:10:47 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 16:10:47 - weekly_report - INFO - fetch_all_sections:233 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 16:10:47 - weekly_report - INFO - fetch_section_data:199 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 16:10:47 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:10:47 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:10:47 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 22 行数据
2026-02-24 16:10:47 - weekly_report - INFO - fetch_section_data:199 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 16:10:47 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:10:47 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:10:48 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 0 行数据
2026-02-24 16:10:48 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 16:10:48 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:10:48 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:10:49 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 29 行数据
2026-02-24 16:10:49 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 16:10:49 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:10:49 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:10:50 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 26 行数据
2026-02-24 16:10:50 - weekly_report - INFO - fetch_section_data:199 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 16:10:50 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:10:50 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:10:50 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 30 行数据
2026-02-24 16:10:50 - weekly_report - INFO - fetch_section_data:199 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 16:10:50 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:10:50 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:10:51 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 16:10:51 - weekly_report - INFO - fetch_all_sections:250 - ✅ 数据获取完成
2026-02-24 16:10:51 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 16:10:51 - weekly_report - INFO - main:217 - ✅ 成功获取 4 个部分的数据
2026-02-24 16:10:51 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 16:10:51 - weekly_report - INFO - fetch_all_sections:233 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 16:10:51 - weekly_report - INFO - fetch_section_data:199 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 16:10:51 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:10:51 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:10:52 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 22 行数据
2026-02-24 16:10:52 - weekly_report - INFO - fetch_section_data:199 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 16:10:52 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:10:52 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:10:53 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 0 行数据
2026-02-24 16:10:53 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 16:10:53 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:10:53 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:11:02 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 29 行数据
2026-02-24 16:11:02 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 16:11:02 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:11:02 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:11:05 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 26 行数据
2026-02-24 16:11:05 - weekly_report - INFO - fetch_section_data:199 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 16:11:05 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:11:05 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:11:07 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 30 行数据
2026-02-24 16:11:07 - weekly_report - INFO - fetch_section_data:199 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 16:11:07 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:11:07 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:11:08 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 16:11:08 - weekly_report - INFO - fetch_all_sections:250 - ✅ 数据获取完成
2026-02-24 16:11:08 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 16:11:08 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 16:11:08 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 16:11:08 - weekly_report - INFO - analyze_all_sections:153 - 开始分析所有部分...
2026-02-24 16:11:08 - weekly_report - INFO - analyze_traffic_data:82 - 分析流量数据...
2026-02-24 16:11:08 - weekly_report - INFO - analyze_traffic_data:100 - ✅ 流量数据分析完成: 总新访客 149,683 人，- +0.0%
2026-02-24 16:11:08 - weekly_report - INFO - analyze_all_sections:173 - ✅ 所有部分分析完成
2026-02-24 16:11:08 - weekly_report - INFO - main:235 - 流量: 总新访客 149,683 人，- +0.0%
2026-02-24 16:11:08 - weekly_report - INFO - main:240 - 
============================================================
2026-02-24 16:11:08 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-24 16:11:08 - weekly_report - INFO - main:242 - ============================================================
2026-02-24 16:11:08 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 16:11:08 - weekly_report - INFO - generate_full_report:591 - 生成完整报告HTML...
2026-02-24 16:11:08 - weekly_report - INFO - generate_full_report:615 - ✅ 完整报告HTML生成完成
2026-02-24 16:11:08 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-24 16:11:08 - weekly_report - INFO - main:258 - 
============================================================
2026-02-24 16:11:08 - weekly_report - INFO - main:259 - 第四阶段：保存报告到文件
2026-02-24 16:11:08 - weekly_report - INFO - main:260 - ============================================================
2026-02-24 16:11:08 - weekly_report - INFO - save_html_to_file:203 - ✅ HTML已保存到: confluence_report_2026-02-28.html
2026-02-24 16:11:08 - weekly_report - INFO - main:267 - 
============================================================
2026-02-24 16:11:08 - weekly_report - INFO - main:268 - ✅ 报告已保存到本地文件！
2026-02-24 16:11:08 - weekly_report - INFO - main:269 - ============================================================
2026-02-24 16:11:08 - weekly_report - INFO - main:270 - 文件路径: output/confluence_report_2026-02-28.html
2026-02-24 16:11:08 - weekly_report - INFO - main:271 - 报告日期: 2026-02-28
2026-02-24 16:11:58 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 16:11:58 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 16:11:58 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 16:11:58 - weekly_report - INFO - main:164 - 目标周: 本周
2026-02-24 16:11:58 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 16:11:58 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 16:11:58 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 16:11:58 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 16:11:58 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 16:11:58 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 16:11:58 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 16:11:58 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 16:11:58 - weekly_report - INFO - fetch_all_sections:233 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 16:11:58 - weekly_report - INFO - fetch_section_data:199 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 16:11:58 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:11:58 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:11:58 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 22 行数据
2026-02-24 16:11:58 - weekly_report - INFO - fetch_section_data:199 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 16:11:58 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:11:58 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:11:59 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 0 行数据
2026-02-24 16:11:59 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 16:11:59 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:11:59 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:12:00 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 29 行数据
2026-02-24 16:12:00 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 16:12:00 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:12:00 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:12:01 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 26 行数据
2026-02-24 16:12:01 - weekly_report - INFO - fetch_section_data:199 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 16:12:01 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:12:01 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:12:02 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 30 行数据
2026-02-24 16:12:02 - weekly_report - INFO - fetch_section_data:199 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 16:12:02 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:12:02 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:12:02 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 16:12:02 - weekly_report - INFO - fetch_all_sections:250 - ✅ 数据获取完成
2026-02-24 16:12:02 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 16:12:02 - weekly_report - INFO - main:217 - ✅ 成功获取 4 个部分的数据
2026-02-24 16:12:02 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 16:12:02 - weekly_report - INFO - fetch_all_sections:233 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 16:12:02 - weekly_report - INFO - fetch_section_data:199 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 16:12:02 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:12:02 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:12:03 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 22 行数据
2026-02-24 16:12:03 - weekly_report - INFO - fetch_section_data:199 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 16:12:03 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:12:03 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:12:03 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 0 行数据
2026-02-24 16:12:03 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 16:12:03 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:12:03 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:12:06 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 29 行数据
2026-02-24 16:12:06 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 16:12:06 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:12:06 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:12:07 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 26 行数据
2026-02-24 16:12:07 - weekly_report - INFO - fetch_section_data:199 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 16:12:08 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:12:08 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:12:08 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 30 行数据
2026-02-24 16:12:08 - weekly_report - INFO - fetch_section_data:199 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 16:12:08 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:12:08 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:12:09 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 16:12:09 - weekly_report - INFO - fetch_all_sections:250 - ✅ 数据获取完成
2026-02-24 16:12:09 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 16:12:09 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 16:12:09 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 16:12:09 - weekly_report - INFO - analyze_all_sections:166 - 开始分析所有部分...
2026-02-24 16:12:09 - weekly_report - INFO - analyze_traffic_data:82 - 分析流量数据...
2026-02-24 16:12:09 - weekly_report - INFO - analyze_traffic_data:113 - ✅ 流量数据分析完成: 总新访客 149,683 人，- +0.0%
2026-02-24 16:12:09 - weekly_report - INFO - analyze_all_sections:186 - ✅ 所有部分分析完成
2026-02-24 16:12:09 - weekly_report - INFO - main:235 - 流量: 总新访客 149,683 人，- +0.0%
2026-02-24 16:12:09 - weekly_report - INFO - main:240 - 
============================================================
2026-02-24 16:12:09 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-24 16:12:09 - weekly_report - INFO - main:242 - ============================================================
2026-02-24 16:12:09 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 16:12:09 - weekly_report - INFO - generate_full_report:591 - 生成完整报告HTML...
2026-02-24 16:12:09 - weekly_report - INFO - generate_full_report:615 - ✅ 完整报告HTML生成完成
2026-02-24 16:12:09 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-24 16:12:09 - weekly_report - INFO - main:258 - 
============================================================
2026-02-24 16:12:09 - weekly_report - INFO - main:259 - 第四阶段：保存报告到文件
2026-02-24 16:12:09 - weekly_report - INFO - main:260 - ============================================================
2026-02-24 16:12:09 - weekly_report - INFO - save_html_to_file:203 - ✅ HTML已保存到: confluence_report_2026-02-28.html
2026-02-24 16:12:09 - weekly_report - INFO - main:267 - 
============================================================
2026-02-24 16:12:09 - weekly_report - INFO - main:268 - ✅ 报告已保存到本地文件！
2026-02-24 16:12:09 - weekly_report - INFO - main:269 - ============================================================
2026-02-24 16:12:09 - weekly_report - INFO - main:270 - 文件路径: output/confluence_report_2026-02-28.html
2026-02-24 16:12:09 - weekly_report - INFO - main:271 - 报告日期: 2026-02-28
2026-02-24 16:12:50 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 16:12:50 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 16:12:50 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 16:12:50 - weekly_report - INFO - main:164 - 目标周: 本周
2026-02-24 16:12:50 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 16:12:50 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 16:12:50 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 16:12:50 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 16:12:50 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 16:12:50 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 16:12:50 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 16:12:50 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 16:12:50 - weekly_report - INFO - fetch_all_sections:233 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 16:12:50 - weekly_report - INFO - fetch_section_data:199 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 16:12:50 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:12:50 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:12:50 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 22 行数据
2026-02-24 16:12:50 - weekly_report - INFO - fetch_section_data:199 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 16:12:50 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:12:50 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:12:51 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 0 行数据
2026-02-24 16:12:51 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 16:12:51 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:12:51 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:12:52 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 29 行数据
2026-02-24 16:12:52 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 16:12:52 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:12:52 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:12:53 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 26 行数据
2026-02-24 16:12:53 - weekly_report - INFO - fetch_section_data:199 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 16:12:53 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:12:53 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:12:54 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 30 行数据
2026-02-24 16:12:54 - weekly_report - INFO - fetch_section_data:199 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 16:12:54 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:12:54 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:12:55 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 16:12:55 - weekly_report - INFO - fetch_all_sections:250 - ✅ 数据获取完成
2026-02-24 16:12:55 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 16:12:55 - weekly_report - INFO - main:217 - ✅ 成功获取 4 个部分的数据
2026-02-24 16:12:55 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 16:12:55 - weekly_report - INFO - fetch_all_sections:233 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 16:12:55 - weekly_report - INFO - fetch_section_data:199 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 16:12:55 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:12:55 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:12:55 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 22 行数据
2026-02-24 16:12:55 - weekly_report - INFO - fetch_section_data:199 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 16:12:55 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:12:55 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:12:56 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 0 行数据
2026-02-24 16:12:56 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 16:12:56 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:12:56 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:12:57 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 29 行数据
2026-02-24 16:12:57 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 16:12:57 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:12:57 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:12:57 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 26 行数据
2026-02-24 16:12:57 - weekly_report - INFO - fetch_section_data:199 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 16:12:57 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:12:57 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:12:58 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 30 行数据
2026-02-24 16:12:58 - weekly_report - INFO - fetch_section_data:199 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 16:12:58 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:12:58 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:12:59 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 16:12:59 - weekly_report - INFO - fetch_all_sections:250 - ✅ 数据获取完成
2026-02-24 16:12:59 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 16:12:59 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 16:12:59 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 16:12:59 - weekly_report - INFO - analyze_all_sections:166 - 开始分析所有部分...
2026-02-24 16:12:59 - weekly_report - INFO - analyze_traffic_data:82 - 分析流量数据...
2026-02-24 16:12:59 - weekly_report - INFO - analyze_traffic_data:113 - ✅ 流量数据分析完成: 总新访客 149,683 人，- +0.0%
2026-02-24 16:12:59 - weekly_report - INFO - analyze_all_sections:186 - ✅ 所有部分分析完成
2026-02-24 16:12:59 - weekly_report - INFO - main:235 - 流量: 总新访客 149,683 人，- +0.0%
2026-02-24 16:12:59 - weekly_report - INFO - main:240 - 
============================================================
2026-02-24 16:12:59 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-24 16:12:59 - weekly_report - INFO - main:242 - ============================================================
2026-02-24 16:12:59 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 16:12:59 - weekly_report - INFO - generate_full_report_html:347 - 生成完整HTML报告...
2026-02-24 16:12:59 - weekly_report - INFO - render_traffic_section:78 - 渲染流量部分...
2026-02-24 16:12:59 - weekly_report - INFO - render_traffic_section:106 - ✅ 流量部分渲染完成
2026-02-24 16:12:59 - weekly_report - INFO - render_activation_section:117 - 渲染激活部分...
2026-02-24 16:12:59 - weekly_report - INFO - render_activation_section:167 - ✅ 激活部分渲染完成
2026-02-24 16:12:59 - weekly_report - INFO - render_retention_section:214 - 渲染留存部分...
2026-02-24 16:12:59 - weekly_report - INFO - render_retention_section:240 - ✅ 留存部分渲染完成
2026-02-24 16:12:59 - weekly_report - INFO - generate_revenue_section_html:251 - 生成收入部分HTML...
2026-02-24 16:12:59 - weekly_report - INFO - generate_revenue_section_html:284 - ✅ 收入部分HTML生成完成
2026-02-24 16:12:59 - weekly_report - INFO - generate_full_report_html:418 - ✅ 完整HTML报告生成完成
2026-02-24 16:12:59 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-24 16:12:59 - weekly_report - INFO - main:258 - 
============================================================
2026-02-24 16:12:59 - weekly_report - INFO - main:259 - 第四阶段：保存报告到文件
2026-02-24 16:12:59 - weekly_report - INFO - main:260 - ============================================================
2026-02-24 16:12:59 - weekly_report - INFO - save_html_to_file:203 - ✅ HTML已保存到: confluence_report_2026-02-28.html
2026-02-24 16:12:59 - weekly_report - INFO - main:267 - 
============================================================
2026-02-24 16:12:59 - weekly_report - INFO - main:268 - ✅ 报告已保存到本地文件！
2026-02-24 16:12:59 - weekly_report - INFO - main:269 - ============================================================
2026-02-24 16:12:59 - weekly_report - INFO - main:270 - 文件路径: output/confluence_report_2026-02-28.html
2026-02-24 16:12:59 - weekly_report - INFO - main:271 - 报告日期: 2026-02-28
2026-02-24 16:21:55 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 16:21:55 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 16:21:55 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 16:21:55 - weekly_report - INFO - main:164 - 目标周: 本周
2026-02-24 16:21:55 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 16:21:55 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 16:21:55 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 16:21:55 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 16:21:55 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 16:21:55 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 16:21:55 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 16:21:55 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 16:21:55 - weekly_report - INFO - fetch_all_sections:233 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 16:21:55 - weekly_report - INFO - fetch_section_data:199 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 16:21:55 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:21:55 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:21:55 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 22 行数据
2026-02-24 16:21:55 - weekly_report - INFO - fetch_section_data:199 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 16:21:55 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:21:55 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:21:56 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 0 行数据
2026-02-24 16:21:56 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 16:21:56 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:21:56 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:21:57 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 29 行数据
2026-02-24 16:21:57 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 16:21:57 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:21:57 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:21:58 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 26 行数据
2026-02-24 16:21:58 - weekly_report - INFO - fetch_section_data:199 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 16:21:58 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:21:58 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:21:58 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 30 行数据
2026-02-24 16:21:58 - weekly_report - INFO - fetch_section_data:199 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 16:21:58 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:21:58 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:21:59 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 16:21:59 - weekly_report - INFO - fetch_all_sections:250 - ✅ 数据获取完成
2026-02-24 16:21:59 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 16:21:59 - weekly_report - INFO - main:217 - ✅ 成功获取 4 个部分的数据
2026-02-24 16:21:59 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 16:21:59 - weekly_report - INFO - fetch_all_sections:233 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 16:21:59 - weekly_report - INFO - fetch_section_data:199 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 16:21:59 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:21:59 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:22:00 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 22 行数据
2026-02-24 16:22:00 - weekly_report - INFO - fetch_section_data:199 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 16:22:00 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:22:00 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:22:01 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 0 行数据
2026-02-24 16:22:01 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 16:22:01 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:22:01 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:22:02 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 29 行数据
2026-02-24 16:22:02 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 16:22:02 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:22:02 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:22:03 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 26 行数据
2026-02-24 16:22:03 - weekly_report - INFO - fetch_section_data:199 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 16:22:03 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:22:03 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:22:03 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 30 行数据
2026-02-24 16:22:03 - weekly_report - INFO - fetch_section_data:199 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 16:22:03 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:22:03 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:22:04 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 16:22:04 - weekly_report - INFO - fetch_all_sections:250 - ✅ 数据获取完成
2026-02-24 16:22:04 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 16:22:04 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 16:22:04 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 16:22:04 - weekly_report - INFO - analyze_all_sections:361 - 开始分析所有部分...
2026-02-24 16:22:04 - weekly_report - INFO - analyze_traffic_data:82 - 分析流量数据...
2026-02-24 16:22:04 - weekly_report - INFO - analyze_traffic_data:113 - ✅ 流量数据分析完成: 总新访客 149,683 人，- +0.0%
2026-02-24 16:22:04 - weekly_report - INFO - analyze_engagement_data:244 - 分析参与度数据...
2026-02-24 16:22:04 - weekly_report - INFO - analyze_engagement_data:278 - ✅ 参与度数据分析完成: 工具WAU 1,730,593，- +0.0%
2026-02-24 16:22:04 - weekly_report - INFO - analyze_retention_data:296 - 分析留存数据...
2026-02-24 16:22:04 - weekly_report - INFO - analyze_retention_data:343 - ✅ 留存数据分析完成: 新用户留存率 5.0%，老用户留存率 22.3%
2026-02-24 16:22:04 - weekly_report - INFO - analyze_all_sections:400 - ✅ 所有部分分析完成
2026-02-24 16:22:04 - weekly_report - INFO - main:235 - 流量: 总新访客 149,683 人，- +0.0%
2026-02-24 16:22:04 - weekly_report - INFO - main:240 - 
============================================================
2026-02-24 16:22:04 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-24 16:22:04 - weekly_report - INFO - main:242 - ============================================================
2026-02-24 16:22:04 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 16:22:04 - weekly_report - INFO - generate_full_report_html:347 - 生成完整HTML报告...
2026-02-24 16:22:04 - weekly_report - INFO - render_traffic_section:78 - 渲染流量部分...
2026-02-24 16:22:04 - weekly_report - INFO - render_traffic_section:106 - ✅ 流量部分渲染完成
2026-02-24 16:22:04 - weekly_report - INFO - render_activation_section:117 - 渲染激活部分...
2026-02-24 16:22:04 - weekly_report - INFO - render_activation_section:167 - ✅ 激活部分渲染完成
2026-02-24 16:22:04 - weekly_report - INFO - render_retention_section:214 - 渲染留存部分...
2026-02-24 16:22:04 - weekly_report - INFO - render_retention_section:240 - ✅ 留存部分渲染完成
2026-02-24 16:22:04 - weekly_report - INFO - generate_revenue_section_html:251 - 生成收入部分HTML...
2026-02-24 16:22:04 - weekly_report - INFO - generate_revenue_section_html:284 - ✅ 收入部分HTML生成完成
2026-02-24 16:22:04 - weekly_report - INFO - generate_full_report_html:418 - ✅ 完整HTML报告生成完成
2026-02-24 16:22:04 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-24 16:22:04 - weekly_report - INFO - main:258 - 
============================================================
2026-02-24 16:22:04 - weekly_report - INFO - main:259 - 第四阶段：保存报告到文件
2026-02-24 16:22:04 - weekly_report - INFO - main:260 - ============================================================
2026-02-24 16:22:04 - weekly_report - INFO - save_html_to_file:203 - ✅ HTML已保存到: confluence_report_2026-02-28.html
2026-02-24 16:22:04 - weekly_report - INFO - main:267 - 
============================================================
2026-02-24 16:22:04 - weekly_report - INFO - main:268 - ✅ 报告已保存到本地文件！
2026-02-24 16:22:04 - weekly_report - INFO - main:269 - ============================================================
2026-02-24 16:22:04 - weekly_report - INFO - main:270 - 文件路径: output/confluence_report_2026-02-28.html
2026-02-24 16:22:04 - weekly_report - INFO - main:271 - 报告日期: 2026-02-28
2026-02-24 16:22:44 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 16:22:44 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 16:22:44 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 16:22:44 - weekly_report - INFO - main:164 - 目标周: 本周
2026-02-24 16:22:44 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 16:22:44 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 16:22:44 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 16:22:44 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 16:22:44 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 16:22:44 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 16:22:44 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 16:22:44 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 16:22:44 - weekly_report - INFO - fetch_all_sections:233 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 16:22:44 - weekly_report - INFO - fetch_section_data:199 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 16:22:44 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:22:44 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:22:46 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 22 行数据
2026-02-24 16:22:46 - weekly_report - INFO - fetch_section_data:199 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 16:22:46 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:22:46 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:22:46 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 0 行数据
2026-02-24 16:22:46 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 16:22:46 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:22:46 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:22:49 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 29 行数据
2026-02-24 16:22:49 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 16:22:49 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:22:49 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:22:50 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 26 行数据
2026-02-24 16:22:50 - weekly_report - INFO - fetch_section_data:199 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 16:22:50 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:22:50 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:22:51 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 30 行数据
2026-02-24 16:22:51 - weekly_report - INFO - fetch_section_data:199 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 16:22:51 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:22:51 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:22:52 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 16:22:52 - weekly_report - INFO - fetch_all_sections:250 - ✅ 数据获取完成
2026-02-24 16:22:52 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 16:22:52 - weekly_report - INFO - main:217 - ✅ 成功获取 4 个部分的数据
2026-02-24 16:22:52 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 16:22:52 - weekly_report - INFO - fetch_all_sections:233 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 16:22:52 - weekly_report - INFO - fetch_section_data:199 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 16:22:52 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:22:52 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:22:52 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 22 行数据
2026-02-24 16:22:52 - weekly_report - INFO - fetch_section_data:199 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 16:22:52 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:22:52 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:22:53 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 0 行数据
2026-02-24 16:22:53 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 16:22:53 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:22:53 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:22:54 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 29 行数据
2026-02-24 16:22:54 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 16:22:54 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:22:54 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:22:55 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 26 行数据
2026-02-24 16:22:55 - weekly_report - INFO - fetch_section_data:199 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 16:22:55 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:22:55 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:22:56 - weekly_report - INFO - _execute_via_api:145 - ✅ 查询成功，返回 30 行数据
2026-02-24 16:22:56 - weekly_report - INFO - fetch_section_data:199 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 16:22:56 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 16:22:56 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 16:22:56 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 16:22:56 - weekly_report - INFO - fetch_all_sections:250 - ✅ 数据获取完成
2026-02-24 16:22:56 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 16:22:56 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 16:22:56 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 16:22:56 - weekly_report - INFO - analyze_all_sections:361 - 开始分析所有部分...
2026-02-24 16:22:56 - weekly_report - INFO - analyze_traffic_data:82 - 分析流量数据...
2026-02-24 16:22:56 - weekly_report - INFO - analyze_traffic_data:113 - ✅ 流量数据分析完成: 总新访客 149,683 人，- +0.0%
2026-02-24 16:22:56 - weekly_report - INFO - analyze_engagement_data:244 - 分析参与度数据...
2026-02-24 16:22:56 - weekly_report - INFO - analyze_engagement_data:278 - ✅ 参与度数据分析完成: 工具WAU 1,730,593，- +0.0%
2026-02-24 16:22:56 - weekly_report - INFO - analyze_retention_data:296 - 分析留存数据...
2026-02-24 16:22:56 - weekly_report - INFO - analyze_retention_data:343 - ✅ 留存数据分析完成: 新用户留存率 5.0%，老用户留存率 22.3%
2026-02-24 16:22:56 - weekly_report - INFO - analyze_all_sections:400 - ✅ 所有部分分析完成
2026-02-24 16:22:56 - weekly_report - INFO - main:235 - 流量: 总新访客 149,683 人，- +0.0%
2026-02-24 16:22:56 - weekly_report - INFO - main:240 - 
============================================================
2026-02-24 16:22:56 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-24 16:22:56 - weekly_report - INFO - main:242 - ============================================================
2026-02-24 16:22:56 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 16:22:56 - weekly_report - INFO - generate_full_report_html:347 - 生成完整HTML报告...
2026-02-24 16:22:56 - weekly_report - INFO - render_traffic_section:78 - 渲染流量部分...
2026-02-24 16:22:56 - weekly_report - INFO - render_traffic_section:106 - ✅ 流量部分渲染完成
2026-02-24 16:22:56 - weekly_report - INFO - render_activation_section:117 - 渲染激活部分...
2026-02-24 16:22:56 - weekly_report - INFO - render_activation_section:167 - ✅ 激活部分渲染完成
2026-02-24 16:22:56 - weekly_report - INFO - render_retention_section:214 - 渲染留存部分...
2026-02-24 16:22:56 - weekly_report - INFO - render_retention_section:240 - ✅ 留存部分渲染完成
2026-02-24 16:22:56 - weekly_report - INFO - generate_revenue_section_html:251 - 生成收入部分HTML...
2026-02-24 16:22:56 - weekly_report - INFO - generate_revenue_section_html:284 - ✅ 收入部分HTML生成完成
2026-02-24 16:22:56 - weekly_report - INFO - generate_full_report_html:418 - ✅ 完整HTML报告生成完成
2026-02-24 16:22:56 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-24 16:22:56 - weekly_report - INFO - main:258 - 
============================================================
2026-02-24 16:22:56 - weekly_report - INFO - main:259 - 第四阶段：保存报告到文件
2026-02-24 16:22:56 - weekly_report - INFO - main:260 - ============================================================
2026-02-24 16:22:56 - weekly_report - INFO - save_html_to_file:203 - ✅ HTML已保存到: confluence_report_2026-02-28.html
2026-02-24 16:22:56 - weekly_report - INFO - main:267 - 
============================================================
2026-02-24 16:22:56 - weekly_report - INFO - main:268 - ✅ 报告已保存到本地文件！
2026-02-24 16:22:56 - weekly_report - INFO - main:269 - ============================================================
2026-02-24 16:22:56 - weekly_report - INFO - main:270 - 文件路径: output/confluence_report_2026-02-28.html
2026-02-24 16:22:56 - weekly_report - INFO - main:271 - 报告日期: 2026-02-28
2026-02-24 18:31:50 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 18:31:50 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 18:31:50 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 18:31:50 - weekly_report - INFO - main:164 - 目标周: 本周
2026-02-24 18:31:50 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 18:31:50 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 18:31:50 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 18:31:52 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 18:31:52 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 18:31:52 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 18:31:52 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 18:31:52 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 18:31:52 - weekly_report - INFO - fetch_all_sections:233 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 18:31:52 - weekly_report - INFO - fetch_section_data:199 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 18:31:52 - weekly_report - ERROR - fetch_section_data:211 - ❌ 获取 traffic 数据失败: SQL文件不存在: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql/01_traffic.sql
2026-02-24 18:31:52 - weekly_report - INFO - fetch_section_data:199 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 18:31:52 - weekly_report - ERROR - fetch_section_data:211 - ❌ 获取 activation 数据失败: SQL文件不存在: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql/02_activation.sql
2026-02-24 18:31:52 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 18:31:52 - weekly_report - ERROR - fetch_section_data:211 - ❌ 获取 engagement_all_users 数据失败: SQL文件不存在: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql/03_engagement_all_users.sql
2026-02-24 18:31:52 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 18:31:52 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:31:52 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:31:53 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:31:53 - weekly_report - INFO - fetch_section_data:199 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 18:31:53 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:31:53 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:31:53 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:31:53 - weekly_report - INFO - fetch_section_data:199 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 18:31:53 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:31:53 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:31:54 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:31:54 - weekly_report - INFO - fetch_all_sections:250 - ✅ 数据获取完成
2026-02-24 18:31:54 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 18:31:54 - weekly_report - WARNING - main:219 - ⚠️  6 个部分无数据
2026-02-24 18:31:54 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 18:31:54 - weekly_report - INFO - fetch_all_sections:233 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 18:31:54 - weekly_report - INFO - fetch_section_data:199 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 18:31:54 - weekly_report - ERROR - fetch_section_data:211 - ❌ 获取 traffic 数据失败: SQL文件不存在: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql/01_traffic.sql
2026-02-24 18:31:54 - weekly_report - INFO - fetch_section_data:199 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 18:31:54 - weekly_report - ERROR - fetch_section_data:211 - ❌ 获取 activation 数据失败: SQL文件不存在: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql/02_activation.sql
2026-02-24 18:31:54 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 18:31:54 - weekly_report - ERROR - fetch_section_data:211 - ❌ 获取 engagement_all_users 数据失败: SQL文件不存在: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql/03_engagement_all_users.sql
2026-02-24 18:31:54 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 18:31:54 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:31:54 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:31:54 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:31:54 - weekly_report - INFO - fetch_section_data:199 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 18:31:54 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:31:54 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:31:55 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:31:55 - weekly_report - INFO - fetch_section_data:199 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 18:31:55 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:31:55 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:31:55 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:31:55 - weekly_report - INFO - fetch_all_sections:250 - ✅ 数据获取完成
2026-02-24 18:31:55 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 18:31:55 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 18:31:55 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 18:31:55 - weekly_report - INFO - analyze_all_sections:361 - 开始分析所有部分...
2026-02-24 18:31:55 - weekly_report - INFO - analyze_all_sections:400 - ✅ 所有部分分析完成
2026-02-24 18:31:55 - weekly_report - INFO - main:240 - 
============================================================
2026-02-24 18:31:55 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-24 18:31:55 - weekly_report - INFO - main:242 - ============================================================
2026-02-24 18:31:55 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 18:31:55 - weekly_report - INFO - generate_full_report_html:347 - 生成完整HTML报告...
2026-02-24 18:31:55 - weekly_report - INFO - render_traffic_section:78 - 渲染流量部分...
2026-02-24 18:31:55 - weekly_report - INFO - render_traffic_section:106 - ✅ 流量部分渲染完成
2026-02-24 18:31:55 - weekly_report - INFO - render_activation_section:117 - 渲染激活部分...
2026-02-24 18:31:55 - weekly_report - INFO - render_activation_section:167 - ✅ 激活部分渲染完成
2026-02-24 18:31:55 - weekly_report - INFO - render_retention_section:214 - 渲染留存部分...
2026-02-24 18:31:55 - weekly_report - INFO - render_retention_section:240 - ✅ 留存部分渲染完成
2026-02-24 18:31:55 - weekly_report - INFO - generate_revenue_section_html:251 - 生成收入部分HTML...
2026-02-24 18:31:55 - weekly_report - INFO - generate_revenue_section_html:284 - ✅ 收入部分HTML生成完成
2026-02-24 18:31:55 - weekly_report - INFO - generate_full_report_html:418 - ✅ 完整HTML报告生成完成
2026-02-24 18:31:55 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-24 18:31:55 - weekly_report - INFO - main:277 - 
============================================================
2026-02-24 18:31:55 - weekly_report - INFO - main:278 - 第四阶段：更新Confluence
2026-02-24 18:31:55 - weekly_report - INFO - main:279 - ============================================================
2026-02-24 18:31:55 - weekly_report - INFO - update_page:115 - 更新Confluence页面...
2026-02-24 18:31:55 - weekly_report - INFO - get_current_page:71 - 获取Confluence页面 (Page ID: 81397518314)...
2026-02-24 18:31:56 - weekly_report - ERROR - get_current_page:94 - ❌ 获取页面网络异常: Expecting value: line 1 column 1 (char 0)
2026-02-24 18:31:56 - weekly_report - ERROR - update_page:124 - ❌ 无法获取当前页面信息
2026-02-24 18:31:56 - weekly_report - ERROR - main:294 - 
============================================================
2026-02-24 18:31:56 - weekly_report - ERROR - main:295 - ❌ 周报更新失败
2026-02-24 18:34:21 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 18:34:21 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 18:34:21 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 18:34:21 - weekly_report - INFO - main:164 - 目标周: 本周
2026-02-24 18:34:21 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 18:34:21 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 18:34:21 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 18:34:23 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 18:34:23 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 18:34:23 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 18:34:23 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 18:34:23 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 18:34:23 - weekly_report - INFO - fetch_all_sections:233 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 18:34:23 - weekly_report - INFO - fetch_section_data:199 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 18:34:23 - weekly_report - ERROR - fetch_section_data:211 - ❌ 获取 traffic 数据失败: SQL文件不存在: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql/01_traffic.sql
2026-02-24 18:34:23 - weekly_report - INFO - fetch_section_data:199 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 18:34:23 - weekly_report - ERROR - fetch_section_data:211 - ❌ 获取 activation 数据失败: SQL文件不存在: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql/02_activation.sql
2026-02-24 18:34:23 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 18:34:23 - weekly_report - ERROR - fetch_section_data:211 - ❌ 获取 engagement_all_users 数据失败: SQL文件不存在: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql/03_engagement_all_users.sql
2026-02-24 18:34:23 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 18:34:23 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:34:23 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:34:24 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:34:24 - weekly_report - INFO - fetch_section_data:199 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 18:34:24 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:34:24 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:34:24 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:34:24 - weekly_report - INFO - fetch_section_data:199 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 18:34:24 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:34:24 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:34:25 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:34:25 - weekly_report - INFO - fetch_all_sections:250 - ✅ 数据获取完成
2026-02-24 18:34:25 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 18:34:25 - weekly_report - WARNING - main:219 - ⚠️  6 个部分无数据
2026-02-24 18:34:25 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 18:34:25 - weekly_report - INFO - fetch_all_sections:233 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 18:34:25 - weekly_report - INFO - fetch_section_data:199 - 处理 traffic 部分，SQL文件: 01_traffic.sql
2026-02-24 18:34:25 - weekly_report - ERROR - fetch_section_data:211 - ❌ 获取 traffic 数据失败: SQL文件不存在: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql/01_traffic.sql
2026-02-24 18:34:25 - weekly_report - INFO - fetch_section_data:199 - 处理 activation 部分，SQL文件: 02_activation.sql
2026-02-24 18:34:25 - weekly_report - ERROR - fetch_section_data:211 - ❌ 获取 activation 数据失败: SQL文件不存在: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql/02_activation.sql
2026-02-24 18:34:25 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_all_users 部分，SQL文件: 03_engagement_all_users.sql
2026-02-24 18:34:25 - weekly_report - ERROR - fetch_section_data:211 - ❌ 获取 engagement_all_users 数据失败: SQL文件不存在: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql/03_engagement_all_users.sql
2026-02-24 18:34:25 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 18:34:25 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:34:25 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:34:25 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:34:25 - weekly_report - INFO - fetch_section_data:199 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 18:34:25 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:34:25 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:34:25 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:34:25 - weekly_report - INFO - fetch_section_data:199 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 18:34:25 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:34:25 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:34:26 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:34:26 - weekly_report - INFO - fetch_all_sections:250 - ✅ 数据获取完成
2026-02-24 18:34:26 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 18:34:26 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 18:34:26 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 18:34:26 - weekly_report - INFO - analyze_all_sections:361 - 开始分析所有部分...
2026-02-24 18:34:26 - weekly_report - INFO - analyze_all_sections:400 - ✅ 所有部分分析完成
2026-02-24 18:34:26 - weekly_report - INFO - main:240 - 
============================================================
2026-02-24 18:34:26 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-24 18:34:26 - weekly_report - INFO - main:242 - ============================================================
2026-02-24 18:34:26 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 18:34:26 - weekly_report - INFO - generate_full_report_html:347 - 生成完整HTML报告...
2026-02-24 18:34:26 - weekly_report - INFO - render_traffic_section:78 - 渲染流量部分...
2026-02-24 18:34:26 - weekly_report - INFO - render_traffic_section:106 - ✅ 流量部分渲染完成
2026-02-24 18:34:26 - weekly_report - INFO - render_activation_section:117 - 渲染激活部分...
2026-02-24 18:34:26 - weekly_report - INFO - render_activation_section:167 - ✅ 激活部分渲染完成
2026-02-24 18:34:26 - weekly_report - INFO - render_retention_section:214 - 渲染留存部分...
2026-02-24 18:34:26 - weekly_report - INFO - render_retention_section:240 - ✅ 留存部分渲染完成
2026-02-24 18:34:26 - weekly_report - INFO - generate_revenue_section_html:251 - 生成收入部分HTML...
2026-02-24 18:34:26 - weekly_report - INFO - generate_revenue_section_html:284 - ✅ 收入部分HTML生成完成
2026-02-24 18:34:26 - weekly_report - INFO - generate_full_report_html:418 - ✅ 完整HTML报告生成完成
2026-02-24 18:34:26 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-24 18:34:26 - weekly_report - INFO - main:277 - 
============================================================
2026-02-24 18:34:26 - weekly_report - INFO - main:278 - 第四阶段：更新Confluence
2026-02-24 18:34:26 - weekly_report - INFO - main:279 - ============================================================
2026-02-24 18:34:26 - weekly_report - INFO - update_page:115 - 更新Confluence页面...
2026-02-24 18:34:26 - weekly_report - INFO - get_current_page:71 - 获取Confluence页面 (Page ID: 81397518314)...
2026-02-24 18:34:27 - weekly_report - ERROR - get_current_page:94 - ❌ 获取页面网络异常: Expecting value: line 1 column 1 (char 0)
2026-02-24 18:34:27 - weekly_report - ERROR - update_page:124 - ❌ 无法获取当前页面信息
2026-02-24 18:34:27 - weekly_report - ERROR - main:294 - 
============================================================
2026-02-24 18:34:27 - weekly_report - ERROR - main:295 - ❌ 周报更新失败
2026-02-24 18:35:39 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 18:35:39 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 18:35:39 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 18:35:39 - weekly_report - INFO - main:164 - 目标周: 本周
2026-02-24 18:35:39 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 18:35:39 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 18:35:39 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 18:35:41 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 18:35:41 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 18:35:41 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 18:35:41 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 18:35:41 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 18:35:41 - weekly_report - INFO - fetch_all_sections:233 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 18:35:41 - weekly_report - INFO - fetch_section_data:199 - 处理 traffic 部分，SQL文件: sql/01_traffic_weekly.sql
2026-02-24 18:35:41 - weekly_report - ERROR - fetch_section_data:211 - ❌ 获取 traffic 数据失败: SQL文件不存在: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql/sql/01_traffic_weekly.sql
2026-02-24 18:35:41 - weekly_report - INFO - fetch_section_data:199 - 处理 activation 部分，SQL文件: sql/02_activation_ready.sql
2026-02-24 18:35:41 - weekly_report - ERROR - fetch_section_data:211 - ❌ 获取 activation 数据失败: SQL文件不存在: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql/sql/02_activation_ready.sql
2026-02-24 18:35:41 - weekly_report - ERROR - fetch_section_data:195 - ❌ 未知的section: engagement_all_users
2026-02-24 18:35:41 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_new_old_users 部分，SQL文件: sql/03_engagement_new_old_users.sql
2026-02-24 18:35:41 - weekly_report - ERROR - fetch_section_data:211 - ❌ 获取 engagement_new_old_users 数据失败: SQL文件不存在: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql/sql/03_engagement_new_old_users.sql
2026-02-24 18:35:41 - weekly_report - INFO - fetch_section_data:199 - 处理 retention 部分，SQL文件: sql/04_retention.sql
2026-02-24 18:35:41 - weekly_report - ERROR - fetch_section_data:211 - ❌ 获取 retention 数据失败: SQL文件不存在: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql/sql/04_retention.sql
2026-02-24 18:35:41 - weekly_report - INFO - fetch_section_data:199 - 处理 revenue 部分，SQL文件: sql/05_revenue.sql
2026-02-24 18:35:41 - weekly_report - ERROR - fetch_section_data:211 - ❌ 获取 revenue 数据失败: SQL文件不存在: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql/sql/05_revenue.sql
2026-02-24 18:35:41 - weekly_report - INFO - fetch_all_sections:250 - ✅ 数据获取完成
2026-02-24 18:35:41 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 18:35:41 - weekly_report - WARNING - main:219 - ⚠️  6 个部分无数据
2026-02-24 18:35:41 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 18:35:41 - weekly_report - INFO - fetch_all_sections:233 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 18:35:41 - weekly_report - INFO - fetch_section_data:199 - 处理 traffic 部分，SQL文件: sql/01_traffic_weekly.sql
2026-02-24 18:35:41 - weekly_report - ERROR - fetch_section_data:211 - ❌ 获取 traffic 数据失败: SQL文件不存在: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql/sql/01_traffic_weekly.sql
2026-02-24 18:35:41 - weekly_report - INFO - fetch_section_data:199 - 处理 activation 部分，SQL文件: sql/02_activation_ready.sql
2026-02-24 18:35:41 - weekly_report - ERROR - fetch_section_data:211 - ❌ 获取 activation 数据失败: SQL文件不存在: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql/sql/02_activation_ready.sql
2026-02-24 18:35:41 - weekly_report - ERROR - fetch_section_data:195 - ❌ 未知的section: engagement_all_users
2026-02-24 18:35:41 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_new_old_users 部分，SQL文件: sql/03_engagement_new_old_users.sql
2026-02-24 18:35:41 - weekly_report - ERROR - fetch_section_data:211 - ❌ 获取 engagement_new_old_users 数据失败: SQL文件不存在: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql/sql/03_engagement_new_old_users.sql
2026-02-24 18:35:41 - weekly_report - INFO - fetch_section_data:199 - 处理 retention 部分，SQL文件: sql/04_retention.sql
2026-02-24 18:35:41 - weekly_report - ERROR - fetch_section_data:211 - ❌ 获取 retention 数据失败: SQL文件不存在: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql/sql/04_retention.sql
2026-02-24 18:35:41 - weekly_report - INFO - fetch_section_data:199 - 处理 revenue 部分，SQL文件: sql/05_revenue.sql
2026-02-24 18:35:41 - weekly_report - ERROR - fetch_section_data:211 - ❌ 获取 revenue 数据失败: SQL文件不存在: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql/sql/05_revenue.sql
2026-02-24 18:35:41 - weekly_report - INFO - fetch_all_sections:250 - ✅ 数据获取完成
2026-02-24 18:35:41 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 18:35:41 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 18:35:41 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 18:35:41 - weekly_report - INFO - analyze_all_sections:361 - 开始分析所有部分...
2026-02-24 18:35:41 - weekly_report - INFO - analyze_all_sections:400 - ✅ 所有部分分析完成
2026-02-24 18:35:41 - weekly_report - INFO - main:240 - 
============================================================
2026-02-24 18:35:41 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-24 18:35:41 - weekly_report - INFO - main:242 - ============================================================
2026-02-24 18:35:41 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 18:35:41 - weekly_report - INFO - generate_full_report_html:347 - 生成完整HTML报告...
2026-02-24 18:35:41 - weekly_report - INFO - render_traffic_section:78 - 渲染流量部分...
2026-02-24 18:35:41 - weekly_report - INFO - render_traffic_section:106 - ✅ 流量部分渲染完成
2026-02-24 18:35:41 - weekly_report - INFO - render_activation_section:117 - 渲染激活部分...
2026-02-24 18:35:41 - weekly_report - INFO - render_activation_section:167 - ✅ 激活部分渲染完成
2026-02-24 18:35:41 - weekly_report - INFO - render_retention_section:214 - 渲染留存部分...
2026-02-24 18:35:41 - weekly_report - INFO - render_retention_section:240 - ✅ 留存部分渲染完成
2026-02-24 18:35:41 - weekly_report - INFO - generate_revenue_section_html:251 - 生成收入部分HTML...
2026-02-24 18:35:41 - weekly_report - INFO - generate_revenue_section_html:284 - ✅ 收入部分HTML生成完成
2026-02-24 18:35:41 - weekly_report - INFO - generate_full_report_html:418 - ✅ 完整HTML报告生成完成
2026-02-24 18:35:41 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-24 18:35:41 - weekly_report - INFO - main:277 - 
============================================================
2026-02-24 18:35:41 - weekly_report - INFO - main:278 - 第四阶段：更新Confluence
2026-02-24 18:35:41 - weekly_report - INFO - main:279 - ============================================================
2026-02-24 18:35:41 - weekly_report - INFO - update_page:115 - 更新Confluence页面...
2026-02-24 18:35:41 - weekly_report - INFO - get_current_page:71 - 获取Confluence页面 (Page ID: 81397518314)...
2026-02-24 18:35:42 - weekly_report - ERROR - get_current_page:94 - ❌ 获取页面网络异常: Expecting value: line 1 column 1 (char 0)
2026-02-24 18:35:42 - weekly_report - ERROR - update_page:124 - ❌ 无法获取当前页面信息
2026-02-24 18:35:42 - weekly_report - ERROR - main:294 - 
============================================================
2026-02-24 18:35:42 - weekly_report - ERROR - main:295 - ❌ 周报更新失败
2026-02-24 18:36:35 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 18:36:35 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 18:36:35 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 18:36:35 - weekly_report - INFO - main:164 - 目标周: 本周
2026-02-24 18:36:35 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 18:36:35 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 18:36:35 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 18:36:37 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 18:36:37 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 18:36:37 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 18:36:37 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 18:36:37 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 18:36:37 - weekly_report - INFO - fetch_all_sections:233 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 18:36:37 - weekly_report - INFO - fetch_section_data:199 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-24 18:36:37 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:36:37 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:36:41 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:36:41 - weekly_report - INFO - fetch_section_data:199 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-24 18:36:41 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:36:41 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:36:41 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:36:41 - weekly_report - ERROR - fetch_section_data:195 - ❌ 未知的section: engagement_all_users
2026-02-24 18:36:41 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 18:36:41 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:36:41 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:36:41 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:36:41 - weekly_report - INFO - fetch_section_data:199 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 18:36:41 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:36:41 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:36:42 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:36:42 - weekly_report - INFO - fetch_section_data:199 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 18:36:42 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:36:42 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:36:43 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:36:43 - weekly_report - INFO - fetch_all_sections:250 - ✅ 数据获取完成
2026-02-24 18:36:43 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 18:36:43 - weekly_report - WARNING - main:219 - ⚠️  6 个部分无数据
2026-02-24 18:36:43 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 18:36:43 - weekly_report - INFO - fetch_all_sections:233 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 18:36:43 - weekly_report - INFO - fetch_section_data:199 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-24 18:36:43 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:36:43 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:36:43 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:36:43 - weekly_report - INFO - fetch_section_data:199 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-24 18:36:43 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:36:43 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:36:44 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:36:44 - weekly_report - ERROR - fetch_section_data:195 - ❌ 未知的section: engagement_all_users
2026-02-24 18:36:44 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 18:36:44 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:36:44 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:36:44 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:36:44 - weekly_report - INFO - fetch_section_data:199 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 18:36:44 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:36:44 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:36:55 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:36:55 - weekly_report - INFO - fetch_section_data:199 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 18:36:55 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:36:55 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:36:57 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:36:57 - weekly_report - INFO - fetch_all_sections:250 - ✅ 数据获取完成
2026-02-24 18:36:57 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 18:36:57 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 18:36:57 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 18:36:57 - weekly_report - INFO - analyze_all_sections:361 - 开始分析所有部分...
2026-02-24 18:36:57 - weekly_report - INFO - analyze_all_sections:400 - ✅ 所有部分分析完成
2026-02-24 18:36:57 - weekly_report - INFO - main:240 - 
============================================================
2026-02-24 18:36:57 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-24 18:36:57 - weekly_report - INFO - main:242 - ============================================================
2026-02-24 18:36:57 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 18:36:57 - weekly_report - INFO - generate_full_report_html:347 - 生成完整HTML报告...
2026-02-24 18:36:57 - weekly_report - INFO - render_traffic_section:78 - 渲染流量部分...
2026-02-24 18:36:57 - weekly_report - INFO - render_traffic_section:106 - ✅ 流量部分渲染完成
2026-02-24 18:36:57 - weekly_report - INFO - render_activation_section:117 - 渲染激活部分...
2026-02-24 18:36:57 - weekly_report - INFO - render_activation_section:167 - ✅ 激活部分渲染完成
2026-02-24 18:36:57 - weekly_report - INFO - render_retention_section:214 - 渲染留存部分...
2026-02-24 18:36:57 - weekly_report - INFO - render_retention_section:240 - ✅ 留存部分渲染完成
2026-02-24 18:36:57 - weekly_report - INFO - generate_revenue_section_html:251 - 生成收入部分HTML...
2026-02-24 18:36:57 - weekly_report - INFO - generate_revenue_section_html:284 - ✅ 收入部分HTML生成完成
2026-02-24 18:36:57 - weekly_report - INFO - generate_full_report_html:418 - ✅ 完整HTML报告生成完成
2026-02-24 18:36:57 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-24 18:36:57 - weekly_report - INFO - main:277 - 
============================================================
2026-02-24 18:36:57 - weekly_report - INFO - main:278 - 第四阶段：更新Confluence
2026-02-24 18:36:57 - weekly_report - INFO - main:279 - ============================================================
2026-02-24 18:36:57 - weekly_report - INFO - update_page:115 - 更新Confluence页面...
2026-02-24 18:36:57 - weekly_report - INFO - get_current_page:71 - 获取Confluence页面 (Page ID: 81397518314)...
2026-02-24 18:36:58 - weekly_report - ERROR - get_current_page:94 - ❌ 获取页面网络异常: Expecting value: line 1 column 1 (char 0)
2026-02-24 18:36:58 - weekly_report - ERROR - update_page:124 - ❌ 无法获取当前页面信息
2026-02-24 18:36:58 - weekly_report - ERROR - main:294 - 
============================================================
2026-02-24 18:36:58 - weekly_report - ERROR - main:295 - ❌ 周报更新失败
2026-02-24 18:37:38 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 18:37:38 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 18:37:38 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 18:37:38 - weekly_report - INFO - main:164 - 目标周: 本周
2026-02-24 18:37:38 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 18:37:38 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 18:37:38 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 18:37:40 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 18:37:40 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 18:37:40 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 18:37:40 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 18:37:40 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 18:37:40 - weekly_report - INFO - fetch_all_sections:233 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 18:37:40 - weekly_report - INFO - fetch_section_data:199 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-24 18:37:40 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:37:40 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:37:40 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:37:40 - weekly_report - INFO - fetch_section_data:199 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-24 18:37:40 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:37:40 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:37:40 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:37:40 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 18:37:40 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:37:40 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:37:41 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:37:41 - weekly_report - INFO - fetch_section_data:199 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 18:37:41 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:37:41 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:37:41 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:37:41 - weekly_report - INFO - fetch_section_data:199 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 18:37:41 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:37:41 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:37:42 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:37:42 - weekly_report - INFO - fetch_all_sections:249 - ✅ 数据获取完成
2026-02-24 18:37:42 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 18:37:42 - weekly_report - WARNING - main:219 - ⚠️  5 个部分无数据
2026-02-24 18:37:42 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 18:37:42 - weekly_report - INFO - fetch_all_sections:233 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 18:37:42 - weekly_report - INFO - fetch_section_data:199 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-24 18:37:42 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:37:42 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:37:42 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:37:42 - weekly_report - INFO - fetch_section_data:199 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-24 18:37:42 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:37:42 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:37:43 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:37:43 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 18:37:43 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:37:43 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:37:43 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:37:43 - weekly_report - INFO - fetch_section_data:199 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 18:37:43 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:37:43 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:37:44 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:37:44 - weekly_report - INFO - fetch_section_data:199 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 18:37:44 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:37:44 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:37:44 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:37:44 - weekly_report - INFO - fetch_all_sections:249 - ✅ 数据获取完成
2026-02-24 18:37:44 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 18:37:44 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 18:37:44 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 18:37:44 - weekly_report - INFO - analyze_all_sections:361 - 开始分析所有部分...
2026-02-24 18:37:44 - weekly_report - INFO - analyze_all_sections:400 - ✅ 所有部分分析完成
2026-02-24 18:37:44 - weekly_report - INFO - main:240 - 
============================================================
2026-02-24 18:37:44 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-24 18:37:44 - weekly_report - INFO - main:242 - ============================================================
2026-02-24 18:37:44 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 18:37:44 - weekly_report - INFO - generate_full_report_html:347 - 生成完整HTML报告...
2026-02-24 18:37:44 - weekly_report - INFO - render_traffic_section:78 - 渲染流量部分...
2026-02-24 18:37:44 - weekly_report - INFO - render_traffic_section:106 - ✅ 流量部分渲染完成
2026-02-24 18:37:44 - weekly_report - INFO - render_activation_section:117 - 渲染激活部分...
2026-02-24 18:37:44 - weekly_report - INFO - render_activation_section:167 - ✅ 激活部分渲染完成
2026-02-24 18:37:44 - weekly_report - INFO - render_retention_section:214 - 渲染留存部分...
2026-02-24 18:37:44 - weekly_report - INFO - render_retention_section:240 - ✅ 留存部分渲染完成
2026-02-24 18:37:44 - weekly_report - INFO - generate_revenue_section_html:251 - 生成收入部分HTML...
2026-02-24 18:37:44 - weekly_report - INFO - generate_revenue_section_html:284 - ✅ 收入部分HTML生成完成
2026-02-24 18:37:44 - weekly_report - INFO - generate_full_report_html:418 - ✅ 完整HTML报告生成完成
2026-02-24 18:37:44 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-24 18:37:44 - weekly_report - INFO - main:277 - 
============================================================
2026-02-24 18:37:44 - weekly_report - INFO - main:278 - 第四阶段：更新Confluence
2026-02-24 18:37:44 - weekly_report - INFO - main:279 - ============================================================
2026-02-24 18:37:44 - weekly_report - INFO - update_page:115 - 更新Confluence页面...
2026-02-24 18:37:44 - weekly_report - INFO - get_current_page:71 - 获取Confluence页面 (Page ID: 81397518314)...
2026-02-24 18:37:45 - weekly_report - ERROR - get_current_page:94 - ❌ 获取页面网络异常: Expecting value: line 1 column 1 (char 0)
2026-02-24 18:37:45 - weekly_report - ERROR - update_page:124 - ❌ 无法获取当前页面信息
2026-02-24 18:37:45 - weekly_report - ERROR - main:294 - 
============================================================
2026-02-24 18:37:45 - weekly_report - ERROR - main:295 - ❌ 周报更新失败
2026-02-24 18:38:15 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 18:38:15 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 18:38:15 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 18:38:15 - weekly_report - INFO - main:164 - 目标周: 本周
2026-02-24 18:38:15 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 18:38:15 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 18:38:15 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 18:38:17 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 18:38:17 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 18:38:17 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 18:38:17 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 18:38:17 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 18:38:17 - weekly_report - INFO - fetch_all_sections:233 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 18:38:17 - weekly_report - INFO - fetch_section_data:199 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-24 18:38:17 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:38:17 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:38:18 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:38:18 - weekly_report - INFO - fetch_section_data:199 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-24 18:38:18 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:38:18 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:38:18 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:38:18 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 18:38:18 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:38:18 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:38:19 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:38:19 - weekly_report - INFO - fetch_section_data:199 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 18:38:19 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:38:19 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:38:19 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:38:19 - weekly_report - INFO - fetch_section_data:199 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 18:38:19 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:38:19 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:38:20 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:38:20 - weekly_report - INFO - fetch_all_sections:249 - ✅ 数据获取完成
2026-02-24 18:38:20 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 18:38:20 - weekly_report - WARNING - main:219 - ⚠️  5 个部分无数据
2026-02-24 18:38:20 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 18:38:20 - weekly_report - INFO - fetch_all_sections:233 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 18:38:20 - weekly_report - INFO - fetch_section_data:199 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-24 18:38:20 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:38:20 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:38:20 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:38:20 - weekly_report - INFO - fetch_section_data:199 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-24 18:38:20 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:38:20 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:38:21 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:38:21 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 18:38:21 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:38:21 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:38:21 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:38:21 - weekly_report - INFO - fetch_section_data:199 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 18:38:21 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:38:21 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:38:21 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:38:21 - weekly_report - INFO - fetch_section_data:199 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 18:38:21 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:38:21 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:38:22 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:38:22 - weekly_report - INFO - fetch_all_sections:249 - ✅ 数据获取完成
2026-02-24 18:38:22 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 18:38:22 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 18:38:22 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 18:38:22 - weekly_report - INFO - analyze_all_sections:361 - 开始分析所有部分...
2026-02-24 18:38:22 - weekly_report - INFO - analyze_all_sections:400 - ✅ 所有部分分析完成
2026-02-24 18:38:22 - weekly_report - INFO - main:240 - 
============================================================
2026-02-24 18:38:22 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-24 18:38:22 - weekly_report - INFO - main:242 - ============================================================
2026-02-24 18:38:22 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 18:38:22 - weekly_report - INFO - generate_full_report_html:347 - 生成完整HTML报告...
2026-02-24 18:38:22 - weekly_report - INFO - render_traffic_section:78 - 渲染流量部分...
2026-02-24 18:38:22 - weekly_report - INFO - render_traffic_section:106 - ✅ 流量部分渲染完成
2026-02-24 18:38:22 - weekly_report - INFO - render_activation_section:117 - 渲染激活部分...
2026-02-24 18:38:22 - weekly_report - INFO - render_activation_section:167 - ✅ 激活部分渲染完成
2026-02-24 18:38:22 - weekly_report - INFO - render_retention_section:214 - 渲染留存部分...
2026-02-24 18:38:22 - weekly_report - INFO - render_retention_section:240 - ✅ 留存部分渲染完成
2026-02-24 18:38:22 - weekly_report - INFO - generate_revenue_section_html:251 - 生成收入部分HTML...
2026-02-24 18:38:22 - weekly_report - INFO - generate_revenue_section_html:284 - ✅ 收入部分HTML生成完成
2026-02-24 18:38:22 - weekly_report - INFO - generate_full_report_html:418 - ✅ 完整HTML报告生成完成
2026-02-24 18:38:22 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-24 18:38:22 - weekly_report - INFO - main:277 - 
============================================================
2026-02-24 18:38:22 - weekly_report - INFO - main:278 - 第四阶段：更新Confluence
2026-02-24 18:38:22 - weekly_report - INFO - main:279 - ============================================================
2026-02-24 18:38:22 - weekly_report - INFO - update_page:115 - 更新Confluence页面...
2026-02-24 18:38:22 - weekly_report - INFO - get_current_page:71 - 获取Confluence页面 (Page ID: 81397518314)...
2026-02-24 18:38:23 - weekly_report - ERROR - get_current_page:94 - ❌ 获取页面网络异常: Expecting value: line 1 column 1 (char 0)
2026-02-24 18:38:23 - weekly_report - ERROR - update_page:124 - ❌ 无法获取当前页面信息
2026-02-24 18:38:23 - weekly_report - ERROR - main:294 - 
============================================================
2026-02-24 18:38:23 - weekly_report - ERROR - main:295 - ❌ 周报更新失败
2026-02-24 18:40:09 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 18:40:09 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 18:40:09 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 18:40:09 - weekly_report - INFO - main:164 - 目标周: 本周
2026-02-24 18:40:09 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 18:40:09 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 18:40:09 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 18:40:11 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 18:40:11 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 18:40:11 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 18:40:11 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 18:40:11 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 18:40:11 - weekly_report - INFO - fetch_all_sections:233 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 18:40:11 - weekly_report - INFO - fetch_section_data:199 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-24 18:40:11 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:40:11 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:40:12 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:40:12 - weekly_report - INFO - fetch_section_data:199 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-24 18:40:12 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:40:12 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:40:12 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:40:12 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 18:40:12 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:40:12 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:40:13 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:40:13 - weekly_report - INFO - fetch_section_data:199 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 18:40:13 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:40:13 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:40:13 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:40:13 - weekly_report - INFO - fetch_section_data:199 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 18:40:13 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:40:13 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:40:14 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:40:14 - weekly_report - INFO - fetch_all_sections:249 - ✅ 数据获取完成
2026-02-24 18:40:14 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 18:40:14 - weekly_report - WARNING - main:219 - ⚠️  5 个部分无数据
2026-02-24 18:40:14 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 18:40:14 - weekly_report - INFO - fetch_all_sections:233 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 18:40:14 - weekly_report - INFO - fetch_section_data:199 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-24 18:40:14 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:40:14 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:40:14 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:40:14 - weekly_report - INFO - fetch_section_data:199 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-24 18:40:14 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:40:14 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:40:15 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:40:15 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 18:40:15 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:40:15 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:40:15 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:40:15 - weekly_report - INFO - fetch_section_data:199 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 18:40:15 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:40:15 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:40:15 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:40:15 - weekly_report - INFO - fetch_section_data:199 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 18:40:15 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:40:15 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:40:16 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:40:16 - weekly_report - INFO - fetch_all_sections:249 - ✅ 数据获取完成
2026-02-24 18:40:16 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 18:40:16 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 18:40:16 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 18:40:16 - weekly_report - INFO - analyze_all_sections:361 - 开始分析所有部分...
2026-02-24 18:40:16 - weekly_report - INFO - analyze_all_sections:400 - ✅ 所有部分分析完成
2026-02-24 18:40:16 - weekly_report - INFO - main:240 - 
============================================================
2026-02-24 18:40:16 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-24 18:40:16 - weekly_report - INFO - main:242 - ============================================================
2026-02-24 18:40:16 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 18:40:16 - weekly_report - INFO - generate_full_report_html:347 - 生成完整HTML报告...
2026-02-24 18:40:16 - weekly_report - INFO - render_traffic_section:78 - 渲染流量部分...
2026-02-24 18:40:16 - weekly_report - INFO - render_traffic_section:106 - ✅ 流量部分渲染完成
2026-02-24 18:40:16 - weekly_report - INFO - render_activation_section:117 - 渲染激活部分...
2026-02-24 18:40:16 - weekly_report - INFO - render_activation_section:167 - ✅ 激活部分渲染完成
2026-02-24 18:40:16 - weekly_report - INFO - render_retention_section:214 - 渲染留存部分...
2026-02-24 18:40:16 - weekly_report - INFO - render_retention_section:240 - ✅ 留存部分渲染完成
2026-02-24 18:40:16 - weekly_report - INFO - generate_revenue_section_html:251 - 生成收入部分HTML...
2026-02-24 18:40:16 - weekly_report - INFO - generate_revenue_section_html:284 - ✅ 收入部分HTML生成完成
2026-02-24 18:40:16 - weekly_report - INFO - generate_full_report_html:418 - ✅ 完整HTML报告生成完成
2026-02-24 18:40:16 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-24 18:40:16 - weekly_report - INFO - main:277 - 
============================================================
2026-02-24 18:40:16 - weekly_report - INFO - main:278 - 第四阶段：更新Confluence
2026-02-24 18:40:16 - weekly_report - INFO - main:279 - ============================================================
2026-02-24 18:40:16 - weekly_report - INFO - update_page:115 - 更新Confluence页面...
2026-02-24 18:40:16 - weekly_report - INFO - get_current_page:71 - 获取Confluence页面 (Page ID: 81397518314)...
2026-02-24 18:40:16 - weekly_report - ERROR - get_current_page:94 - ❌ 获取页面网络异常: Expecting value: line 1 column 1 (char 0)
2026-02-24 18:40:16 - weekly_report - ERROR - update_page:124 - ❌ 无法获取当前页面信息
2026-02-24 18:40:16 - weekly_report - ERROR - main:294 - 
============================================================
2026-02-24 18:40:16 - weekly_report - ERROR - main:295 - ❌ 周报更新失败
2026-02-24 18:40:42 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 18:40:42 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 18:40:42 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 18:40:42 - weekly_report - INFO - main:164 - 目标周: 本周
2026-02-24 18:40:42 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 18:40:42 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 18:40:42 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 18:40:44 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 18:40:44 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 18:40:44 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 18:40:44 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 18:40:44 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 18:40:44 - weekly_report - INFO - fetch_all_sections:233 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 18:40:44 - weekly_report - INFO - fetch_section_data:199 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-24 18:40:44 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:40:44 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:40:45 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:40:45 - weekly_report - INFO - fetch_section_data:199 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-24 18:40:45 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:40:45 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:40:46 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:40:46 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 18:40:46 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:40:46 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:40:46 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:40:46 - weekly_report - INFO - fetch_section_data:199 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 18:40:46 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:40:46 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:40:46 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:40:46 - weekly_report - INFO - fetch_section_data:199 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 18:40:46 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:40:46 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:40:47 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:40:47 - weekly_report - INFO - fetch_all_sections:249 - ✅ 数据获取完成
2026-02-24 18:40:47 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 18:40:47 - weekly_report - WARNING - main:219 - ⚠️  5 个部分无数据
2026-02-24 18:40:47 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 18:40:47 - weekly_report - INFO - fetch_all_sections:233 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 18:40:47 - weekly_report - INFO - fetch_section_data:199 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-24 18:40:47 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:40:47 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:40:47 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:40:47 - weekly_report - INFO - fetch_section_data:199 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-24 18:40:47 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:40:47 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:40:48 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:40:48 - weekly_report - INFO - fetch_section_data:199 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 18:40:48 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:40:48 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:40:48 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:40:48 - weekly_report - INFO - fetch_section_data:199 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 18:40:48 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:40:48 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:40:49 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:40:49 - weekly_report - INFO - fetch_section_data:199 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 18:40:49 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 18:40:49 - weekly_report - INFO - _execute_via_api:74 - 使用requests库执行Metabase查询...
2026-02-24 18:40:50 - weekly_report - WARNING - _execute_via_api:120 - ⚠️  查询执行中或出错 (状态码: 202)
2026-02-24 18:40:50 - weekly_report - INFO - fetch_all_sections:249 - ✅ 数据获取完成
2026-02-24 18:40:50 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 18:40:50 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 18:40:50 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 18:40:50 - weekly_report - INFO - analyze_all_sections:361 - 开始分析所有部分...
2026-02-24 18:40:50 - weekly_report - INFO - analyze_all_sections:400 - ✅ 所有部分分析完成
2026-02-24 18:40:50 - weekly_report - INFO - main:240 - 
============================================================
2026-02-24 18:40:50 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-24 18:40:50 - weekly_report - INFO - main:242 - ============================================================
2026-02-24 18:40:50 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 18:40:50 - weekly_report - INFO - generate_full_report_html:347 - 生成完整HTML报告...
2026-02-24 18:40:50 - weekly_report - INFO - render_traffic_section:78 - 渲染流量部分...
2026-02-24 18:40:50 - weekly_report - INFO - render_traffic_section:106 - ✅ 流量部分渲染完成
2026-02-24 18:40:50 - weekly_report - INFO - render_activation_section:117 - 渲染激活部分...
2026-02-24 18:40:50 - weekly_report - INFO - render_activation_section:167 - ✅ 激活部分渲染完成
2026-02-24 18:40:50 - weekly_report - INFO - render_retention_section:214 - 渲染留存部分...
2026-02-24 18:40:50 - weekly_report - INFO - render_retention_section:240 - ✅ 留存部分渲染完成
2026-02-24 18:40:50 - weekly_report - INFO - generate_revenue_section_html:251 - 生成收入部分HTML...
2026-02-24 18:40:50 - weekly_report - INFO - generate_revenue_section_html:284 - ✅ 收入部分HTML生成完成
2026-02-24 18:40:50 - weekly_report - INFO - generate_full_report_html:418 - ✅ 完整HTML报告生成完成
2026-02-24 18:40:50 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-24 18:40:50 - weekly_report - INFO - main:277 - 
============================================================
2026-02-24 18:40:50 - weekly_report - INFO - main:278 - 第四阶段：更新Confluence
2026-02-24 18:40:50 - weekly_report - INFO - main:279 - ============================================================
2026-02-24 18:40:50 - weekly_report - INFO - update_page:115 - 更新Confluence页面...
2026-02-24 18:40:50 - weekly_report - INFO - get_current_page:71 - 获取Confluence页面 (Page ID: 81397518314)...
2026-02-24 18:40:50 - weekly_report - ERROR - get_current_page:94 - ❌ 获取页面网络异常: Expecting value: line 1 column 1 (char 0)
2026-02-24 18:40:50 - weekly_report - ERROR - update_page:124 - ❌ 无法获取当前页面信息
2026-02-24 18:40:50 - weekly_report - ERROR - main:294 - 
============================================================
2026-02-24 18:40:50 - weekly_report - ERROR - main:295 - ❌ 周报更新失败
2026-02-24 19:20:47 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 19:20:47 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 19:20:47 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 19:20:47 - weekly_report - INFO - main:164 - 目标周: 本周
2026-02-24 19:20:47 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 19:20:47 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 19:20:47 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 19:20:49 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 19:20:49 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 19:20:49 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 19:20:49 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 19:20:49 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 19:20:49 - weekly_report - INFO - fetch_all_sections:255 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 19:20:49 - weekly_report - INFO - fetch_section_data:221 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-24 19:20:49 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 19:20:49 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 19:20:49 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 19:20:53 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (2/5)
2026-02-24 19:20:56 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (3/5)
2026-02-24 19:21:00 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (4/5)
2026-02-24 19:21:03 - weekly_report - WARNING - _execute_via_api:131 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 19:21:03 - weekly_report - INFO - fetch_section_data:221 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-24 19:21:03 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 19:21:03 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 19:21:04 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 19:21:07 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (2/5)
2026-02-24 19:21:10 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (3/5)
2026-02-24 19:21:14 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (4/5)
2026-02-24 19:21:18 - weekly_report - WARNING - _execute_via_api:131 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 19:21:18 - weekly_report - INFO - fetch_section_data:221 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 19:21:18 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 19:21:18 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 19:21:18 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 19:21:22 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (2/5)
2026-02-24 19:21:25 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (3/5)
2026-02-24 19:21:29 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (4/5)
2026-02-24 19:21:32 - weekly_report - WARNING - _execute_via_api:131 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 19:21:32 - weekly_report - INFO - fetch_section_data:221 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 19:21:32 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 19:21:32 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 19:21:33 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 19:21:36 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (2/5)
2026-02-24 19:21:41 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (3/5)
2026-02-24 19:21:44 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (4/5)
2026-02-24 19:21:48 - weekly_report - WARNING - _execute_via_api:131 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 19:21:48 - weekly_report - INFO - fetch_section_data:221 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 19:21:48 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 19:21:48 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 19:21:49 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 19:21:52 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (2/5)
2026-02-24 19:21:56 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (3/5)
2026-02-24 19:22:00 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (4/5)
2026-02-24 19:22:03 - weekly_report - WARNING - _execute_via_api:131 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 19:22:03 - weekly_report - INFO - fetch_all_sections:271 - ✅ 数据获取完成
2026-02-24 19:22:03 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 19:22:03 - weekly_report - WARNING - main:219 - ⚠️  5 个部分无数据
2026-02-24 19:22:03 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 19:22:03 - weekly_report - INFO - fetch_all_sections:255 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 19:22:03 - weekly_report - INFO - fetch_section_data:221 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-24 19:22:03 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 19:22:03 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 19:22:04 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 19:22:07 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (2/5)
2026-02-24 19:22:11 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (3/5)
2026-02-24 19:22:14 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (4/5)
2026-02-24 19:22:17 - weekly_report - WARNING - _execute_via_api:131 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 19:22:17 - weekly_report - INFO - fetch_section_data:221 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-24 19:22:17 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 19:22:17 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 19:22:18 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 19:22:22 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (2/5)
2026-02-24 19:22:25 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (3/5)
2026-02-24 19:22:29 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (4/5)
2026-02-24 19:22:32 - weekly_report - WARNING - _execute_via_api:131 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 19:22:32 - weekly_report - INFO - fetch_section_data:221 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 19:22:32 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 19:22:32 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 19:22:33 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 19:22:36 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (2/5)
2026-02-24 19:22:40 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (3/5)
2026-02-24 19:22:44 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (4/5)
2026-02-24 19:22:47 - weekly_report - WARNING - _execute_via_api:131 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 19:22:47 - weekly_report - INFO - fetch_section_data:221 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 19:22:47 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 19:22:47 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 19:22:48 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 19:22:52 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (2/5)
2026-02-24 19:22:55 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (3/5)
2026-02-24 19:22:59 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (4/5)
2026-02-24 19:23:03 - weekly_report - WARNING - _execute_via_api:131 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 19:23:03 - weekly_report - INFO - fetch_section_data:221 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 19:23:03 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 19:23:03 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 19:23:03 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 19:23:06 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (2/5)
2026-02-24 19:23:10 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (3/5)
2026-02-24 19:23:13 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (4/5)
2026-02-24 19:23:17 - weekly_report - WARNING - _execute_via_api:131 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 19:23:17 - weekly_report - INFO - fetch_all_sections:271 - ✅ 数据获取完成
2026-02-24 19:23:17 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 19:23:17 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 19:23:17 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 19:23:17 - weekly_report - INFO - analyze_all_sections:361 - 开始分析所有部分...
2026-02-24 19:23:17 - weekly_report - INFO - analyze_all_sections:400 - ✅ 所有部分分析完成
2026-02-24 19:23:17 - weekly_report - INFO - main:240 - 
============================================================
2026-02-24 19:23:17 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-24 19:23:17 - weekly_report - INFO - main:242 - ============================================================
2026-02-24 19:23:17 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 19:23:17 - weekly_report - INFO - generate_full_report_html:347 - 生成完整HTML报告...
2026-02-24 19:23:17 - weekly_report - INFO - render_traffic_section:78 - 渲染流量部分...
2026-02-24 19:23:17 - weekly_report - INFO - render_traffic_section:106 - ✅ 流量部分渲染完成
2026-02-24 19:23:17 - weekly_report - INFO - render_activation_section:117 - 渲染激活部分...
2026-02-24 19:23:17 - weekly_report - INFO - render_activation_section:167 - ✅ 激活部分渲染完成
2026-02-24 19:23:17 - weekly_report - INFO - render_retention_section:214 - 渲染留存部分...
2026-02-24 19:23:17 - weekly_report - INFO - render_retention_section:240 - ✅ 留存部分渲染完成
2026-02-24 19:23:17 - weekly_report - INFO - generate_revenue_section_html:251 - 生成收入部分HTML...
2026-02-24 19:23:17 - weekly_report - INFO - generate_revenue_section_html:284 - ✅ 收入部分HTML生成完成
2026-02-24 19:23:17 - weekly_report - INFO - generate_full_report_html:418 - ✅ 完整HTML报告生成完成
2026-02-24 19:23:17 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-24 19:23:17 - weekly_report - INFO - main:258 - 
============================================================
2026-02-24 19:23:17 - weekly_report - INFO - main:259 - 第四阶段：保存报告到文件
2026-02-24 19:23:17 - weekly_report - INFO - main:260 - ============================================================
2026-02-24 19:23:17 - weekly_report - INFO - save_html_to_file:203 - ✅ HTML已保存到: confluence_report_2026-02-28.html
2026-02-24 19:23:17 - weekly_report - INFO - main:267 - 
============================================================
2026-02-24 19:23:17 - weekly_report - INFO - main:268 - ✅ 报告已保存到本地文件！
2026-02-24 19:23:17 - weekly_report - INFO - main:269 - ============================================================
2026-02-24 19:23:17 - weekly_report - INFO - main:270 - 文件路径: output/confluence_report_2026-02-28.html
2026-02-24 19:23:17 - weekly_report - INFO - main:271 - 报告日期: 2026-02-28
2026-02-24 19:23:47 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 19:23:47 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 19:23:47 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 19:23:47 - weekly_report - INFO - main:164 - 目标周: 指定日期(20260217)
2026-02-24 19:23:47 - weekly_report - INFO - main:165 - 报告日期: 2026-02-21
2026-02-24 19:23:47 - weekly_report - INFO - main:166 - 周范围: 20260216 ~ 20260221
2026-02-24 19:23:47 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 19:23:49 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 19:23:49 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 19:23:49 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 19:23:49 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 19:23:49 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 19:23:49 - weekly_report - INFO - fetch_all_sections:255 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 19:23:49 - weekly_report - INFO - fetch_section_data:221 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-24 19:23:49 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 19:23:49 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 19:23:49 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 19:23:53 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (2/5)
2026-02-24 19:23:56 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (3/5)
2026-02-24 19:24:00 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (4/5)
2026-02-24 19:24:03 - weekly_report - WARNING - _execute_via_api:131 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 19:24:03 - weekly_report - INFO - fetch_section_data:221 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-24 19:24:03 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 19:24:03 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 19:24:04 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 19:24:07 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (2/5)
2026-02-24 19:24:11 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (3/5)
2026-02-24 19:24:15 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (4/5)
2026-02-24 19:24:19 - weekly_report - WARNING - _execute_via_api:131 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 19:24:19 - weekly_report - INFO - fetch_section_data:221 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 19:24:19 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 19:24:19 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 19:24:19 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 19:24:23 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (2/5)
2026-02-24 19:24:26 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (3/5)
2026-02-24 19:24:30 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (4/5)
2026-02-24 19:24:34 - weekly_report - WARNING - _execute_via_api:131 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 19:24:34 - weekly_report - INFO - fetch_section_data:221 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 19:24:34 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 19:24:34 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 19:24:34 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 19:24:38 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (2/5)
2026-02-24 19:24:41 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (3/5)
2026-02-24 19:24:45 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (4/5)
2026-02-24 19:24:48 - weekly_report - WARNING - _execute_via_api:131 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 19:24:48 - weekly_report - INFO - fetch_section_data:221 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 19:24:48 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 19:24:48 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 19:24:49 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 19:24:52 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (2/5)
2026-02-24 19:24:57 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (3/5)
2026-02-24 19:25:00 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (4/5)
2026-02-24 19:25:04 - weekly_report - WARNING - _execute_via_api:131 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 19:25:04 - weekly_report - INFO - fetch_all_sections:271 - ✅ 数据获取完成
2026-02-24 19:25:04 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 19:25:04 - weekly_report - WARNING - main:219 - ⚠️  5 个部分无数据
2026-02-24 19:25:04 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 19:25:04 - weekly_report - INFO - fetch_all_sections:255 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 19:25:04 - weekly_report - INFO - fetch_section_data:221 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-24 19:25:04 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 19:25:04 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 19:25:04 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 19:25:08 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (2/5)
2026-02-24 19:25:11 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (3/5)
2026-02-24 19:25:15 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (4/5)
2026-02-24 19:25:18 - weekly_report - WARNING - _execute_via_api:131 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 19:25:18 - weekly_report - INFO - fetch_section_data:221 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-24 19:25:18 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 19:25:18 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 19:25:19 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 19:25:22 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (2/5)
2026-02-24 19:25:26 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (3/5)
2026-02-24 19:25:29 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (4/5)
2026-02-24 19:25:32 - weekly_report - WARNING - _execute_via_api:131 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 19:25:32 - weekly_report - INFO - fetch_section_data:221 - 处理 engagement_new_old_users 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 19:25:32 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 19:25:32 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 19:25:37 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 19:25:40 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (2/5)
2026-02-24 19:25:44 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (3/5)
2026-02-24 19:25:48 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (4/5)
2026-02-24 19:25:51 - weekly_report - WARNING - _execute_via_api:131 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 19:25:51 - weekly_report - INFO - fetch_section_data:221 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 19:25:51 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 19:25:51 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 19:25:52 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 19:25:55 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (2/5)
2026-02-24 19:25:59 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (3/5)
2026-02-24 19:26:02 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (4/5)
2026-02-24 19:26:06 - weekly_report - WARNING - _execute_via_api:131 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 19:26:06 - weekly_report - INFO - fetch_section_data:221 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 19:26:06 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 19:26:06 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 19:26:07 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 19:26:10 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (2/5)
2026-02-24 19:26:14 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (3/5)
2026-02-24 19:26:17 - weekly_report - WARNING - _execute_via_api:127 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (4/5)
2026-02-24 19:26:21 - weekly_report - WARNING - _execute_via_api:131 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 19:26:21 - weekly_report - INFO - fetch_all_sections:271 - ✅ 数据获取完成
2026-02-24 19:26:21 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 19:26:21 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 19:26:21 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 19:26:21 - weekly_report - INFO - analyze_all_sections:361 - 开始分析所有部分...
2026-02-24 19:26:21 - weekly_report - INFO - analyze_all_sections:400 - ✅ 所有部分分析完成
2026-02-24 19:26:21 - weekly_report - INFO - main:240 - 
============================================================
2026-02-24 19:26:21 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-24 19:26:21 - weekly_report - INFO - main:242 - ============================================================
2026-02-24 19:26:21 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 19:26:21 - weekly_report - INFO - generate_full_report_html:347 - 生成完整HTML报告...
2026-02-24 19:26:21 - weekly_report - INFO - render_traffic_section:78 - 渲染流量部分...
2026-02-24 19:26:21 - weekly_report - INFO - render_traffic_section:106 - ✅ 流量部分渲染完成
2026-02-24 19:26:21 - weekly_report - INFO - render_activation_section:117 - 渲染激活部分...
2026-02-24 19:26:21 - weekly_report - INFO - render_activation_section:167 - ✅ 激活部分渲染完成
2026-02-24 19:26:21 - weekly_report - INFO - render_retention_section:214 - 渲染留存部分...
2026-02-24 19:26:21 - weekly_report - INFO - render_retention_section:240 - ✅ 留存部分渲染完成
2026-02-24 19:26:21 - weekly_report - INFO - generate_revenue_section_html:251 - 生成收入部分HTML...
2026-02-24 19:26:21 - weekly_report - INFO - generate_revenue_section_html:284 - ✅ 收入部分HTML生成完成
2026-02-24 19:26:21 - weekly_report - INFO - generate_full_report_html:418 - ✅ 完整HTML报告生成完成
2026-02-24 19:26:21 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-24 19:26:21 - weekly_report - INFO - main:258 - 
============================================================
2026-02-24 19:26:21 - weekly_report - INFO - main:259 - 第四阶段：保存报告到文件
2026-02-24 19:26:21 - weekly_report - INFO - main:260 - ============================================================
2026-02-24 19:26:21 - weekly_report - INFO - save_html_to_file:203 - ✅ HTML已保存到: confluence_report_2026-02-21.html
2026-02-24 19:26:21 - weekly_report - INFO - main:267 - 
============================================================
2026-02-24 19:26:21 - weekly_report - INFO - main:268 - ✅ 报告已保存到本地文件！
2026-02-24 19:26:21 - weekly_report - INFO - main:269 - ============================================================
2026-02-24 19:26:21 - weekly_report - INFO - main:270 - 文件路径: output/confluence_report_2026-02-21.html
2026-02-24 19:26:21 - weekly_report - INFO - main:271 - 报告日期: 2026-02-21
2026-02-24 20:29:26 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 20:29:26 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 20:29:26 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 20:29:26 - weekly_report - INFO - main:164 - 目标周: 本周
2026-02-24 20:29:26 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 20:29:26 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 20:29:26 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 20:29:28 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 20:29:28 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 20:29:28 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 20:29:28 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 20:29:28 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 20:29:28 - weekly_report - INFO - fetch_all_sections:269 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 20:29:28 - weekly_report - INFO - fetch_section_data:227 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-24 20:29:28 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 20:29:28 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 20:29:28 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 20:29:32 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 20:29:38 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 20:29:51 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 20:30:16 - weekly_report - WARNING - _execute_via_api:136 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 20:30:16 - weekly_report - INFO - fetch_section_data:227 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-24 20:30:16 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 20:30:16 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 20:30:16 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 20:30:20 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 20:30:26 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 20:30:39 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 20:31:03 - weekly_report - WARNING - _execute_via_api:136 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 20:31:03 - weekly_report - INFO - fetch_section_data:227 - 处理 engagement 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 20:31:03 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 20:31:03 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 20:31:04 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 20:31:07 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 20:31:14 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 20:31:27 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 20:31:51 - weekly_report - WARNING - _execute_via_api:136 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 20:31:51 - weekly_report - INFO - fetch_section_data:227 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 20:31:51 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 20:31:51 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 20:31:52 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 20:31:55 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 20:32:02 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 20:32:15 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 20:32:39 - weekly_report - WARNING - _execute_via_api:136 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 20:32:39 - weekly_report - INFO - fetch_section_data:227 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 20:32:39 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 20:32:39 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 20:32:40 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 20:32:43 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 20:32:50 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 20:33:03 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 20:33:27 - weekly_report - WARNING - _execute_via_api:136 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 20:33:27 - weekly_report - INFO - fetch_all_sections:285 - ✅ 数据获取完成
2026-02-24 20:33:27 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 20:33:27 - weekly_report - WARNING - main:219 - ⚠️  5 个部分无数据
2026-02-24 20:33:27 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 20:33:27 - weekly_report - INFO - fetch_all_sections:269 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 20:33:27 - weekly_report - INFO - fetch_section_data:227 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-24 20:33:27 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 20:33:27 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 20:33:28 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 20:33:31 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 20:33:39 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 20:33:52 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 20:34:16 - weekly_report - WARNING - _execute_via_api:136 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 20:34:16 - weekly_report - INFO - fetch_section_data:227 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-24 20:34:16 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 20:34:16 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 20:34:17 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 20:34:20 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 20:34:27 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 20:34:40 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 20:35:04 - weekly_report - WARNING - _execute_via_api:136 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 20:35:04 - weekly_report - INFO - fetch_section_data:227 - 处理 engagement 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 20:35:04 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 20:35:04 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 20:35:05 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 20:35:08 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 20:35:15 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 20:35:27 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 20:35:52 - weekly_report - WARNING - _execute_via_api:136 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 20:35:52 - weekly_report - INFO - fetch_section_data:227 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 20:35:52 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 20:35:52 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 20:35:53 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 20:35:56 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 20:36:03 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 20:36:16 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 20:36:41 - weekly_report - WARNING - _execute_via_api:136 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 20:36:41 - weekly_report - INFO - fetch_section_data:227 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 20:36:41 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 20:36:41 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 20:36:41 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 20:36:45 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 20:36:51 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 20:37:04 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 20:37:29 - weekly_report - WARNING - _execute_via_api:136 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 20:37:29 - weekly_report - INFO - fetch_all_sections:285 - ✅ 数据获取完成
2026-02-24 20:37:29 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 20:37:29 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 20:37:29 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 20:37:29 - weekly_report - INFO - analyze_all_sections:383 - 开始分析所有部分...
2026-02-24 20:37:29 - weekly_report - INFO - analyze_all_sections:422 - ✅ 所有部分分析完成
2026-02-24 20:37:29 - weekly_report - INFO - main:240 - 
============================================================
2026-02-24 20:37:29 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-24 20:37:29 - weekly_report - INFO - main:242 - ============================================================
2026-02-24 20:37:29 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 20:37:29 - weekly_report - INFO - generate_full_report_html:348 - 生成完整HTML报告...
2026-02-24 20:37:29 - weekly_report - INFO - render_traffic_section:78 - 渲染流量部分...
2026-02-24 20:37:29 - weekly_report - INFO - render_traffic_section:106 - ✅ 流量部分渲染完成
2026-02-24 20:37:29 - weekly_report - INFO - render_activation_section:117 - 渲染激活部分...
2026-02-24 20:37:29 - weekly_report - INFO - render_activation_section:168 - ✅ 激活部分渲染完成
2026-02-24 20:37:29 - weekly_report - INFO - render_engagement_section:179 - 渲染活跃部分...
2026-02-24 20:37:29 - weekly_report - INFO - render_engagement_section:204 - ✅ 活跃部分渲染完成
2026-02-24 20:37:29 - weekly_report - INFO - render_retention_section:215 - 渲染留存部分...
2026-02-24 20:37:29 - weekly_report - INFO - render_retention_section:241 - ✅ 留存部分渲染完成
2026-02-24 20:37:29 - weekly_report - INFO - generate_revenue_section_html:252 - 生成收入部分HTML...
2026-02-24 20:37:29 - weekly_report - INFO - generate_revenue_section_html:285 - ✅ 收入部分HTML生成完成
2026-02-24 20:37:29 - weekly_report - INFO - generate_full_report_html:419 - ✅ 完整HTML报告生成完成
2026-02-24 20:37:29 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-24 20:37:29 - weekly_report - INFO - main:258 - 
============================================================
2026-02-24 20:37:29 - weekly_report - INFO - main:259 - 第四阶段：保存报告到文件
2026-02-24 20:37:29 - weekly_report - INFO - main:260 - ============================================================
2026-02-24 20:37:29 - weekly_report - INFO - save_html_to_file:203 - ✅ HTML已保存到: confluence_report_2026-02-28.html
2026-02-24 20:37:29 - weekly_report - INFO - main:267 - 
============================================================
2026-02-24 20:37:29 - weekly_report - INFO - main:268 - ✅ 报告已保存到本地文件！
2026-02-24 20:37:29 - weekly_report - INFO - main:269 - ============================================================
2026-02-24 20:37:29 - weekly_report - INFO - main:270 - 文件路径: output/confluence_report_2026-02-28.html
2026-02-24 20:37:29 - weekly_report - INFO - main:271 - 报告日期: 2026-02-28
2026-02-24 20:42:45 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 20:42:45 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 20:42:45 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 20:42:45 - weekly_report - INFO - main:164 - 目标周: 指定日期(20260223)
2026-02-24 20:42:45 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 20:42:45 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 20:42:45 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 20:42:47 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 20:42:47 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 20:42:47 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 20:42:47 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 20:42:47 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 20:42:47 - weekly_report - INFO - fetch_all_sections:269 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 20:42:47 - weekly_report - INFO - fetch_section_data:227 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-24 20:42:47 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 20:42:47 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 20:42:48 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 20:42:52 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 20:42:58 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 20:43:11 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 20:43:35 - weekly_report - WARNING - _execute_via_api:136 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 20:43:35 - weekly_report - INFO - fetch_section_data:227 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-24 20:43:35 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 20:43:35 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 20:43:36 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 20:43:39 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 20:43:45 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 20:43:58 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 20:44:22 - weekly_report - WARNING - _execute_via_api:136 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 20:44:22 - weekly_report - INFO - fetch_section_data:227 - 处理 engagement 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 20:44:22 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 20:44:22 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 20:44:23 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 20:44:27 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 20:44:33 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 20:44:46 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 20:45:10 - weekly_report - WARNING - _execute_via_api:136 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 20:45:10 - weekly_report - INFO - fetch_section_data:227 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 20:45:10 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 20:45:10 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 20:45:11 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 20:45:15 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 20:45:21 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 20:45:34 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 20:45:59 - weekly_report - WARNING - _execute_via_api:136 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 20:45:59 - weekly_report - INFO - fetch_section_data:227 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 20:45:59 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 20:45:59 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 20:45:59 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 20:46:03 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 20:46:09 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 20:46:22 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 20:46:46 - weekly_report - WARNING - _execute_via_api:136 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 20:46:46 - weekly_report - INFO - fetch_all_sections:285 - ✅ 数据获取完成
2026-02-24 20:46:46 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 20:46:46 - weekly_report - WARNING - main:219 - ⚠️  5 个部分无数据
2026-02-24 20:46:46 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 20:46:46 - weekly_report - INFO - fetch_all_sections:269 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 20:46:46 - weekly_report - INFO - fetch_section_data:227 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-24 20:46:46 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 20:46:46 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 20:46:47 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 20:46:51 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 20:46:57 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 20:47:09 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 20:47:34 - weekly_report - WARNING - _execute_via_api:136 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 20:47:34 - weekly_report - INFO - fetch_section_data:227 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-24 20:47:34 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 20:47:34 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 20:47:35 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 20:47:38 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 20:47:44 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 20:47:57 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 20:48:21 - weekly_report - WARNING - _execute_via_api:136 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 20:48:21 - weekly_report - INFO - fetch_section_data:227 - 处理 engagement 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 20:48:21 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 20:48:21 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 20:48:23 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 20:48:26 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 20:48:33 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 20:48:45 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 20:49:11 - weekly_report - WARNING - _execute_via_api:136 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 20:49:11 - weekly_report - INFO - fetch_section_data:227 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 20:49:11 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 20:49:11 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 20:49:11 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 20:49:15 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 20:49:22 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 20:49:28 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 20:49:28 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 20:49:28 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 20:49:28 - weekly_report - INFO - main:164 - 目标周: 指定日期(20260223)
2026-02-24 20:49:28 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 20:49:28 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 20:49:28 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 20:49:30 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 20:49:30 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 20:49:30 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 20:49:30 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 20:49:30 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 20:49:30 - weekly_report - INFO - fetch_all_sections:335 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 20:49:30 - weekly_report - INFO - fetch_section_data:290 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-24 20:49:30 - weekly_report - INFO - execute_metabase_query:123 - 正在执行Metabase查询...
2026-02-24 20:49:30 - weekly_report - INFO - _execute_via_api:141 - 使用requests库执行Metabase查询...
2026-02-24 20:49:31 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 20:49:35 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 20:49:35 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 20:49:41 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 20:49:54 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 20:49:59 - weekly_report - WARNING - _execute_via_api:136 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 20:49:59 - weekly_report - INFO - fetch_section_data:227 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 20:49:59 - weekly_report - INFO - execute_metabase_query:60 - 正在执行Metabase查询...
2026-02-24 20:49:59 - weekly_report - INFO - _execute_via_api:78 - 使用requests库执行Metabase查询...
2026-02-24 20:50:00 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 20:50:03 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 20:50:10 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 20:50:18 - weekly_report - WARNING - _execute_via_api:199 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 20:50:18 - weekly_report - INFO - _save_sql_to_md:108 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/traffic_query_2026-02-28.md
2026-02-24 20:50:18 - weekly_report - INFO - fetch_section_data:290 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-24 20:50:18 - weekly_report - INFO - execute_metabase_query:123 - 正在执行Metabase查询...
2026-02-24 20:50:18 - weekly_report - INFO - _execute_via_api:141 - 使用requests库执行Metabase查询...
2026-02-24 20:50:19 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 20:50:22 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 20:50:23 - weekly_report - WARNING - _execute_via_api:132 - ⚠️  查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 20:50:29 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 20:50:41 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 20:50:47 - weekly_report - WARNING - _execute_via_api:136 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 20:50:47 - weekly_report - INFO - fetch_all_sections:285 - ✅ 数据获取完成
2026-02-24 20:50:47 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 20:50:47 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 20:50:47 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 20:50:47 - weekly_report - INFO - analyze_all_sections:383 - 开始分析所有部分...
2026-02-24 20:50:47 - weekly_report - INFO - analyze_all_sections:422 - ✅ 所有部分分析完成
2026-02-24 20:50:47 - weekly_report - INFO - main:240 - 
============================================================
2026-02-24 20:50:47 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-24 20:50:47 - weekly_report - INFO - main:242 - ============================================================
2026-02-24 20:50:47 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 20:50:47 - weekly_report - INFO - generate_full_report_html:348 - 生成完整HTML报告...
2026-02-24 20:50:47 - weekly_report - INFO - render_traffic_section:78 - 渲染流量部分...
2026-02-24 20:50:47 - weekly_report - INFO - render_traffic_section:106 - ✅ 流量部分渲染完成
2026-02-24 20:50:47 - weekly_report - INFO - render_activation_section:117 - 渲染激活部分...
2026-02-24 20:50:47 - weekly_report - INFO - render_activation_section:168 - ✅ 激活部分渲染完成
2026-02-24 20:50:47 - weekly_report - INFO - render_engagement_section:179 - 渲染活跃部分...
2026-02-24 20:50:47 - weekly_report - INFO - render_engagement_section:204 - ✅ 活跃部分渲染完成
2026-02-24 20:50:47 - weekly_report - INFO - render_retention_section:215 - 渲染留存部分...
2026-02-24 20:50:47 - weekly_report - INFO - render_retention_section:241 - ✅ 留存部分渲染完成
2026-02-24 20:50:47 - weekly_report - INFO - generate_revenue_section_html:252 - 生成收入部分HTML...
2026-02-24 20:50:47 - weekly_report - INFO - generate_revenue_section_html:285 - ✅ 收入部分HTML生成完成
2026-02-24 20:50:47 - weekly_report - INFO - generate_full_report_html:419 - ✅ 完整HTML报告生成完成
2026-02-24 20:50:47 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-24 20:50:47 - weekly_report - INFO - main:258 - 
============================================================
2026-02-24 20:50:47 - weekly_report - INFO - main:259 - 第四阶段：保存报告到文件
2026-02-24 20:50:47 - weekly_report - INFO - main:260 - ============================================================
2026-02-24 20:50:47 - weekly_report - INFO - save_html_to_file:203 - ✅ HTML已保存到: confluence_report_2026-02-28.html
2026-02-24 20:50:47 - weekly_report - INFO - main:267 - 
============================================================
2026-02-24 20:50:47 - weekly_report - INFO - main:268 - ✅ 报告已保存到本地文件！
2026-02-24 20:50:47 - weekly_report - INFO - main:269 - ============================================================
2026-02-24 20:50:47 - weekly_report - INFO - main:270 - 文件路径: output/confluence_report_2026-02-28.html
2026-02-24 20:50:47 - weekly_report - INFO - main:271 - 报告日期: 2026-02-28
2026-02-24 20:51:05 - weekly_report - WARNING - _execute_via_api:199 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 20:51:05 - weekly_report - INFO - _save_sql_to_md:108 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/activation_query_2026-02-28.md
2026-02-24 20:51:05 - weekly_report - INFO - fetch_section_data:290 - 处理 engagement 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 20:51:05 - weekly_report - INFO - execute_metabase_query:123 - 正在执行Metabase查询...
2026-02-24 20:51:05 - weekly_report - INFO - _execute_via_api:141 - 使用requests库执行Metabase查询...
2026-02-24 20:51:06 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 20:51:10 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 20:51:16 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 20:51:29 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 20:51:53 - weekly_report - WARNING - _execute_via_api:199 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 20:51:53 - weekly_report - INFO - _save_sql_to_md:108 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/engagement_query_2026-02-28.md
2026-02-24 20:51:53 - weekly_report - INFO - fetch_section_data:290 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 20:51:53 - weekly_report - INFO - execute_metabase_query:123 - 正在执行Metabase查询...
2026-02-24 20:51:53 - weekly_report - INFO - _execute_via_api:141 - 使用requests库执行Metabase查询...
2026-02-24 20:51:54 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 20:51:58 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 20:52:04 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 20:52:17 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 20:52:42 - weekly_report - WARNING - _execute_via_api:199 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 20:52:42 - weekly_report - INFO - _save_sql_to_md:108 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/retention_query_2026-02-28.md
2026-02-24 20:52:42 - weekly_report - INFO - fetch_section_data:290 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 20:52:42 - weekly_report - INFO - execute_metabase_query:123 - 正在执行Metabase查询...
2026-02-24 20:52:42 - weekly_report - INFO - _execute_via_api:141 - 使用requests库执行Metabase查询...
2026-02-24 20:52:43 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 20:52:46 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 20:52:53 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 20:53:05 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 20:53:30 - weekly_report - WARNING - _execute_via_api:199 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 20:53:30 - weekly_report - INFO - _save_sql_to_md:108 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/revenue_query_2026-02-28.md
2026-02-24 20:53:30 - weekly_report - INFO - fetch_all_sections:351 - ✅ 数据获取完成
2026-02-24 20:53:30 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 20:53:30 - weekly_report - WARNING - main:219 - ⚠️  5 个部分无数据
2026-02-24 20:53:30 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 20:53:30 - weekly_report - INFO - fetch_all_sections:335 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 20:53:30 - weekly_report - INFO - fetch_section_data:290 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-24 20:53:30 - weekly_report - INFO - execute_metabase_query:123 - 正在执行Metabase查询...
2026-02-24 20:53:30 - weekly_report - INFO - _execute_via_api:141 - 使用requests库执行Metabase查询...
2026-02-24 20:53:30 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 20:53:34 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 20:53:41 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 20:53:53 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 20:54:18 - weekly_report - WARNING - _execute_via_api:199 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 20:54:18 - weekly_report - INFO - _save_sql_to_md:108 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/traffic_query_2026-02-28.md
2026-02-24 20:54:18 - weekly_report - INFO - fetch_section_data:290 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-24 20:54:18 - weekly_report - INFO - execute_metabase_query:123 - 正在执行Metabase查询...
2026-02-24 20:54:18 - weekly_report - INFO - _execute_via_api:141 - 使用requests库执行Metabase查询...
2026-02-24 20:54:18 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 20:54:22 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 20:54:28 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 20:54:41 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 20:55:06 - weekly_report - WARNING - _execute_via_api:199 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 20:55:06 - weekly_report - INFO - _save_sql_to_md:108 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/activation_query_2026-02-28.md
2026-02-24 20:55:06 - weekly_report - INFO - fetch_section_data:290 - 处理 engagement 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 20:55:06 - weekly_report - INFO - execute_metabase_query:123 - 正在执行Metabase查询...
2026-02-24 20:55:06 - weekly_report - INFO - _execute_via_api:141 - 使用requests库执行Metabase查询...
2026-02-24 20:55:06 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 20:55:10 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 20:55:16 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 20:55:29 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 20:55:54 - weekly_report - WARNING - _execute_via_api:199 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 20:55:54 - weekly_report - INFO - _save_sql_to_md:108 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/engagement_query_2026-02-28.md
2026-02-24 20:55:54 - weekly_report - INFO - fetch_section_data:290 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 20:55:54 - weekly_report - INFO - execute_metabase_query:123 - 正在执行Metabase查询...
2026-02-24 20:55:54 - weekly_report - INFO - _execute_via_api:141 - 使用requests库执行Metabase查询...
2026-02-24 20:55:54 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 20:55:58 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 20:56:05 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 20:56:17 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 20:56:42 - weekly_report - WARNING - _execute_via_api:199 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 20:56:42 - weekly_report - INFO - _save_sql_to_md:108 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/retention_query_2026-02-28.md
2026-02-24 20:56:42 - weekly_report - INFO - fetch_section_data:290 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 20:56:42 - weekly_report - INFO - execute_metabase_query:123 - 正在执行Metabase查询...
2026-02-24 20:56:42 - weekly_report - INFO - _execute_via_api:141 - 使用requests库执行Metabase查询...
2026-02-24 20:56:43 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 20:56:46 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 20:56:52 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 20:57:05 - weekly_report - WARNING - _execute_via_api:195 - ⚠️  查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 20:57:29 - weekly_report - WARNING - _execute_via_api:199 - ⚠️  查询执行超时，已重试 5 次
2026-02-24 20:57:29 - weekly_report - INFO - _save_sql_to_md:108 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/revenue_query_2026-02-28.md
2026-02-24 20:57:29 - weekly_report - INFO - fetch_all_sections:351 - ✅ 数据获取完成
2026-02-24 20:57:29 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 20:57:29 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 20:57:29 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 20:57:29 - weekly_report - INFO - analyze_all_sections:383 - 开始分析所有部分...
2026-02-24 20:57:29 - weekly_report - INFO - analyze_all_sections:422 - ✅ 所有部分分析完成
2026-02-24 20:57:29 - weekly_report - INFO - main:240 - 
============================================================
2026-02-24 20:57:29 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-24 20:57:29 - weekly_report - INFO - main:242 - ============================================================
2026-02-24 20:57:29 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-24 20:57:29 - weekly_report - INFO - generate_full_report_html:348 - 生成完整HTML报告...
2026-02-24 20:57:29 - weekly_report - INFO - render_traffic_section:78 - 渲染流量部分...
2026-02-24 20:57:29 - weekly_report - INFO - render_traffic_section:106 - ✅ 流量部分渲染完成
2026-02-24 20:57:29 - weekly_report - INFO - render_activation_section:117 - 渲染激活部分...
2026-02-24 20:57:29 - weekly_report - INFO - render_activation_section:168 - ✅ 激活部分渲染完成
2026-02-24 20:57:29 - weekly_report - INFO - render_engagement_section:179 - 渲染活跃部分...
2026-02-24 20:57:29 - weekly_report - INFO - render_engagement_section:204 - ✅ 活跃部分渲染完成
2026-02-24 20:57:29 - weekly_report - INFO - render_retention_section:215 - 渲染留存部分...
2026-02-24 20:57:29 - weekly_report - INFO - render_retention_section:241 - ✅ 留存部分渲染完成
2026-02-24 20:57:29 - weekly_report - INFO - generate_revenue_section_html:252 - 生成收入部分HTML...
2026-02-24 20:57:29 - weekly_report - INFO - generate_revenue_section_html:285 - ✅ 收入部分HTML生成完成
2026-02-24 20:57:29 - weekly_report - INFO - generate_full_report_html:419 - ✅ 完整HTML报告生成完成
2026-02-24 20:57:29 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-24 20:57:29 - weekly_report - INFO - main:258 - 
============================================================
2026-02-24 20:57:29 - weekly_report - INFO - main:259 - 第四阶段：保存报告到文件
2026-02-24 20:57:29 - weekly_report - INFO - main:260 - ============================================================
2026-02-24 20:57:29 - weekly_report - INFO - save_html_to_file:203 - ✅ HTML已保存到: confluence_report_2026-02-28.html
2026-02-24 20:57:29 - weekly_report - INFO - main:267 - 
============================================================
2026-02-24 20:57:29 - weekly_report - INFO - main:268 - ✅ 报告已保存到本地文件！
2026-02-24 20:57:29 - weekly_report - INFO - main:269 - ============================================================
2026-02-24 20:57:29 - weekly_report - INFO - main:270 - 文件路径: output/confluence_report_2026-02-28.html
2026-02-24 20:57:29 - weekly_report - INFO - main:271 - 报告日期: 2026-02-28
2026-02-24 22:18:02 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 22:18:02 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 22:18:02 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 22:18:02 - weekly_report - INFO - main:164 - 目标周: 指定日期(20260223)
2026-02-24 22:18:02 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 22:18:02 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 22:18:02 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 22:18:04 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 22:18:04 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 22:18:04 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 22:18:04 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 22:18:04 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 22:18:04 - weekly_report - INFO - fetch_all_sections:281 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 22:18:04 - weekly_report - INFO - fetch_section_data:244 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-24 22:18:04 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-24 22:18:05 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 22:18:09 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 22:18:15 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 22:18:28 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 22:18:53 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 143 行数据
2026-02-24 22:18:53 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/traffic_query_2026-02-28.md
2026-02-24 22:18:53 - weekly_report - INFO - fetch_section_data:244 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-24 22:18:53 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-24 22:18:55 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 22:19:00 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 22:19:08 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 22:19:22 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 22:19:48 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 8 行数据
2026-02-24 22:19:48 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/activation_query_2026-02-28.md
2026-02-24 22:19:48 - weekly_report - INFO - fetch_section_data:244 - 处理 engagement 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 22:19:48 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-24 22:19:49 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 22:19:52 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 22:19:59 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 22:20:12 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 22:20:36 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-24 22:20:36 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/engagement_query_2026-02-28.md
2026-02-24 22:20:36 - weekly_report - INFO - fetch_section_data:244 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 22:20:36 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-24 22:20:37 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 22:20:41 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 22:20:48 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 22:21:00 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 22:21:25 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 24 行数据
2026-02-24 22:21:25 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/retention_query_2026-02-28.md
2026-02-24 22:21:25 - weekly_report - INFO - fetch_section_data:244 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 22:21:25 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-24 22:21:26 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 22:21:31 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 22:21:38 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 22:21:52 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 22:22:17 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-24 22:22:17 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/revenue_query_2026-02-28.md
2026-02-24 22:22:17 - weekly_report - INFO - fetch_all_sections:297 - ✅ 数据获取完成
2026-02-24 22:22:17 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 22:22:17 - weekly_report - INFO - main:217 - ✅ 成功获取 5 个部分的数据
2026-02-24 22:22:17 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 22:22:17 - weekly_report - INFO - fetch_all_sections:281 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 22:22:17 - weekly_report - INFO - fetch_section_data:244 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-24 22:22:17 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-24 22:22:18 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 22:22:22 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 22:22:28 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 22:22:41 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 22:23:06 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 143 行数据
2026-02-24 22:23:06 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/traffic_query_2026-02-28.md
2026-02-24 22:23:06 - weekly_report - INFO - fetch_section_data:244 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-24 22:23:06 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-24 22:23:08 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 22:23:13 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 22:23:21 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 22:23:35 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 22:24:01 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 8 行数据
2026-02-24 22:24:01 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/activation_query_2026-02-28.md
2026-02-24 22:24:01 - weekly_report - INFO - fetch_section_data:244 - 处理 engagement 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 22:24:01 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-24 22:24:02 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 22:24:06 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 22:24:12 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 22:24:25 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 22:24:50 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-24 22:24:50 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/engagement_query_2026-02-28.md
2026-02-24 22:24:50 - weekly_report - INFO - fetch_section_data:244 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 22:24:50 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-24 22:24:50 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 22:24:54 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 22:25:01 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 22:25:14 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 22:25:38 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 24 行数据
2026-02-24 22:25:38 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/retention_query_2026-02-28.md
2026-02-24 22:25:38 - weekly_report - INFO - fetch_section_data:244 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 22:25:38 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-24 22:25:40 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 22:25:44 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 22:25:51 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 22:26:05 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 22:26:30 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-24 22:26:30 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/revenue_query_2026-02-28.md
2026-02-24 22:26:30 - weekly_report - INFO - fetch_all_sections:297 - ✅ 数据获取完成
2026-02-24 22:26:30 - weekly_report - INFO - main:226 - 
============================================================
2026-02-24 22:26:30 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-24 22:26:30 - weekly_report - INFO - main:228 - ============================================================
2026-02-24 22:26:30 - weekly_report - INFO - analyze_all_sections:383 - 开始分析所有部分...
2026-02-24 22:26:30 - weekly_report - INFO - analyze_traffic_data:82 - 分析流量数据...
2026-02-24 22:26:30 - weekly_report - INFO - analyze_traffic_data:113 - ✅ 流量数据分析完成: 总新访客 1,991,694 人，- +0.0%
2026-02-24 22:26:30 - weekly_report - INFO - analyze_activation_data:166 - 分析激活数据...
2026-02-24 22:26:30 - weekly_report - ERROR - main:300 - 
❌ 执行过程中出现异常: unsupported format string passed to NoneType.__format__
Traceback (most recent call last):
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/main.py", line 231, in main
    analysis_results = analyzer.analyze_all_sections(current_data, previous_data)
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/src/data_analyzer.py", line 396, in analyze_all_sections
    results['activation'] = self.analyze_activation_data(
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/src/data_analyzer.py", line 224, in analyze_activation_data
    'summary': f"总转化率 {total_current:.2f}%，{total_wow['trend']} {total_wow['change_rate']:+.2f}%"
TypeError: unsupported format string passed to NoneType.__format__
2026-02-24 23:05:51 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 23:05:51 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 23:05:51 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 23:05:51 - weekly_report - INFO - main:164 - 目标周: 指定日期(20260223)
2026-02-24 23:05:51 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 23:05:51 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 23:05:51 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 23:05:53 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 23:05:53 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 23:05:53 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 23:05:53 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 23:05:53 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 23:05:53 - weekly_report - INFO - fetch_all_sections:281 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 23:05:53 - weekly_report - INFO - fetch_section_data:244 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-24 23:05:53 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-24 23:05:54 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 23:05:57 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 23:06:04 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 23:06:17 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 23:06:41 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 143 行数据
2026-02-24 23:06:41 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/traffic_query_2026-02-28.md
2026-02-24 23:06:41 - weekly_report - INFO - fetch_section_data:244 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-24 23:06:41 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-24 23:06:43 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 23:06:48 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 23:06:56 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 23:07:10 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 23:07:37 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 8 行数据
2026-02-24 23:07:37 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/activation_query_2026-02-28.md
2026-02-24 23:07:37 - weekly_report - INFO - fetch_section_data:244 - 处理 engagement 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 23:07:37 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-24 23:07:37 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 23:07:41 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 23:07:48 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 23:08:01 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 23:08:26 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-24 23:08:26 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/engagement_query_2026-02-28.md
2026-02-24 23:08:26 - weekly_report - INFO - fetch_section_data:244 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 23:08:26 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-24 23:08:27 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 23:08:30 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 23:08:37 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 23:34:54 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 23:34:54 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 23:34:54 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 23:34:54 - weekly_report - INFO - main:164 - 目标周: 指定日期(20260223)
2026-02-24 23:34:54 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 23:34:54 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 23:34:54 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 23:34:56 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 23:34:56 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 23:34:56 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 23:34:56 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 23:34:56 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 23:34:56 - weekly_report - INFO - fetch_all_sections:281 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 23:34:56 - weekly_report - INFO - fetch_section_data:244 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-24 23:34:56 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-24 23:34:57 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 23:35:01 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 23:35:07 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 23:35:20 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 23:41:02 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 23:41:02 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 23:41:02 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 23:41:02 - weekly_report - INFO - main:164 - 目标周: 指定日期(20260223)
2026-02-24 23:41:02 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 23:41:02 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 23:41:02 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 23:41:04 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 23:41:04 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 23:41:04 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 23:41:04 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 23:41:04 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 23:41:04 - weekly_report - INFO - fetch_all_sections:281 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 23:41:04 - weekly_report - INFO - fetch_section_data:244 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-24 23:41:04 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-24 23:41:05 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 23:41:09 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 23:41:15 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 23:41:27 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 23:41:52 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 0 行数据
2026-02-24 23:41:52 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/traffic_query_2026-02-28.md
2026-02-24 23:41:52 - weekly_report - INFO - fetch_section_data:244 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-24 23:41:52 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-24 23:41:54 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 23:41:59 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 23:42:07 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 23:42:21 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 23:42:47 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 8 行数据
2026-02-24 23:42:47 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/activation_query_2026-02-28.md
2026-02-24 23:42:47 - weekly_report - INFO - fetch_section_data:244 - 处理 engagement 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-24 23:42:47 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-24 23:42:47 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 23:42:51 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 23:42:59 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 23:43:12 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 23:43:37 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-24 23:43:37 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/engagement_query_2026-02-28.md
2026-02-24 23:43:37 - weekly_report - INFO - fetch_section_data:244 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-24 23:43:37 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-24 23:43:37 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 23:43:41 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 23:43:48 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 23:44:00 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 23:44:25 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 24 行数据
2026-02-24 23:44:25 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/retention_query_2026-02-28.md
2026-02-24 23:44:25 - weekly_report - INFO - fetch_section_data:244 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-24 23:44:25 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-24 23:44:27 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 23:44:31 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 23:44:39 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 23:44:52 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 23:45:17 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-24 23:45:17 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/revenue_query_2026-02-28.md
2026-02-24 23:45:17 - weekly_report - INFO - fetch_all_sections:297 - ✅ 数据获取完成
2026-02-24 23:45:17 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-24 23:45:17 - weekly_report - INFO - main:217 - ✅ 成功获取 4 个部分的数据
2026-02-24 23:45:17 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-24 23:45:17 - weekly_report - INFO - fetch_all_sections:281 - 开始获取所有部分数据（周偏移: -1）...
2026-02-24 23:45:17 - weekly_report - INFO - fetch_section_data:244 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-24 23:45:17 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-24 23:45:17 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 23:45:21 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 23:45:27 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 23:45:29 - weekly_report - INFO - main:155 - ============================================================
2026-02-24 23:45:29 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-24 23:45:29 - weekly_report - INFO - main:157 - ============================================================
2026-02-24 23:45:29 - weekly_report - INFO - main:164 - 目标周: 指定日期(20260223)
2026-02-24 23:45:29 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-24 23:45:29 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-24 23:45:29 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-24 23:45:31 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-24 23:45:31 - weekly_report - INFO - main:205 - 
============================================================
2026-02-24 23:45:31 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-24 23:45:31 - weekly_report - INFO - main:207 - ============================================================
2026-02-24 23:45:31 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-24 23:45:31 - weekly_report - INFO - fetch_all_sections:281 - 开始获取所有部分数据（周偏移: 0）...
2026-02-24 23:45:31 - weekly_report - INFO - fetch_section_data:244 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-24 23:45:31 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-24 23:45:31 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-24 23:45:35 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-24 23:45:40 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-24 23:45:41 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-24 23:45:54 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 00:18:11 - weekly_report - ERROR - execute_metabase_query:211 - ❌ API请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/dataset (Caused by NewConnectionError("HTTPSConnection(host='kmb.qunhequnhe.com', port=443): Failed to establish a new connection: [Errno 60] Operation timed out"))
2026-02-25 00:18:11 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/traffic_query_2026-02-28.md
2026-02-25 00:18:11 - weekly_report - INFO - fetch_section_data:244 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-25 00:18:11 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 00:31:20 - weekly_report - ERROR - execute_metabase_query:211 - ❌ API请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/dataset (Caused by NameResolutionError("HTTPSConnection(host='kmb.qunhequnhe.com', port=443): Failed to resolve 'kmb.qunhequnhe.com' ([Errno 8] nodename nor servname provided, or not known)"))
2026-02-25 00:31:20 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/activation_query_2026-02-28.md
2026-02-25 00:31:20 - weekly_report - INFO - fetch_section_data:244 - 处理 engagement 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-25 00:31:20 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 00:31:20 - weekly_report - ERROR - execute_metabase_query:211 - ❌ API请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/dataset (Caused by NameResolutionError("HTTPSConnection(host='kmb.qunhequnhe.com', port=443): Failed to resolve 'kmb.qunhequnhe.com' ([Errno 8] nodename nor servname provided, or not known)"))
2026-02-25 00:31:20 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/engagement_query_2026-02-28.md
2026-02-25 00:31:20 - weekly_report - INFO - fetch_section_data:244 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-25 00:31:20 - weekly_report - ERROR - execute_metabase_query:211 - ❌ API请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/dataset (Caused by NameResolutionError("HTTPSConnection(host='kmb.qunhequnhe.com', port=443): Failed to resolve 'kmb.qunhequnhe.com' ([Errno 8] nodename nor servname provided, or not known)"))
2026-02-25 00:31:20 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 00:31:20 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/traffic_query_2026-02-28.md
2026-02-25 00:31:20 - weekly_report - INFO - fetch_section_data:244 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-25 00:31:20 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 00:31:20 - weekly_report - ERROR - execute_metabase_query:211 - ❌ API请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/dataset (Caused by NameResolutionError("HTTPSConnection(host='kmb.qunhequnhe.com', port=443): Failed to resolve 'kmb.qunhequnhe.com' ([Errno 8] nodename nor servname provided, or not known)"))
2026-02-25 00:31:20 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/activation_query_2026-02-28.md
2026-02-25 00:31:20 - weekly_report - INFO - fetch_section_data:244 - 处理 engagement 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-25 00:31:20 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 00:31:20 - weekly_report - ERROR - execute_metabase_query:211 - ❌ API请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/dataset (Caused by NameResolutionError("HTTPSConnection(host='kmb.qunhequnhe.com', port=443): Failed to resolve 'kmb.qunhequnhe.com' ([Errno 8] nodename nor servname provided, or not known)"))
2026-02-25 00:31:20 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/retention_query_2026-02-28.md
2026-02-25 00:31:20 - weekly_report - INFO - fetch_section_data:244 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-25 00:31:20 - weekly_report - ERROR - execute_metabase_query:211 - ❌ API请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/dataset (Caused by NameResolutionError("HTTPSConnection(host='kmb.qunhequnhe.com', port=443): Failed to resolve 'kmb.qunhequnhe.com' ([Errno 8] nodename nor servname provided, or not known)"))
2026-02-25 00:31:20 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 00:31:20 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/engagement_query_2026-02-28.md
2026-02-25 00:31:20 - weekly_report - INFO - fetch_section_data:244 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-25 00:31:20 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 00:31:20 - weekly_report - ERROR - execute_metabase_query:211 - ❌ API请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/dataset (Caused by NameResolutionError("HTTPSConnection(host='kmb.qunhequnhe.com', port=443): Failed to resolve 'kmb.qunhequnhe.com' ([Errno 8] nodename nor servname provided, or not known)"))
2026-02-25 00:31:20 - weekly_report - ERROR - execute_metabase_query:211 - ❌ API请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/dataset (Caused by NameResolutionError("HTTPSConnection(host='kmb.qunhequnhe.com', port=443): Failed to resolve 'kmb.qunhequnhe.com' ([Errno 8] nodename nor servname provided, or not known)"))
2026-02-25 00:31:20 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/revenue_query_2026-02-28.md
2026-02-25 00:31:20 - weekly_report - INFO - fetch_all_sections:297 - ✅ 数据获取完成
2026-02-25 00:31:20 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/retention_query_2026-02-28.md
2026-02-25 00:31:20 - weekly_report - INFO - main:226 - 
============================================================
2026-02-25 00:31:20 - weekly_report - INFO - fetch_section_data:244 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-25 00:31:20 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-25 00:31:20 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 00:31:20 - weekly_report - INFO - main:228 - ============================================================
2026-02-25 00:31:20 - weekly_report - INFO - analyze_all_sections:383 - 开始分析所有部分...
2026-02-25 00:31:20 - weekly_report - INFO - analyze_activation_data:166 - 分析激活数据...
2026-02-25 00:31:20 - weekly_report - ERROR - main:300 - 
❌ 执行过程中出现异常: unsupported format string passed to NoneType.__format__
Traceback (most recent call last):
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/main.py", line 231, in main
    analysis_results = analyzer.analyze_all_sections(current_data, previous_data)
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/src/data_analyzer.py", line 396, in analyze_all_sections
    results['activation'] = self.analyze_activation_data(
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/src/data_analyzer.py", line 224, in analyze_activation_data
    'summary': f"总转化率 {total_current:.2f}%，{total_wow['trend']} {total_wow['change_rate']:+.2f}%"
TypeError: unsupported format string passed to NoneType.__format__
2026-02-25 00:31:20 - weekly_report - ERROR - execute_metabase_query:211 - ❌ API请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/dataset (Caused by NameResolutionError("HTTPSConnection(host='kmb.qunhequnhe.com', port=443): Failed to resolve 'kmb.qunhequnhe.com' ([Errno 8] nodename nor servname provided, or not known)"))
2026-02-25 00:31:20 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/revenue_query_2026-02-28.md
2026-02-25 00:31:20 - weekly_report - INFO - fetch_all_sections:297 - ✅ 数据获取完成
2026-02-25 00:31:20 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-25 00:31:20 - weekly_report - WARNING - main:219 - ⚠️  5 个部分无数据
2026-02-25 00:31:20 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-25 00:31:20 - weekly_report - INFO - fetch_all_sections:281 - 开始获取所有部分数据（周偏移: -1）...
2026-02-25 00:31:20 - weekly_report - INFO - fetch_section_data:244 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-25 00:31:20 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 00:31:20 - weekly_report - ERROR - execute_metabase_query:211 - ❌ API请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/dataset (Caused by NameResolutionError("HTTPSConnection(host='kmb.qunhequnhe.com', port=443): Failed to resolve 'kmb.qunhequnhe.com' ([Errno 8] nodename nor servname provided, or not known)"))
2026-02-25 00:31:20 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/traffic_query_2026-02-28.md
2026-02-25 00:31:20 - weekly_report - INFO - fetch_section_data:244 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-25 00:31:20 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 00:31:20 - weekly_report - ERROR - execute_metabase_query:211 - ❌ API请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/dataset (Caused by NameResolutionError("HTTPSConnection(host='kmb.qunhequnhe.com', port=443): Failed to resolve 'kmb.qunhequnhe.com' ([Errno 8] nodename nor servname provided, or not known)"))
2026-02-25 00:31:20 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/activation_query_2026-02-28.md
2026-02-25 00:31:20 - weekly_report - INFO - fetch_section_data:244 - 处理 engagement 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-25 00:31:20 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 00:31:20 - weekly_report - ERROR - execute_metabase_query:211 - ❌ API请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/dataset (Caused by NameResolutionError("HTTPSConnection(host='kmb.qunhequnhe.com', port=443): Failed to resolve 'kmb.qunhequnhe.com' ([Errno 8] nodename nor servname provided, or not known)"))
2026-02-25 00:31:20 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/engagement_query_2026-02-28.md
2026-02-25 00:31:20 - weekly_report - INFO - fetch_section_data:244 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-25 00:31:20 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 00:31:20 - weekly_report - ERROR - execute_metabase_query:211 - ❌ API请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/dataset (Caused by NameResolutionError("HTTPSConnection(host='kmb.qunhequnhe.com', port=443): Failed to resolve 'kmb.qunhequnhe.com' ([Errno 8] nodename nor servname provided, or not known)"))
2026-02-25 00:31:20 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/retention_query_2026-02-28.md
2026-02-25 00:31:20 - weekly_report - INFO - fetch_section_data:244 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-25 00:31:20 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 00:31:20 - weekly_report - ERROR - execute_metabase_query:211 - ❌ API请求异常: HTTPSConnectionPool(host='kmb.qunhequnhe.com', port=443): Max retries exceeded with url: /api/dataset (Caused by NameResolutionError("HTTPSConnection(host='kmb.qunhequnhe.com', port=443): Failed to resolve 'kmb.qunhequnhe.com' ([Errno 8] nodename nor servname provided, or not known)"))
2026-02-25 00:31:20 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/revenue_query_2026-02-28.md
2026-02-25 00:31:20 - weekly_report - INFO - fetch_all_sections:297 - ✅ 数据获取完成
2026-02-25 00:31:20 - weekly_report - INFO - main:226 - 
============================================================
2026-02-25 00:31:20 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-25 00:31:20 - weekly_report - INFO - main:228 - ============================================================
2026-02-25 00:31:20 - weekly_report - INFO - analyze_all_sections:383 - 开始分析所有部分...
2026-02-25 00:31:20 - weekly_report - INFO - analyze_all_sections:422 - ✅ 所有部分分析完成
2026-02-25 00:31:20 - weekly_report - INFO - main:240 - 
============================================================
2026-02-25 00:31:20 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-25 00:31:20 - weekly_report - INFO - main:242 - ============================================================
2026-02-25 00:31:20 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-25 00:31:20 - weekly_report - INFO - generate_full_report_html:348 - 生成完整HTML报告...
2026-02-25 00:31:20 - weekly_report - INFO - render_traffic_section:78 - 渲染流量部分...
2026-02-25 00:31:20 - weekly_report - INFO - render_traffic_section:106 - ✅ 流量部分渲染完成
2026-02-25 00:31:20 - weekly_report - INFO - render_activation_section:117 - 渲染激活部分...
2026-02-25 00:31:20 - weekly_report - INFO - render_activation_section:168 - ✅ 激活部分渲染完成
2026-02-25 00:31:20 - weekly_report - INFO - render_engagement_section:179 - 渲染活跃部分...
2026-02-25 00:31:20 - weekly_report - INFO - render_engagement_section:204 - ✅ 活跃部分渲染完成
2026-02-25 00:31:20 - weekly_report - INFO - render_retention_section:215 - 渲染留存部分...
2026-02-25 00:31:20 - weekly_report - INFO - render_retention_section:241 - ✅ 留存部分渲染完成
2026-02-25 00:31:20 - weekly_report - INFO - generate_revenue_section_html:252 - 生成收入部分HTML...
2026-02-25 00:31:20 - weekly_report - INFO - generate_revenue_section_html:285 - ✅ 收入部分HTML生成完成
2026-02-25 00:31:20 - weekly_report - INFO - generate_full_report_html:419 - ✅ 完整HTML报告生成完成
2026-02-25 00:31:20 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-25 00:31:20 - weekly_report - INFO - main:258 - 
============================================================
2026-02-25 00:31:20 - weekly_report - INFO - main:259 - 第四阶段：保存报告到文件
2026-02-25 00:31:20 - weekly_report - INFO - main:260 - ============================================================
2026-02-25 00:31:20 - weekly_report - INFO - save_html_to_file:203 - ✅ HTML已保存到: confluence_report_2026-02-28.html
2026-02-25 00:31:20 - weekly_report - INFO - main:267 - 
============================================================
2026-02-25 00:31:20 - weekly_report - INFO - main:268 - ✅ 报告已保存到本地文件！
2026-02-25 00:31:20 - weekly_report - INFO - main:269 - ============================================================
2026-02-25 00:31:20 - weekly_report - INFO - main:270 - 文件路径: output/confluence_report_2026-02-28.html
2026-02-25 00:31:20 - weekly_report - INFO - main:271 - 报告日期: 2026-02-28
2026-02-25 09:57:22 - weekly_report - INFO - main:155 - ============================================================
2026-02-25 09:57:22 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-25 09:57:22 - weekly_report - INFO - main:157 - ============================================================
2026-02-25 09:57:22 - weekly_report - INFO - main:164 - 目标周: 指定日期(20260223)
2026-02-25 09:57:22 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-25 09:57:22 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-25 09:57:22 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-25 09:57:24 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-25 09:57:24 - weekly_report - INFO - main:205 - 
============================================================
2026-02-25 09:57:24 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-25 09:57:24 - weekly_report - INFO - main:207 - ============================================================
2026-02-25 09:57:24 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-25 09:57:24 - weekly_report - INFO - fetch_all_sections:281 - 开始获取所有部分数据（周偏移: 0）...
2026-02-25 09:57:24 - weekly_report - INFO - fetch_section_data:244 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-25 09:57:24 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 09:57:25 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 09:57:28 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 09:57:34 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 09:57:47 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 09:58:11 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 0 行数据
2026-02-25 09:58:11 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/traffic_query_2026-02-28.md
2026-02-25 09:58:11 - weekly_report - INFO - fetch_section_data:244 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-25 09:58:11 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 09:58:14 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 09:58:19 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 09:58:27 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 09:58:41 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 09:59:06 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 8 行数据
2026-02-25 09:59:06 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/activation_query_2026-02-28.md
2026-02-25 09:59:06 - weekly_report - INFO - fetch_section_data:244 - 处理 engagement 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-25 09:59:06 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 09:59:07 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 09:59:10 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 09:59:17 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 09:59:29 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 09:59:54 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-25 09:59:54 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/engagement_query_2026-02-28.md
2026-02-25 09:59:54 - weekly_report - INFO - fetch_section_data:244 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-25 09:59:54 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 09:59:55 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 09:59:58 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:00:05 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:00:17 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:00:53 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 24 行数据
2026-02-25 10:00:53 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/retention_query_2026-02-28.md
2026-02-25 10:00:53 - weekly_report - INFO - fetch_section_data:244 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-25 10:00:53 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:00:55 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:00:59 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:01:06 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:01:20 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:01:45 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-25 10:01:45 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/revenue_query_2026-02-28.md
2026-02-25 10:01:45 - weekly_report - INFO - fetch_all_sections:297 - ✅ 数据获取完成
2026-02-25 10:01:45 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-25 10:01:45 - weekly_report - INFO - main:217 - ✅ 成功获取 4 个部分的数据
2026-02-25 10:01:45 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-25 10:01:45 - weekly_report - INFO - fetch_all_sections:281 - 开始获取所有部分数据（周偏移: -1）...
2026-02-25 10:01:45 - weekly_report - INFO - fetch_section_data:244 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-25 10:01:45 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:01:45 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:01:49 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:01:55 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:02:07 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:02:32 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 0 行数据
2026-02-25 10:02:32 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/traffic_query_2026-02-28.md
2026-02-25 10:02:32 - weekly_report - INFO - fetch_section_data:244 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-25 10:02:32 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:02:34 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:02:38 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:02:46 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:03:00 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:03:26 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 8 行数据
2026-02-25 10:03:26 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/activation_query_2026-02-28.md
2026-02-25 10:03:26 - weekly_report - INFO - fetch_section_data:244 - 处理 engagement 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-25 10:03:26 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:03:26 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:03:30 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:03:36 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:03:49 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:04:13 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-25 10:04:13 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/engagement_query_2026-02-28.md
2026-02-25 10:04:13 - weekly_report - INFO - fetch_section_data:244 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-25 10:04:13 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:04:14 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:04:17 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:04:24 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:04:37 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:05:02 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 24 行数据
2026-02-25 10:05:02 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/retention_query_2026-02-28.md
2026-02-25 10:05:02 - weekly_report - INFO - fetch_section_data:244 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-25 10:05:02 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:05:03 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:05:07 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:05:14 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:05:27 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:05:52 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-25 10:05:52 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/revenue_query_2026-02-28.md
2026-02-25 10:05:52 - weekly_report - INFO - fetch_all_sections:297 - ✅ 数据获取完成
2026-02-25 10:05:52 - weekly_report - INFO - main:226 - 
============================================================
2026-02-25 10:05:52 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-25 10:05:52 - weekly_report - INFO - main:228 - ============================================================
2026-02-25 10:05:52 - weekly_report - INFO - analyze_all_sections:383 - 开始分析所有部分...
2026-02-25 10:05:52 - weekly_report - INFO - analyze_activation_data:166 - 分析激活数据...
2026-02-25 10:05:52 - weekly_report - ERROR - main:300 - 
❌ 执行过程中出现异常: unsupported format string passed to NoneType.__format__
Traceback (most recent call last):
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/main.py", line 231, in main
    analysis_results = analyzer.analyze_all_sections(current_data, previous_data)
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/src/data_analyzer.py", line 396, in analyze_all_sections
    results['activation'] = self.analyze_activation_data(
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/src/data_analyzer.py", line 224, in analyze_activation_data
    'summary': f"总转化率 {total_current:.2f}%，{total_wow['trend']} {total_wow['change_rate']:+.2f}%"
TypeError: unsupported format string passed to NoneType.__format__
2026-02-25 10:16:08 - weekly_report - INFO - main:155 - ============================================================
2026-02-25 10:16:08 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-25 10:16:08 - weekly_report - INFO - main:157 - ============================================================
2026-02-25 10:16:08 - weekly_report - INFO - main:164 - 目标周: 指定日期(20260223)
2026-02-25 10:16:08 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-25 10:16:08 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-25 10:16:08 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-25 10:16:10 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-25 10:16:10 - weekly_report - INFO - main:205 - 
============================================================
2026-02-25 10:16:10 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-25 10:16:10 - weekly_report - INFO - main:207 - ============================================================
2026-02-25 10:16:10 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-25 10:16:10 - weekly_report - INFO - fetch_all_sections:281 - 开始获取所有部分数据（周偏移: 0）...
2026-02-25 10:16:10 - weekly_report - INFO - fetch_section_data:244 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-25 10:16:10 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:16:10 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:16:14 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:16:20 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:16:32 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:16:57 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 0 行数据
2026-02-25 10:16:57 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/traffic_query_2026-02-28.md
2026-02-25 10:16:57 - weekly_report - INFO - fetch_section_data:244 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-25 10:16:57 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:17:07 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:17:12 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:17:20 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:17:34 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:17:59 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 8 行数据
2026-02-25 10:17:59 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/activation_query_2026-02-28.md
2026-02-25 10:17:59 - weekly_report - INFO - fetch_section_data:244 - 处理 engagement 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-25 10:17:59 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:18:00 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:18:04 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:18:10 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:18:23 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:18:47 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-25 10:18:47 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/engagement_query_2026-02-28.md
2026-02-25 10:18:47 - weekly_report - INFO - fetch_section_data:244 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-25 10:18:47 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:18:48 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:18:52 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:18:58 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:19:11 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:19:36 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 24 行数据
2026-02-25 10:19:36 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/retention_query_2026-02-28.md
2026-02-25 10:19:36 - weekly_report - INFO - fetch_section_data:244 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-25 10:19:36 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:19:37 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:19:41 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:19:48 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:20:03 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:20:29 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-25 10:20:29 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/revenue_query_2026-02-28.md
2026-02-25 10:20:29 - weekly_report - INFO - fetch_all_sections:297 - ✅ 数据获取完成
2026-02-25 10:20:29 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-25 10:20:29 - weekly_report - INFO - main:217 - ✅ 成功获取 4 个部分的数据
2026-02-25 10:20:29 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-25 10:20:29 - weekly_report - INFO - fetch_all_sections:281 - 开始获取所有部分数据（周偏移: -1）...
2026-02-25 10:20:29 - weekly_report - INFO - fetch_section_data:244 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-25 10:20:29 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:20:31 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:20:34 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:20:40 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:20:53 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:21:17 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 0 行数据
2026-02-25 10:21:17 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/traffic_query_2026-02-28.md
2026-02-25 10:21:17 - weekly_report - INFO - fetch_section_data:244 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-25 10:21:17 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:21:19 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:21:25 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:21:33 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:21:47 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:22:13 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 8 行数据
2026-02-25 10:22:13 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/activation_query_2026-02-28.md
2026-02-25 10:22:13 - weekly_report - INFO - fetch_section_data:244 - 处理 engagement 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-25 10:22:13 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:22:14 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:22:17 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:22:25 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:22:37 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:23:03 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-25 10:23:03 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/engagement_query_2026-02-28.md
2026-02-25 10:23:03 - weekly_report - INFO - fetch_section_data:244 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-25 10:23:03 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:23:04 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:23:07 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:23:14 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:23:26 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:23:51 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 24 行数据
2026-02-25 10:23:51 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/retention_query_2026-02-28.md
2026-02-25 10:23:51 - weekly_report - INFO - fetch_section_data:244 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-25 10:23:51 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:23:52 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:23:56 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:24:04 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:24:17 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:24:42 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-25 10:24:42 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/revenue_query_2026-02-28.md
2026-02-25 10:24:42 - weekly_report - INFO - fetch_all_sections:297 - ✅ 数据获取完成
2026-02-25 10:24:42 - weekly_report - INFO - main:226 - 
============================================================
2026-02-25 10:24:42 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-25 10:24:42 - weekly_report - INFO - main:228 - ============================================================
2026-02-25 10:24:42 - weekly_report - ERROR - main:300 - 
❌ 执行过程中出现异常: unsupported format string passed to NoneType.__format__
Traceback (most recent call last):
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/main.py", line 231, in main
    analysis_results = analyzer.analyze_all_sections(current_data, previous_data)
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/src/data_analyzer.py", line 63, in analyze_all_sections
    results['engagement'] = self.analyze_engagement_data(
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/src/data_analyzer.py", line 412, in analyze_engagement_data
    'summary': f"工具WAU {total_wau_current:,.0f}，{trend} {change_rate:+.1f}%"
TypeError: unsupported format string passed to NoneType.__format__
2026-02-25 10:25:55 - weekly_report - INFO - main:155 - ============================================================
2026-02-25 10:25:55 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-25 10:25:55 - weekly_report - INFO - main:157 - ============================================================
2026-02-25 10:25:55 - weekly_report - INFO - main:164 - 目标周: 指定日期(20260223)
2026-02-25 10:25:55 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-25 10:25:55 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-25 10:25:55 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-25 10:25:57 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-25 10:25:57 - weekly_report - INFO - main:205 - 
============================================================
2026-02-25 10:25:57 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-25 10:25:57 - weekly_report - INFO - main:207 - ============================================================
2026-02-25 10:25:57 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-25 10:25:57 - weekly_report - INFO - fetch_all_sections:281 - 开始获取所有部分数据（周偏移: 0）...
2026-02-25 10:25:57 - weekly_report - INFO - fetch_section_data:244 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-25 10:25:57 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:25:57 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:26:01 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:26:07 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:26:19 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:26:44 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 0 行数据
2026-02-25 10:26:44 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/traffic_query_2026-02-28.md
2026-02-25 10:26:44 - weekly_report - INFO - fetch_section_data:244 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-25 10:26:44 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:26:46 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:26:51 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:26:59 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:27:13 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:27:39 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 8 行数据
2026-02-25 10:27:39 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/activation_query_2026-02-28.md
2026-02-25 10:27:39 - weekly_report - INFO - fetch_section_data:244 - 处理 engagement 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-25 10:27:39 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:27:39 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:27:43 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:27:49 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:28:02 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:28:27 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-25 10:28:27 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/engagement_query_2026-02-28.md
2026-02-25 10:28:27 - weekly_report - INFO - fetch_section_data:244 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-25 10:28:27 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:28:27 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:28:31 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:28:37 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:28:50 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:29:14 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 24 行数据
2026-02-25 10:29:14 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/retention_query_2026-02-28.md
2026-02-25 10:29:14 - weekly_report - INFO - fetch_section_data:244 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-25 10:29:14 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:29:15 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:29:20 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:29:27 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:29:40 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:30:06 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-25 10:30:06 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/revenue_query_2026-02-28.md
2026-02-25 10:30:06 - weekly_report - INFO - fetch_all_sections:297 - ✅ 数据获取完成
2026-02-25 10:30:06 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-25 10:30:06 - weekly_report - INFO - main:217 - ✅ 成功获取 4 个部分的数据
2026-02-25 10:30:06 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-25 10:30:06 - weekly_report - INFO - fetch_all_sections:281 - 开始获取所有部分数据（周偏移: -1）...
2026-02-25 10:30:06 - weekly_report - INFO - fetch_section_data:244 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-25 10:30:06 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:30:06 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:30:09 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:30:16 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:30:28 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:30:52 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 0 行数据
2026-02-25 10:30:52 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/traffic_query_2026-02-28.md
2026-02-25 10:30:52 - weekly_report - INFO - fetch_section_data:244 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-25 10:30:52 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:30:54 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:31:01 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:31:08 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:31:22 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:31:49 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 8 行数据
2026-02-25 10:31:49 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/activation_query_2026-02-28.md
2026-02-25 10:31:49 - weekly_report - INFO - fetch_section_data:244 - 处理 engagement 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-25 10:31:49 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:31:50 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:31:53 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:32:00 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:32:13 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:32:37 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-25 10:32:37 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/engagement_query_2026-02-28.md
2026-02-25 10:32:37 - weekly_report - INFO - fetch_section_data:244 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-25 10:32:37 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:32:39 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:32:43 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:32:50 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:33:02 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:33:27 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 24 行数据
2026-02-25 10:33:27 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/retention_query_2026-02-28.md
2026-02-25 10:33:27 - weekly_report - INFO - fetch_section_data:244 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-25 10:33:27 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:33:29 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:33:33 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:33:40 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:33:54 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:34:21 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-25 10:34:21 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/revenue_query_2026-02-28.md
2026-02-25 10:34:21 - weekly_report - INFO - fetch_all_sections:297 - ✅ 数据获取完成
2026-02-25 10:34:21 - weekly_report - INFO - main:226 - 
============================================================
2026-02-25 10:34:21 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-25 10:34:21 - weekly_report - INFO - main:228 - ============================================================
2026-02-25 10:34:21 - weekly_report - ERROR - main:300 - 
❌ 执行过程中出现异常: unsupported format string passed to NoneType.__format__
Traceback (most recent call last):
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/main.py", line 231, in main
    analysis_results = analyzer.analyze_all_sections(current_data, previous_data)
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/src/data_analyzer.py", line 77, in analyze_all_sections
    results['revenue'] = self.analyze_revenue_data(
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/src/data_analyzer.py", line 582, in analyze_revenue_data
    'summary': f"总收入 {total_amount:.2f}，环比{total_amount_wow.get('trend', 'N/A') if total_amount_wow else 'N/A'} {total_amount_wow.get('change_rate', 0) if total_amount_wow else 0:+.2f}%"
TypeError: unsupported format string passed to NoneType.__format__
2026-02-25 10:35:10 - weekly_report - INFO - main:155 - ============================================================
2026-02-25 10:35:10 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-25 10:35:10 - weekly_report - INFO - main:157 - ============================================================
2026-02-25 10:35:10 - weekly_report - INFO - main:164 - 目标周: 指定日期(20260223)
2026-02-25 10:35:10 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-25 10:35:10 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-25 10:35:10 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-25 10:35:12 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-25 10:35:12 - weekly_report - INFO - main:205 - 
============================================================
2026-02-25 10:35:12 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-25 10:35:12 - weekly_report - INFO - main:207 - ============================================================
2026-02-25 10:35:12 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-25 10:35:12 - weekly_report - INFO - fetch_all_sections:281 - 开始获取所有部分数据（周偏移: 0）...
2026-02-25 10:35:12 - weekly_report - INFO - fetch_section_data:244 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-25 10:35:12 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:35:12 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:35:16 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:35:23 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:35:35 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:36:00 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 0 行数据
2026-02-25 10:36:00 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/traffic_query_2026-02-28.md
2026-02-25 10:36:00 - weekly_report - INFO - fetch_section_data:244 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-25 10:36:00 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:36:02 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:36:07 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:36:15 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:36:29 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:36:55 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 8 行数据
2026-02-25 10:36:55 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/activation_query_2026-02-28.md
2026-02-25 10:36:55 - weekly_report - INFO - fetch_section_data:244 - 处理 engagement 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-25 10:36:55 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:36:55 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:36:59 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:37:06 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:37:18 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:37:43 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-25 10:37:43 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/engagement_query_2026-02-28.md
2026-02-25 10:37:43 - weekly_report - INFO - fetch_section_data:244 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-25 10:37:43 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:37:44 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:37:48 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:37:55 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:38:08 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:38:33 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 24 行数据
2026-02-25 10:38:33 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/retention_query_2026-02-28.md
2026-02-25 10:38:33 - weekly_report - INFO - fetch_section_data:244 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-25 10:38:33 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:38:35 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:38:40 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:38:47 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:39:00 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:39:26 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-25 10:39:26 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/revenue_query_2026-02-28.md
2026-02-25 10:39:26 - weekly_report - INFO - fetch_all_sections:297 - ✅ 数据获取完成
2026-02-25 10:39:26 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-25 10:39:26 - weekly_report - INFO - main:217 - ✅ 成功获取 4 个部分的数据
2026-02-25 10:39:26 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-25 10:39:26 - weekly_report - INFO - fetch_all_sections:281 - 开始获取所有部分数据（周偏移: -1）...
2026-02-25 10:39:26 - weekly_report - INFO - fetch_section_data:244 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-25 10:39:26 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:39:27 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:39:30 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:39:37 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:39:49 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:40:14 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 0 行数据
2026-02-25 10:40:14 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/traffic_query_2026-02-28.md
2026-02-25 10:40:14 - weekly_report - INFO - fetch_section_data:244 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-25 10:40:14 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:40:16 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:40:21 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:40:29 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:40:43 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:41:09 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 8 行数据
2026-02-25 10:41:09 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/activation_query_2026-02-28.md
2026-02-25 10:41:09 - weekly_report - INFO - fetch_section_data:244 - 处理 engagement 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-25 10:41:09 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:41:10 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:41:14 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:41:20 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:41:33 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:41:58 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-25 10:41:58 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/engagement_query_2026-02-28.md
2026-02-25 10:41:58 - weekly_report - INFO - fetch_section_data:244 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-25 10:41:58 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:41:58 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:42:02 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:42:09 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:42:21 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:42:47 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 24 行数据
2026-02-25 10:42:47 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/retention_query_2026-02-28.md
2026-02-25 10:42:47 - weekly_report - INFO - fetch_section_data:244 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-25 10:42:47 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:42:48 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:42:52 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:43:00 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:43:13 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:43:39 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-25 10:43:39 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/revenue_query_2026-02-28.md
2026-02-25 10:43:39 - weekly_report - INFO - fetch_all_sections:297 - ✅ 数据获取完成
2026-02-25 10:43:39 - weekly_report - INFO - main:226 - 
============================================================
2026-02-25 10:43:39 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-25 10:43:39 - weekly_report - INFO - main:228 - ============================================================
2026-02-25 10:43:39 - weekly_report - ERROR - main:300 - 
❌ 执行过程中出现异常: unsupported format string passed to NoneType.__format__
Traceback (most recent call last):
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/main.py", line 231, in main
    analysis_results = analyzer.analyze_all_sections(current_data, previous_data)
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/src/data_analyzer.py", line 77, in analyze_all_sections
    results['revenue'] = self.analyze_revenue_data(
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/src/data_analyzer.py", line 586, in analyze_revenue_data
    'summary': f"总收入 {total_amount:.2f}，环比{trend} {change_rate:+.2f}%"
TypeError: unsupported format string passed to NoneType.__format__
2026-02-25 10:44:04 - weekly_report - INFO - main:155 - ============================================================
2026-02-25 10:44:04 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-25 10:44:04 - weekly_report - INFO - main:157 - ============================================================
2026-02-25 10:44:04 - weekly_report - INFO - main:164 - 目标周: 指定日期(20260223)
2026-02-25 10:44:04 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-25 10:44:04 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-25 10:44:04 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-25 10:44:06 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-25 10:44:06 - weekly_report - INFO - main:205 - 
============================================================
2026-02-25 10:44:06 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-25 10:44:06 - weekly_report - INFO - main:207 - ============================================================
2026-02-25 10:44:06 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-25 10:44:06 - weekly_report - INFO - fetch_all_sections:281 - 开始获取所有部分数据（周偏移: 0）...
2026-02-25 10:44:06 - weekly_report - INFO - fetch_section_data:244 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-25 10:44:06 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:44:07 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:44:10 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:44:17 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:44:29 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:44:54 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 0 行数据
2026-02-25 10:44:54 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/traffic_query_2026-02-28.md
2026-02-25 10:44:54 - weekly_report - INFO - fetch_section_data:244 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-25 10:44:54 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:44:57 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:45:02 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:45:10 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:45:26 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:45:52 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 8 行数据
2026-02-25 10:45:52 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/activation_query_2026-02-28.md
2026-02-25 10:45:52 - weekly_report - INFO - fetch_section_data:244 - 处理 engagement 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-25 10:45:52 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:45:52 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:45:56 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:46:03 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:46:15 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:46:40 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-25 10:46:40 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/engagement_query_2026-02-28.md
2026-02-25 10:46:40 - weekly_report - INFO - fetch_section_data:244 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-25 10:46:40 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:46:41 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:46:44 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:46:51 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:47:04 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:47:28 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 24 行数据
2026-02-25 10:47:28 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/retention_query_2026-02-28.md
2026-02-25 10:47:28 - weekly_report - INFO - fetch_section_data:244 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-25 10:47:28 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:47:30 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:47:34 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:47:42 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:47:55 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:48:20 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-25 10:48:20 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/revenue_query_2026-02-28.md
2026-02-25 10:48:20 - weekly_report - INFO - fetch_all_sections:297 - ✅ 数据获取完成
2026-02-25 10:48:20 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-25 10:48:20 - weekly_report - INFO - main:217 - ✅ 成功获取 4 个部分的数据
2026-02-25 10:48:20 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-25 10:48:20 - weekly_report - INFO - fetch_all_sections:281 - 开始获取所有部分数据（周偏移: -1）...
2026-02-25 10:48:20 - weekly_report - INFO - fetch_section_data:244 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-25 10:48:20 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:48:21 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:48:24 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:48:31 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:48:43 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:49:08 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 0 行数据
2026-02-25 10:49:08 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/traffic_query_2026-02-28.md
2026-02-25 10:49:08 - weekly_report - INFO - fetch_section_data:244 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-25 10:49:08 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:49:10 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:49:15 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:49:23 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:49:38 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:50:05 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 8 行数据
2026-02-25 10:50:05 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/activation_query_2026-02-28.md
2026-02-25 10:50:05 - weekly_report - INFO - fetch_section_data:244 - 处理 engagement 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-25 10:50:05 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:50:06 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:50:09 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:50:16 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:50:29 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:50:53 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-25 10:50:53 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/engagement_query_2026-02-28.md
2026-02-25 10:50:53 - weekly_report - INFO - fetch_section_data:244 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-25 10:50:53 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:50:54 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:50:58 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:51:05 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:51:17 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:51:42 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 24 行数据
2026-02-25 10:51:42 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/retention_query_2026-02-28.md
2026-02-25 10:51:42 - weekly_report - INFO - fetch_section_data:244 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-25 10:51:42 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 10:51:43 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 10:51:47 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 10:51:55 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 10:52:08 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 10:52:33 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-25 10:52:33 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/revenue_query_2026-02-28.md
2026-02-25 10:52:33 - weekly_report - INFO - fetch_all_sections:297 - ✅ 数据获取完成
2026-02-25 10:52:33 - weekly_report - INFO - main:226 - 
============================================================
2026-02-25 10:52:33 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-25 10:52:33 - weekly_report - INFO - main:228 - ============================================================
2026-02-25 10:52:33 - weekly_report - INFO - main:237 - 收入: 总收入 0.00，环比N/A +0.00%
2026-02-25 10:52:33 - weekly_report - INFO - main:240 - 
============================================================
2026-02-25 10:52:33 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-25 10:52:33 - weekly_report - INFO - main:242 - ============================================================
2026-02-25 10:52:33 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-25 10:52:33 - weekly_report - INFO - generate_full_report_html:348 - 生成完整HTML报告...
2026-02-25 10:52:33 - weekly_report - INFO - render_traffic_section:78 - 渲染流量部分...
2026-02-25 10:52:33 - weekly_report - INFO - render_traffic_section:106 - ✅ 流量部分渲染完成
2026-02-25 10:52:33 - weekly_report - INFO - render_activation_section:117 - 渲染激活部分...
2026-02-25 10:52:33 - weekly_report - INFO - render_activation_section:168 - ✅ 激活部分渲染完成
2026-02-25 10:52:33 - weekly_report - INFO - render_engagement_section:179 - 渲染活跃部分...
2026-02-25 10:52:33 - weekly_report - INFO - render_engagement_section:204 - ✅ 活跃部分渲染完成
2026-02-25 10:52:33 - weekly_report - INFO - render_retention_section:215 - 渲染留存部分...
2026-02-25 10:52:33 - weekly_report - INFO - render_retention_section:241 - ✅ 留存部分渲染完成
2026-02-25 10:52:33 - weekly_report - INFO - generate_revenue_section_html:252 - 生成收入部分HTML...
2026-02-25 10:52:33 - weekly_report - INFO - generate_revenue_section_html:285 - ✅ 收入部分HTML生成完成
2026-02-25 10:52:33 - weekly_report - INFO - generate_full_report_html:419 - ✅ 完整HTML报告生成完成
2026-02-25 10:52:33 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-25 10:52:33 - weekly_report - INFO - main:258 - 
============================================================
2026-02-25 10:52:33 - weekly_report - INFO - main:259 - 第四阶段：保存报告到文件
2026-02-25 10:52:33 - weekly_report - INFO - main:260 - ============================================================
2026-02-25 10:52:33 - weekly_report - INFO - save_html_to_file:203 - ✅ HTML已保存到: confluence_report_2026-02-28.html
2026-02-25 10:52:33 - weekly_report - INFO - main:267 - 
============================================================
2026-02-25 10:52:33 - weekly_report - INFO - main:268 - ✅ 报告已保存到本地文件！
2026-02-25 10:52:33 - weekly_report - INFO - main:269 - ============================================================
2026-02-25 10:52:33 - weekly_report - INFO - main:270 - 文件路径: output/confluence_report_2026-02-28.html
2026-02-25 10:52:33 - weekly_report - INFO - main:271 - 报告日期: 2026-02-28
2026-02-25 11:02:25 - weekly_report - INFO - main:155 - ============================================================
2026-02-25 11:02:25 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-25 11:02:25 - weekly_report - INFO - main:157 - ============================================================
2026-02-25 11:02:25 - weekly_report - INFO - main:164 - 目标周: 指定日期(20260223)
2026-02-25 11:02:25 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-25 11:02:25 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-25 11:02:25 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-25 11:02:27 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-25 11:02:27 - weekly_report - INFO - main:205 - 
============================================================
2026-02-25 11:02:27 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-25 11:02:27 - weekly_report - INFO - main:207 - ============================================================
2026-02-25 11:02:27 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-25 11:02:27 - weekly_report - INFO - fetch_all_sections:281 - 开始获取所有部分数据（周偏移: 0）...
2026-02-25 11:02:27 - weekly_report - INFO - fetch_section_data:244 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-25 11:02:27 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 11:02:28 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 11:02:31 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 11:02:38 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 11:02:50 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 11:03:15 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 0 行数据
2026-02-25 11:03:15 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/traffic_query_2026-02-28.md
2026-02-25 11:03:15 - weekly_report - INFO - fetch_section_data:244 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-25 11:03:15 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 11:03:17 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 11:03:21 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 11:03:29 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 11:03:43 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 11:04:09 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 8 行数据
2026-02-25 11:04:09 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/activation_query_2026-02-28.md
2026-02-25 11:04:09 - weekly_report - INFO - fetch_section_data:244 - 处理 engagement 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-25 11:04:09 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 11:04:10 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 11:04:13 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 11:04:20 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 11:04:33 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 11:04:58 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-25 11:04:58 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/engagement_query_2026-02-28.md
2026-02-25 11:04:58 - weekly_report - INFO - fetch_section_data:244 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-25 11:04:58 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 11:04:59 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 11:05:02 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 11:05:09 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 11:05:22 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 11:05:47 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 24 行数据
2026-02-25 11:05:47 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/retention_query_2026-02-28.md
2026-02-25 11:05:47 - weekly_report - INFO - fetch_section_data:244 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-25 11:05:47 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 11:05:48 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 11:05:52 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 11:05:59 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 11:06:13 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 11:06:39 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-25 11:06:39 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/revenue_query_2026-02-28.md
2026-02-25 11:06:39 - weekly_report - INFO - fetch_all_sections:297 - ✅ 数据获取完成
2026-02-25 11:06:39 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-25 11:06:39 - weekly_report - INFO - main:217 - ✅ 成功获取 4 个部分的数据
2026-02-25 11:06:39 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-25 11:06:39 - weekly_report - INFO - fetch_all_sections:281 - 开始获取所有部分数据（周偏移: -1）...
2026-02-25 11:06:39 - weekly_report - INFO - fetch_section_data:244 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-25 11:06:39 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 11:06:40 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 11:06:44 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 11:06:51 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 11:07:03 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 11:07:28 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 0 行数据
2026-02-25 11:07:28 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/traffic_query_2026-02-28.md
2026-02-25 11:07:28 - weekly_report - INFO - fetch_section_data:244 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-25 11:07:28 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 11:07:30 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 11:07:35 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 11:07:43 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 11:07:58 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 11:08:24 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 8 行数据
2026-02-25 11:08:24 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/activation_query_2026-02-28.md
2026-02-25 11:08:24 - weekly_report - INFO - fetch_section_data:244 - 处理 engagement 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-25 11:08:24 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 11:08:24 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 11:08:28 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 11:08:34 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 11:08:48 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 11:09:12 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-25 11:09:12 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/engagement_query_2026-02-28.md
2026-02-25 11:09:12 - weekly_report - INFO - fetch_section_data:244 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-25 11:09:12 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 11:09:13 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 11:09:17 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 11:09:24 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 11:09:36 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 11:10:01 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 24 行数据
2026-02-25 11:10:01 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/retention_query_2026-02-28.md
2026-02-25 11:10:01 - weekly_report - INFO - fetch_section_data:244 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-25 11:10:01 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 11:10:02 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 11:10:06 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 11:10:14 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 11:10:27 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 11:10:52 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-25 11:10:52 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/revenue_query_2026-02-28.md
2026-02-25 11:10:52 - weekly_report - INFO - fetch_all_sections:297 - ✅ 数据获取完成
2026-02-25 11:10:52 - weekly_report - INFO - main:226 - 
============================================================
2026-02-25 11:10:52 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-25 11:10:52 - weekly_report - INFO - main:228 - ============================================================
2026-02-25 11:10:52 - weekly_report - INFO - main:237 - 收入: 总收入 0.00，环比N/A +0.00%
2026-02-25 11:10:52 - weekly_report - INFO - main:240 - 
============================================================
2026-02-25 11:10:52 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-25 11:10:52 - weekly_report - INFO - main:242 - ============================================================
2026-02-25 11:10:52 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-25 11:10:52 - weekly_report - INFO - generate_full_report_html:348 - 生成完整HTML报告...
2026-02-25 11:10:52 - weekly_report - INFO - render_traffic_section:78 - 渲染流量部分...
2026-02-25 11:10:52 - weekly_report - INFO - render_traffic_section:106 - ✅ 流量部分渲染完成
2026-02-25 11:10:52 - weekly_report - INFO - render_activation_section:117 - 渲染激活部分...
2026-02-25 11:10:52 - weekly_report - INFO - render_activation_section:168 - ✅ 激活部分渲染完成
2026-02-25 11:10:52 - weekly_report - INFO - render_engagement_section:179 - 渲染活跃部分...
2026-02-25 11:10:52 - weekly_report - INFO - render_engagement_section:204 - ✅ 活跃部分渲染完成
2026-02-25 11:10:52 - weekly_report - INFO - render_retention_section:215 - 渲染留存部分...
2026-02-25 11:10:52 - weekly_report - INFO - render_retention_section:241 - ✅ 留存部分渲染完成
2026-02-25 11:10:52 - weekly_report - INFO - generate_revenue_section_html:252 - 生成收入部分HTML...
2026-02-25 11:10:52 - weekly_report - INFO - generate_revenue_section_html:285 - ✅ 收入部分HTML生成完成
2026-02-25 11:10:52 - weekly_report - INFO - generate_full_report_html:419 - ✅ 完整HTML报告生成完成
2026-02-25 11:10:52 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-25 11:10:52 - weekly_report - INFO - main:258 - 
============================================================
2026-02-25 11:10:52 - weekly_report - INFO - main:259 - 第四阶段：保存报告到文件
2026-02-25 11:10:52 - weekly_report - INFO - main:260 - ============================================================
2026-02-25 11:10:52 - weekly_report - INFO - save_html_to_file:203 - ✅ HTML已保存到: confluence_report_2026-02-28.html
2026-02-25 11:10:52 - weekly_report - INFO - main:267 - 
============================================================
2026-02-25 11:10:52 - weekly_report - INFO - main:268 - ✅ 报告已保存到本地文件！
2026-02-25 11:10:52 - weekly_report - INFO - main:269 - ============================================================
2026-02-25 11:10:52 - weekly_report - INFO - main:270 - 文件路径: output/confluence_report_2026-02-28.html
2026-02-25 11:10:52 - weekly_report - INFO - main:271 - 报告日期: 2026-02-28
2026-02-25 11:46:12 - weekly_report - INFO - main:155 - ============================================================
2026-02-25 11:46:12 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-25 11:46:12 - weekly_report - INFO - main:157 - ============================================================
2026-02-25 11:46:12 - weekly_report - INFO - main:164 - 目标周: 指定日期(20260223)
2026-02-25 11:46:12 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-25 11:46:12 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-25 11:46:12 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-25 11:46:14 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-25 11:46:14 - weekly_report - INFO - main:205 - 
============================================================
2026-02-25 11:46:14 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-25 11:46:14 - weekly_report - INFO - main:207 - ============================================================
2026-02-25 11:46:14 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-25 11:46:14 - weekly_report - INFO - fetch_all_sections:281 - 开始获取所有部分数据（周偏移: 0）...
2026-02-25 11:46:14 - weekly_report - INFO - fetch_section_data:244 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-25 11:46:14 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 11:46:14 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 11:46:18 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 11:46:25 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 11:46:38 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 11:47:02 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 143 行数据
2026-02-25 11:47:02 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/traffic_query_2026-02-28.md
2026-02-25 11:47:02 - weekly_report - INFO - fetch_section_data:244 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-25 11:47:02 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 11:47:04 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 11:47:09 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 11:47:20 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 11:47:34 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 11:48:00 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 8 行数据
2026-02-25 11:48:00 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/activation_query_2026-02-28.md
2026-02-25 11:48:00 - weekly_report - INFO - fetch_section_data:244 - 处理 engagement 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-25 11:48:00 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 11:48:01 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 11:48:04 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 11:48:11 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 11:48:24 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 11:48:48 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-25 11:48:48 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/engagement_query_2026-02-28.md
2026-02-25 11:48:48 - weekly_report - INFO - fetch_section_data:244 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-25 11:48:48 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 11:48:49 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 11:48:53 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 11:49:00 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 11:49:12 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 11:49:38 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 24 行数据
2026-02-25 11:49:38 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/retention_query_2026-02-28.md
2026-02-25 11:49:38 - weekly_report - INFO - fetch_section_data:244 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-25 11:49:38 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 11:49:40 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 11:49:44 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 11:49:51 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 11:50:05 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 11:50:30 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-25 11:50:30 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/revenue_query_2026-02-28.md
2026-02-25 11:50:30 - weekly_report - INFO - fetch_all_sections:297 - ✅ 数据获取完成
2026-02-25 11:50:30 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-25 11:50:30 - weekly_report - INFO - main:217 - ✅ 成功获取 5 个部分的数据
2026-02-25 11:50:30 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-25 11:50:30 - weekly_report - INFO - fetch_all_sections:281 - 开始获取所有部分数据（周偏移: -1）...
2026-02-25 11:50:30 - weekly_report - INFO - fetch_section_data:244 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-25 11:50:30 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 11:50:31 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 11:50:35 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 11:50:41 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 11:50:54 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 11:51:19 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 143 行数据
2026-02-25 11:51:19 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/traffic_query_2026-02-28.md
2026-02-25 11:51:19 - weekly_report - INFO - fetch_section_data:244 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-25 11:51:19 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 11:51:21 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 11:51:26 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 11:51:33 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 11:51:47 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 11:52:13 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 8 行数据
2026-02-25 11:52:13 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/activation_query_2026-02-28.md
2026-02-25 11:52:13 - weekly_report - INFO - fetch_section_data:244 - 处理 engagement 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-25 11:52:13 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 11:52:14 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 11:52:18 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 11:52:25 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 11:52:38 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 11:53:02 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-25 11:53:02 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/engagement_query_2026-02-28.md
2026-02-25 11:53:02 - weekly_report - INFO - fetch_section_data:244 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-25 11:53:02 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 11:53:04 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 11:53:08 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 11:53:14 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 11:53:27 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 11:53:52 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 24 行数据
2026-02-25 11:53:52 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/retention_query_2026-02-28.md
2026-02-25 11:53:52 - weekly_report - INFO - fetch_section_data:244 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-25 11:53:52 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 11:53:53 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 11:53:58 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 11:54:05 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 11:54:19 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 11:54:44 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-25 11:54:44 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/revenue_query_2026-02-28.md
2026-02-25 11:54:44 - weekly_report - INFO - fetch_all_sections:297 - ✅ 数据获取完成
2026-02-25 11:54:44 - weekly_report - INFO - main:226 - 
============================================================
2026-02-25 11:54:44 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-25 11:54:44 - weekly_report - INFO - main:228 - ============================================================
2026-02-25 11:54:44 - weekly_report - ERROR - main:300 - 
❌ 执行过程中出现异常: unsupported format string passed to NoneType.__format__
Traceback (most recent call last):
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/main.py", line 231, in main
    analysis_results = analyzer.analyze_all_sections(current_data, previous_data)
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/src/data_analyzer.py", line 49, in analyze_all_sections
    results['traffic'] = self.analyze_traffic_data(
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/src/data_analyzer.py", line 232, in analyze_traffic_data
    'summary': f"总新访客 {total_new_visitors:,.0f}，环比{trend} {change_rate:+.1f}%",
TypeError: unsupported format string passed to NoneType.__format__
2026-02-25 11:59:30 - weekly_report - INFO - main:155 - ============================================================
2026-02-25 11:59:30 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-25 11:59:30 - weekly_report - INFO - main:157 - ============================================================
2026-02-25 11:59:30 - weekly_report - INFO - main:164 - 目标周: 指定日期(20260223)
2026-02-25 11:59:30 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-25 11:59:30 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-25 11:59:30 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-25 11:59:32 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-25 11:59:32 - weekly_report - INFO - main:205 - 
============================================================
2026-02-25 11:59:32 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-25 11:59:32 - weekly_report - INFO - main:207 - ============================================================
2026-02-25 11:59:32 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-25 11:59:32 - weekly_report - INFO - fetch_all_sections:281 - 开始获取所有部分数据（周偏移: 0）...
2026-02-25 11:59:32 - weekly_report - INFO - fetch_section_data:244 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-25 11:59:32 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 11:59:33 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 11:59:37 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 11:59:44 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 11:59:59 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 12:00:31 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 143 行数据
2026-02-25 12:00:31 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/traffic_query_2026-02-28.md
2026-02-25 12:00:31 - weekly_report - INFO - fetch_section_data:244 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-25 12:00:31 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 12:00:33 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 12:00:38 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 12:00:46 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 12:01:00 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 12:01:26 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 8 行数据
2026-02-25 12:01:26 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/activation_query_2026-02-28.md
2026-02-25 12:01:26 - weekly_report - INFO - fetch_section_data:244 - 处理 engagement 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-25 12:01:26 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 12:01:27 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 12:01:31 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 12:01:38 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 12:01:51 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 12:02:16 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-25 12:02:16 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/engagement_query_2026-02-28.md
2026-02-25 12:02:16 - weekly_report - INFO - fetch_section_data:244 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-25 12:02:16 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 12:02:17 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 12:02:20 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 12:02:27 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 12:02:40 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 12:03:05 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 24 行数据
2026-02-25 12:03:05 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/retention_query_2026-02-28.md
2026-02-25 12:03:05 - weekly_report - INFO - fetch_section_data:244 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-25 12:03:05 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 12:03:06 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 12:03:10 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 12:03:19 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 12:03:32 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 12:03:58 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-25 12:03:58 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/revenue_query_2026-02-28.md
2026-02-25 12:03:58 - weekly_report - INFO - fetch_all_sections:297 - ✅ 数据获取完成
2026-02-25 12:03:58 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-25 12:03:58 - weekly_report - INFO - main:217 - ✅ 成功获取 5 个部分的数据
2026-02-25 12:03:58 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-25 12:03:58 - weekly_report - INFO - fetch_all_sections:281 - 开始获取所有部分数据（周偏移: -1）...
2026-02-25 12:03:58 - weekly_report - INFO - fetch_section_data:244 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-25 12:03:58 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 12:03:59 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 12:04:02 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 12:04:09 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 12:04:22 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 12:04:47 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 143 行数据
2026-02-25 12:04:47 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/traffic_query_2026-02-28.md
2026-02-25 12:04:47 - weekly_report - INFO - fetch_section_data:244 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-25 12:04:47 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 12:04:50 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 12:04:55 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 12:05:03 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 12:05:17 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 12:05:43 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 8 行数据
2026-02-25 12:05:43 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/activation_query_2026-02-28.md
2026-02-25 12:05:43 - weekly_report - INFO - fetch_section_data:244 - 处理 engagement 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-25 12:05:43 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 12:05:44 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 12:05:47 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 12:05:54 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 12:06:07 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 12:06:32 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-25 12:06:32 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/engagement_query_2026-02-28.md
2026-02-25 12:06:32 - weekly_report - INFO - fetch_section_data:244 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-25 12:06:32 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 12:06:34 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 12:06:37 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 12:06:44 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 12:06:57 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 12:07:22 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 24 行数据
2026-02-25 12:07:22 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/retention_query_2026-02-28.md
2026-02-25 12:07:22 - weekly_report - INFO - fetch_section_data:244 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-25 12:07:22 - weekly_report - INFO - execute_metabase_query:120 - 正在执行Metabase查询...
2026-02-25 12:07:23 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 12:07:28 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 12:07:35 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 12:07:49 - weekly_report - WARNING - execute_metabase_query:172 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 12:08:14 - weekly_report - INFO - execute_metabase_query:198 - ✅ 查询成功，返回 12 行数据
2026-02-25 12:08:14 - weekly_report - INFO - _save_sql_to_md:101 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/revenue_query_2026-02-28.md
2026-02-25 12:08:14 - weekly_report - INFO - fetch_all_sections:297 - ✅ 数据获取完成
2026-02-25 12:08:14 - weekly_report - INFO - main:226 - 
============================================================
2026-02-25 12:08:14 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-25 12:08:14 - weekly_report - INFO - main:228 - ============================================================
2026-02-25 12:08:14 - weekly_report - ERROR - main:300 - 
❌ 执行过程中出现异常: unsupported format string passed to NoneType.__format__
Traceback (most recent call last):
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/main.py", line 231, in main
    analysis_results = analyzer.analyze_all_sections(current_data, previous_data)
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/src/data_analyzer.py", line 49, in analyze_all_sections
    results['traffic'] = self.analyze_traffic_data(
  File "/Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/src/data_analyzer.py", line 232, in analyze_traffic_data
    'summary': f"总新访客 {total_new_visitors:,.0f}，环比{trend} {change_rate:+.1f}%",
TypeError: unsupported format string passed to NoneType.__format__
2026-02-25 14:02:38 - weekly_report - INFO - main:155 - ============================================================
2026-02-25 14:02:38 - weekly_report - INFO - main:156 - Coohom周报自动化更新系统启动
2026-02-25 14:02:38 - weekly_report - INFO - main:157 - ============================================================
2026-02-25 14:02:38 - weekly_report - INFO - main:164 - 目标周: 指定日期(20260223)
2026-02-25 14:02:38 - weekly_report - INFO - main:165 - 报告日期: 2026-02-28
2026-02-25 14:02:38 - weekly_report - INFO - main:166 - 周范围: 20260223 ~ 20260228
2026-02-25 14:02:38 - weekly_report - INFO - main:179 - ℹ️  将仅使用SQL数据生成收入部分
2026-02-25 14:02:40 - weekly_report - INFO - main:200 - 加载配置文件...
2026-02-25 14:02:40 - weekly_report - INFO - main:205 - 
============================================================
2026-02-25 14:02:40 - weekly_report - INFO - main:206 - 第一阶段：数据获取
2026-02-25 14:02:40 - weekly_report - INFO - main:207 - ============================================================
2026-02-25 14:02:40 - weekly_report - INFO - main:210 - 获取本周数据...
2026-02-25 14:02:40 - weekly_report - INFO - fetch_all_sections:280 - 开始获取所有部分数据（周偏移: 0）...
2026-02-25 14:02:40 - weekly_report - INFO - fetch_section_data:243 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-25 14:02:40 - weekly_report - INFO - execute_metabase_query:119 - 正在执行Metabase查询...
2026-02-25 14:02:41 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 14:02:45 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 14:02:52 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 14:03:05 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 14:03:30 - weekly_report - INFO - execute_metabase_query:197 - ✅ 查询成功，返回 143 行数据
2026-02-25 14:03:30 - weekly_report - INFO - _save_sql_to_md:100 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/traffic_query_2026-02-28.md
2026-02-25 14:03:30 - weekly_report - INFO - fetch_section_data:243 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-25 14:03:30 - weekly_report - INFO - execute_metabase_query:119 - 正在执行Metabase查询...
2026-02-25 14:03:33 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 14:03:38 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 14:03:45 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 14:04:03 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 14:04:29 - weekly_report - INFO - execute_metabase_query:197 - ✅ 查询成功，返回 8 行数据
2026-02-25 14:04:29 - weekly_report - INFO - _save_sql_to_md:100 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/activation_query_2026-02-28.md
2026-02-25 14:04:29 - weekly_report - INFO - fetch_section_data:243 - 处理 engagement 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-25 14:04:29 - weekly_report - INFO - execute_metabase_query:119 - 正在执行Metabase查询...
2026-02-25 14:04:30 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 14:04:34 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 14:04:41 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 14:04:54 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 14:05:19 - weekly_report - INFO - execute_metabase_query:197 - ✅ 查询成功，返回 12 行数据
2026-02-25 14:05:19 - weekly_report - INFO - _save_sql_to_md:100 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/engagement_query_2026-02-28.md
2026-02-25 14:05:19 - weekly_report - INFO - fetch_section_data:243 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-25 14:05:19 - weekly_report - INFO - execute_metabase_query:119 - 正在执行Metabase查询...
2026-02-25 14:05:21 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 14:05:28 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 14:05:36 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 14:05:49 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 14:06:14 - weekly_report - INFO - execute_metabase_query:197 - ✅ 查询成功，返回 24 行数据
2026-02-25 14:06:14 - weekly_report - INFO - _save_sql_to_md:100 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/retention_query_2026-02-28.md
2026-02-25 14:06:14 - weekly_report - INFO - fetch_section_data:243 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-25 14:06:14 - weekly_report - INFO - execute_metabase_query:119 - 正在执行Metabase查询...
2026-02-25 14:06:16 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 14:06:20 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 14:06:29 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 14:06:43 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 14:07:11 - weekly_report - INFO - execute_metabase_query:197 - ✅ 查询成功，返回 12 行数据
2026-02-25 14:07:11 - weekly_report - INFO - _save_sql_to_md:100 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/revenue_query_2026-02-28.md
2026-02-25 14:07:11 - weekly_report - INFO - fetch_all_sections:296 - ✅ 数据获取完成
2026-02-25 14:07:11 - weekly_report - INFO - main:212 - 获取数据获取情况
2026-02-25 14:07:11 - weekly_report - INFO - main:217 - ✅ 成功获取 5 个部分的数据
2026-02-25 14:07:11 - weekly_report - INFO - main:222 - 
获取上周数据（用于环比计算）...
2026-02-25 14:07:11 - weekly_report - INFO - fetch_all_sections:280 - 开始获取所有部分数据（周偏移: -1）...
2026-02-25 14:07:11 - weekly_report - INFO - fetch_section_data:243 - 处理 traffic 部分，SQL文件: 01_traffic_weekly.sql
2026-02-25 14:07:11 - weekly_report - INFO - execute_metabase_query:119 - 正在执行Metabase查询...
2026-02-25 14:07:12 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 14:07:15 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 14:07:22 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 14:07:35 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 14:08:00 - weekly_report - INFO - execute_metabase_query:197 - ✅ 查询成功，返回 143 行数据
2026-02-25 14:08:00 - weekly_report - INFO - _save_sql_to_md:100 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/traffic_query_2026-02-28.md
2026-02-25 14:08:00 - weekly_report - INFO - fetch_section_data:243 - 处理 activation 部分，SQL文件: 02_activation_ready.sql
2026-02-25 14:08:00 - weekly_report - INFO - execute_metabase_query:119 - 正在执行Metabase查询...
2026-02-25 14:08:02 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 14:08:07 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 14:08:15 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 14:08:29 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 14:08:55 - weekly_report - INFO - execute_metabase_query:197 - ✅ 查询成功，返回 8 行数据
2026-02-25 14:08:55 - weekly_report - INFO - _save_sql_to_md:100 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/activation_query_2026-02-28.md
2026-02-25 14:08:55 - weekly_report - INFO - fetch_section_data:243 - 处理 engagement 部分，SQL文件: 03_engagement_new_old_users.sql
2026-02-25 14:08:55 - weekly_report - INFO - execute_metabase_query:119 - 正在执行Metabase查询...
2026-02-25 14:08:56 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 14:09:00 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 14:09:07 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 14:09:20 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 14:09:45 - weekly_report - INFO - execute_metabase_query:197 - ✅ 查询成功，返回 12 行数据
2026-02-25 14:09:45 - weekly_report - INFO - _save_sql_to_md:100 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/engagement_query_2026-02-28.md
2026-02-25 14:09:45 - weekly_report - INFO - fetch_section_data:243 - 处理 retention 部分，SQL文件: 04_retention.sql
2026-02-25 14:09:45 - weekly_report - INFO - execute_metabase_query:119 - 正在执行Metabase查询...
2026-02-25 14:09:46 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 14:09:50 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 14:09:57 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 14:10:10 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 14:10:35 - weekly_report - INFO - execute_metabase_query:197 - ✅ 查询成功，返回 24 行数据
2026-02-25 14:10:35 - weekly_report - INFO - _save_sql_to_md:100 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/retention_query_2026-02-28.md
2026-02-25 14:10:35 - weekly_report - INFO - fetch_section_data:243 - 处理 revenue 部分，SQL文件: 05_revenue.sql
2026-02-25 14:10:35 - weekly_report - INFO - execute_metabase_query:119 - 正在执行Metabase查询...
2026-02-25 14:10:37 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 3 秒后重试... (1/5)
2026-02-25 14:10:41 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 6 秒后重试... (2/5)
2026-02-25 14:10:49 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 12 秒后重试... (3/5)
2026-02-25 14:11:02 - weekly_report - WARNING - execute_metabase_query:171 - ⚠️ 查询执行中 (202)，等待 24 秒后重试... (4/5)
2026-02-25 14:11:28 - weekly_report - INFO - execute_metabase_query:197 - ✅ 查询成功，返回 12 行数据
2026-02-25 14:11:28 - weekly_report - INFO - _save_sql_to_md:100 - ✅ SQL已保存到: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/sql_queries/revenue_query_2026-02-28.md
2026-02-25 14:11:28 - weekly_report - INFO - fetch_all_sections:296 - ✅ 数据获取完成
2026-02-25 14:11:28 - weekly_report - INFO - main:226 - 
============================================================
2026-02-25 14:11:28 - weekly_report - INFO - main:227 - 第二阶段：数据分析
2026-02-25 14:11:28 - weekly_report - INFO - main:228 - ============================================================
2026-02-25 14:11:28 - weekly_report - INFO - analyze_all_sections:76 - 开始分析所有部分...
2026-02-25 14:11:28 - weekly_report - INFO - analyze_traffic_data:133 - 分析流量数据...
2026-02-25 14:11:28 - weekly_report - INFO - analyze_traffic_data:185 - ✅ 流量数据分析完成: 总新访客 1,991,694，环比→ +0.0%
2026-02-25 14:11:28 - weekly_report - INFO - analyze_activation_data:203 - 分析激活数据...
2026-02-25 14:11:28 - weekly_report - INFO - analyze_activation_data:259 - ✅ 激活数据分析完成
2026-02-25 14:11:28 - weekly_report - INFO - analyze_engagement_data:277 - 分析活跃数据...
2026-02-25 14:11:28 - weekly_report - INFO - analyze_engagement_data:329 - ✅ 活跃数据分析完成: 工具WAU 46,877，→ +0.0%
2026-02-25 14:11:28 - weekly_report - INFO - analyze_retention_data:347 - 分析留存数据...
2026-02-25 14:11:28 - weekly_report - INFO - analyze_retention_data:396 - ✅ 留存数据分析完成
2026-02-25 14:11:28 - weekly_report - INFO - analyze_revenue_data:414 - 分析收入数据...
2026-02-25 14:11:28 - weekly_report - INFO - analyze_revenue_data:466 - ✅ 收入数据分析完成: 总收入 0，环比→ +0.0%
2026-02-25 14:11:28 - weekly_report - INFO - analyze_all_sections:115 - ✅ 所有部分分析完成
2026-02-25 14:11:28 - weekly_report - INFO - main:235 - 流量: 总新访客 1,991,694，环比→ +0.0%
2026-02-25 14:11:28 - weekly_report - INFO - main:237 - 收入: 总收入 0，环比→ +0.0%
2026-02-25 14:11:28 - weekly_report - INFO - main:240 - 
============================================================
2026-02-25 14:11:28 - weekly_report - INFO - main:241 - 第三阶段：报告生成
2026-02-25 14:11:28 - weekly_report - INFO - main:242 - ============================================================
2026-02-25 14:11:28 - weekly_report - INFO - __init__:26 - 模板目录: /Users/sunsirui/Documents/coohom PLG/kmb/Our analytics/weekly_report_automation/templates/confluence
2026-02-25 14:11:28 - weekly_report - INFO - generate_full_report_html:348 - 生成完整HTML报告...
2026-02-25 14:11:28 - weekly_report - INFO - render_traffic_section:78 - 渲染流量部分...
2026-02-25 14:11:28 - weekly_report - INFO - render_traffic_section:106 - ✅ 流量部分渲染完成
2026-02-25 14:11:28 - weekly_report - INFO - render_activation_section:117 - 渲染激活部分...
2026-02-25 14:11:28 - weekly_report - INFO - render_activation_section:168 - ✅ 激活部分渲染完成
2026-02-25 14:11:28 - weekly_report - INFO - render_engagement_section:179 - 渲染活跃部分...
2026-02-25 14:11:28 - weekly_report - INFO - render_engagement_section:204 - ✅ 活跃部分渲染完成
2026-02-25 14:11:28 - weekly_report - INFO - render_retention_section:215 - 渲染留存部分...
2026-02-25 14:11:28 - weekly_report - INFO - render_retention_section:241 - ✅ 留存部分渲染完成
2026-02-25 14:11:28 - weekly_report - INFO - generate_revenue_section_html:252 - 生成收入部分HTML...
2026-02-25 14:11:28 - weekly_report - INFO - generate_revenue_section_html:285 - ✅ 收入部分HTML生成完成
2026-02-25 14:11:28 - weekly_report - INFO - generate_full_report_html:419 - ✅ 完整HTML报告生成完成
2026-02-25 14:11:28 - weekly_report - INFO - main:253 - ✅ 报告HTML生成完成
2026-02-25 14:11:28 - weekly_report - INFO - main:258 - 
============================================================
2026-02-25 14:11:28 - weekly_report - INFO - main:259 - 第四阶段：保存报告到文件
2026-02-25 14:11:28 - weekly_report - INFO - main:260 - ============================================================
2026-02-25 14:11:28 - weekly_report - INFO - save_html_to_file:203 - ✅ HTML已保存到: confluence_report_2026-02-28.html
2026-02-25 14:11:28 - weekly_report - INFO - main:267 - 
============================================================
2026-02-25 14:11:28 - weekly_report - INFO - main:268 - ✅ 报告已保存到本地文件！
2026-02-25 14:11:28 - weekly_report - INFO - main:269 - ============================================================
2026-02-25 14:11:28 - weekly_report - INFO - main:270 - 文件路径: output/confluence_report_2026-02-28.html
2026-02-25 14:11:28 - weekly_report - INFO - main:271 - 报告日期: 2026-02-28
